module.exports=[90460,a=>{"use strict";let b={goldOne:"#e8e6d4",goldTwo:"#c4aa6a",gunmetal:"#272727",gunmetalDark:"#1a1a1a",blackLight:"#0f0f0f",border:"rgba(196, 170, 106, 0.4)"},c={prapor:{primary:"#c41e3a",bg:b.gunmetal},therapist:{primary:"#ff69b4",bg:b.gunmetal},skier:{primary:"#1e90ff",bg:b.gunmetal},peacekeeper:{primary:"#228b22",bg:b.gunmetal},mechanic:{primary:"#ff8c00",bg:b.gunmetal},ragman:{primary:"#9370db",bg:b.gunmetal},jaeger:{primary:"#8b4513",bg:b.gunmetal},fence:{primary:"#708090",bg:b.gunmetal},lightkeeper:{primary:"#ffd700",bg:b.gunmetal},ref:{primary:"#20b2aa",bg:b.gunmetal}};function d(a){return c[a.toLowerCase()]||{primary:b.goldTwo,bg:b.gunmetal}}a.s(["EFT_COLORS",0,b,"STATUS_COLORS",0,{locked:{primary:"#5a5a5a",bg:"#1a1a1a",border:"#3a3a3a"},available:{primary:"#4db8ff",bg:"#1a1a1a",border:"#4db8ff"},in_progress:{primary:"#fbbf24",bg:"#1a1a1a",border:"#fbbf24"},completed:{primary:"#4ade80",bg:"#1e2e1e",border:"#4ade80"}},"TRADER_COLORS",0,c,"getTraderColor",()=>d])},56e3,44692,a=>{"use strict";let b=(0,a.i(86269).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["default",()=>b],44692),a.s(["ChevronDown",()=>b],56e3)},65403,a=>{"use strict";var b=a.i(58281);a.s(["Check",()=>b.default])},27759,a=>{"use strict";var b=a.i(98143),c=a.i(9626),d=a.i(79536),e=a.i(760);function f({...a}){return(0,b.jsx)(c.Root,{"data-slot":"dialog",...a})}function g({...a}){return(0,b.jsx)(c.Portal,{"data-slot":"dialog-portal",...a})}function h({className:a,...d}){return(0,b.jsx)(c.Overlay,{"data-slot":"dialog-overlay",className:(0,e.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...d})}function i({className:a,children:f,showCloseButton:i=!0,...j}){return(0,b.jsxs)(g,{"data-slot":"dialog-portal",children:[(0,b.jsx)(h,{}),(0,b.jsxs)(c.Content,{"data-slot":"dialog-content",className:(0,e.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-elevation-xl duration-200 sm:max-w-lg",a),...j,children:[f,i&&(0,b.jsxs)(c.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,b.jsx)(d.XIcon,{}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function j({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-header",className:(0,e.cn)("flex flex-col gap-2 text-center sm:text-left",a),...c})}function k({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-footer",className:(0,e.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...c})}function l({className:a,...d}){return(0,b.jsx)(c.Title,{"data-slot":"dialog-title",className:(0,e.cn)("text-lg leading-none font-semibold",a),...d})}function m({className:a,...d}){return(0,b.jsx)(c.Description,{"data-slot":"dialog-description",className:(0,e.cn)("text-muted-foreground text-sm",a),...d})}a.s(["Dialog",()=>f,"DialogContent",()=>i,"DialogDescription",()=>m,"DialogFooter",()=>k,"DialogHeader",()=>j,"DialogTitle",()=>l])},9056,a=>{"use strict";let b=(0,a.i(86269).default)("fast-forward",[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]]);a.s(["FastForward",()=>b],9056)},85146,a=>{"use strict";var b=a.i(8973);a.s(["ChevronRight",()=>b.default])},43607,a=>{"use strict";let b=(0,a.i(86269).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],43607)},40007,a=>{"use strict";function b(a){let b=new Map;for(let c of a)b.set(c.id,c);return b}function c(a,b,d=new Set){if(d.has(a))return d;let e=b.get(a);if(!e)return d;for(let f of(d.add(a),e.dependsOn||[])){let a=f.requiredQuest?.id;a&&c(a,b,d)}return d}function d(a,b){return{questId:a.id,questTitle:a.title,traderId:a.traderId,traderName:a.trader?.name||"Unknown",traderColor:a.trader?.color||"#888888",levelRequired:a.levelRequired,chainLength:c(a.id,b).size-1}}function e(a,e){return{prerequisites:function(a,e){let f=b(e),g=new Set;for(let b of a){let a=c(b,f);for(let c of(a.delete(b),a))g.add(c)}let h=[];for(let a of g){let b=f.get(a);b&&h.push(d(b,f))}return h.sort((a,b)=>a.chainLength-b.chainLength)}(a,e),completedBranches:function(a,e){let f=b(e),g=new Set(a),h=new Set;for(let b of a)for(let a of c(b,f))h.add(a);let i=new Set;for(let b of a)for(let a of function a(b,c,d=new Set){if(d.has(b))return d;let e=c.get(b);if(!e)return d;for(let f of(d.add(b),e.dependedOnBy||[])){let b=f.dependentQuest?.id;b&&a(b,c,d)}return d}(b,f))i.add(a);let j=[];for(let a of e){if(!(!a.dependedOnBy||0===a.dependedOnBy.length)||g.has(a.id)||h.has(a.id)||i.has(a.id))continue;let b=c(a.id,f),e=!1;for(let a of b)if(h.has(a)){e=!0;break}if(e){let b=d(a,f);j.push(b)}}return j.sort((a,b)=>a.levelRequired!==b.levelRequired?a.levelRequired-b.levelRequired:a.traderName.localeCompare(b.traderName))}(a,e)}}function f(a){let b=new Map;for(let c of a){let a=b.get(c.traderId)||[];a.push(c),b.set(c.traderId,a)}return b}a.s(["calculateCatchUp",()=>e,"groupByTrader",()=>f])},74475,32592,a=>{"use strict";var b=a.i(98143),c=a.i(97823),d=a.i(27759),e=a.i(39524),f=a.i(28503),g=a.i(90460),h=a.i(40007),i=a.i(56e3),j=a.i(85146),k=a.i(760);let l=c.forwardRef(({className:a,onCheckedChange:c,onChange:d,...e},f)=>(0,b.jsx)("input",{type:"checkbox",className:(0,k.cn)("h-4 w-4 rounded border border-[var(--tactical-border)] bg-[var(--bg-card)]","text-[var(--accent-gold)] focus:ring-[var(--accent-gold)] focus:ring-offset-0","cursor-pointer transition-colors","checked:bg-[var(--accent-gold)] checked:border-[var(--accent-gold)]",a),ref:f,onChange:a=>{d?.(a),c?.(a.target.checked)},...e}));function m({traderName:a,traderColor:d,quests:e,showCheckboxes:f=!1,checkedQuests:g,onToggleQuest:h,defaultExpanded:k=!0}){let[m,n]=(0,c.useState)(k),o=f&&g?e.filter(a=>g.has(a.questId)).length:e.length;return(0,b.jsxs)("div",{className:"border border-[var(--tactical-border)] rounded-md overflow-hidden",children:[(0,b.jsx)("button",{type:"button",onClick:()=>n(!m),className:"w-full flex items-center justify-between p-3 bg-[var(--bg-elevated)] hover:bg-[var(--bg-panel)] transition-colors","aria-expanded":m,"aria-label":`${a} quests, ${m?"collapse":"expand"}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[m?(0,b.jsx)(i.ChevronDown,{className:"h-4 w-4 text-[var(--text-secondary)]"}):(0,b.jsx)(j.ChevronRight,{className:"h-4 w-4 text-[var(--text-secondary)]"}),(0,b.jsx)("span",{className:"font-medium",style:{color:d},children:a}),(0,b.jsxs)("span",{className:"text-xs text-[var(--text-dim)]",children:["(",o,"/",e.length,")"]})]})}),m&&(0,b.jsx)("div",{className:"divide-y divide-[var(--tactical-border)]",children:e.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-[var(--bg-card)]",children:[f&&g&&h?(0,b.jsx)(l,{id:`quest-${a.questId}`,checked:g.has(a.questId),onCheckedChange:()=>h(a.questId)}):(0,b.jsx)("div",{className:"w-4 h-4 rounded border border-[var(--tactical-border)] bg-[var(--success)]/20 flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-3 h-3 text-[var(--success)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,b.jsx)("label",{htmlFor:f?`quest-${a.questId}`:void 0,className:"flex-1 text-sm text-[var(--text-bright)] cursor-pointer",children:a.questTitle}),(0,b.jsxs)("span",{className:"text-xs text-[var(--text-dim)]",children:["Lv. ",a.levelRequired]})]},a.questId))})]})}l.displayName="Checkbox";var n=a.i(86269);let o=(0,n.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var p=a.i(97643),q=a.i(38752),r=a.i(78938),r=r;let s=(0,n.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var t=a.i(42196),t=t;let u=(0,n.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var v=a.i(56916);function w({open:a,onOpenChange:i,quests:j,onComplete:k,existingProgressCount:l=0}){let[n,w]=(0,c.useState)("select"),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(new Set),[F,G]=(0,c.useState)(!1),H=(0,c.useRef)(null);(0,c.useEffect)(()=>{a||(w("select"),y(""),A([]),C(null),E(new Set))},[a]);let I=(0,c.useMemo)(()=>0===z.length||null===B?null:(0,h.calculateCatchUp)(z.map(a=>a.id),j),[z,j,B]);(0,c.useEffect)(()=>{if(I&&null!==B){let a=new Set;for(let b of I.completedBranches)b.levelRequired<=B&&a.add(b.questId);E(a)}},[I,B]);let J=(0,c.useMemo)(()=>{if(!x.trim())return[];let a=x.toLowerCase(),b=new Set(z.map(a=>a.id));return j.filter(c=>c.title.toLowerCase().includes(a)&&!b.has(c.id)).sort((b,c)=>{let d=b.title.toLowerCase()===a,e=c.title.toLowerCase()===a;return d&&!e?-1:!d&&e?1:b.levelRequired-c.levelRequired}).slice(0,20)},[x,j,z]),K=(0,c.useCallback)(a=>{A(b=>[...b,a]),y(""),H.current?.focus()},[]),L=(0,c.useCallback)(a=>{A(b=>b.filter(b=>b.id!==a))},[]),M=(0,c.useCallback)(a=>{let b=parseInt(a,10);""===a?C(null):!isNaN(b)&&b>=1&&b<=79&&C(b)},[]),N=(0,c.useCallback)(a=>{E(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},[]),O=(0,c.useCallback)(()=>{"select"===n?l>0?w("confirm-reset"):w("review"):"confirm-reset"===n&&w("review")},[n,l]),P=(0,c.useCallback)(()=>{"review"===n?l>0?w("confirm-reset"):w("select"):"confirm-reset"===n&&w("select")},[n,l]),Q=(0,c.useCallback)(async()=>{if(0!==z.length&&null!==B){G(!0);try{let a=await fetch("/api/progress/catch-up",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetQuests:z.map(a=>a.id),playerLevel:B,confirmedBranches:Array.from(D)})});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to catch up progress")}let b=await a.json();v.toast.success("Progress synced!",{description:`Completed ${b.completed.length} prerequisite quests${b.completedBranches?.length>0?` and ${b.completedBranches.length} branch quests`:""}.`}),k(),i(!1)}catch(a){v.toast.error("Failed to sync",{description:a instanceof Error?a.message:"Please try again."})}finally{G(!1)}}},[z,B,D,k,i]),R=z.length>0&&null!==B,S=(0,c.useMemo)(()=>I?(0,h.groupByTrader)(I.prerequisites):new Map,[I]),T=(0,c.useMemo)(()=>I?(0,h.groupByTrader)(I.completedBranches):new Map,[I]);return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:i,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsxs)(d.DialogTitle,{children:["select"===n&&"Catch Up Progress","confirm-reset"===n&&"Progress Reset Warning","review"===n&&"Review Catch-Up"]}),(0,b.jsxs)(d.DialogDescription,{children:["select"===n&&"Select the quests you're currently working on and enter your PMC level.","confirm-reset"===n&&"This will reset your existing progress before applying the catch-up.","review"===n&&"Review the quests that will be marked as completed."]})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-4 py-2 min-h-0 overflow-hidden",children:["select"===n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"shrink-0",children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-1.5 block",children:"Your PMC Level"}),(0,b.jsx)(f.Input,{type:"number",min:1,max:79,value:B??"",onChange:a=>M(a.target.value),placeholder:"Enter level (1-79)",className:"w-32"})]}),(0,b.jsxs)("div",{className:"relative shrink-0",children:[(0,b.jsx)(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(f.Input,{ref:H,value:x,onChange:a=>y(a.target.value),placeholder:"Search quests...",className:"pl-9"})]}),x.trim()&&J.length>0&&(0,b.jsx)("div",{className:"border rounded-md max-h-48 overflow-y-auto shrink-0",children:J.map(a=>{let c=(0,g.getTraderColor)(a.traderId);return(0,b.jsxs)("button",{type:"button",onClick:()=>K(a),className:"w-full px-3 py-2 text-left hover:bg-muted flex items-center gap-2 text-sm",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:c.primary}}),(0,b.jsx)("span",{className:"flex-1 truncate",children:a.title}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground shrink-0",children:["Lv ",a.levelRequired]})]},a.id)})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:z.length>0?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected quests (",z.length,"):"]}),(0,b.jsx)("div",{className:"space-y-1",children:z.map(a=>{let c=(0,g.getTraderColor)(a.traderId);return(0,b.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded-md text-sm",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:c.primary}}),(0,b.jsx)("span",{className:"flex-1 truncate",children:a.title}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground shrink-0",children:["Lv ",a.levelRequired]}),(0,b.jsx)("button",{type:"button",onClick:()=>L(a.id),className:"p-1 hover:bg-muted rounded-sm","aria-label":`Remove ${a.title}`,children:(0,b.jsx)(p.X,{className:"h-3 w-3"})})]},a.id)})})]}):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(o,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"Search for quests you're currently working on"})]})})]}),"confirm-reset"===n&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 gap-4",children:[(0,b.jsx)(t.default,{className:"h-12 w-12 text-yellow-500"}),(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsxs)("p",{className:"font-medium",children:["You have ",l," quest",1!==l?"s":""," marked complete."]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Continuing will reset all existing progress and apply the new catch-up state. This cannot be undone."})]})]}),"review"===n&&I&&(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(u,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Prerequisites"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",I.prerequisites.length," quests)"]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"These quests must be completed to reach your selected quests."}),I.prerequisites.length>0?(0,b.jsx)("div",{className:"space-y-1",children:Array.from(S.entries()).map(([a,c])=>(0,b.jsx)(m,{traderId:a,traderName:c[0].traderName,traderColor:c[0].traderColor,quests:c,locked:!0},a))}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No prerequisites needed."})]}),I.completedBranches.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(r.default,{className:"h-4 w-4 text-green-500"}),(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Completed Branches"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",I.completedBranches.length," terminal quests)"]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"These quest chains ended before your current position. Check the ones you've completed."}),(0,b.jsx)("div",{className:"space-y-1",children:Array.from(T.entries()).map(([a,c])=>(0,b.jsx)(m,{traderId:a,traderName:c[0].traderName,traderColor:c[0].traderColor,quests:c,showCheckboxes:!0,checkedIds:D,onToggle:N,playerLevel:B},a))})]})]})]}),(0,b.jsxs)(d.DialogFooter,{className:"flex-row justify-between sm:justify-between",children:[(0,b.jsx)("div",{children:"select"!==n&&(0,b.jsxs)(e.Button,{variant:"outline",onClick:P,disabled:F,children:[(0,b.jsx)(s,{className:"h-4 w-4 mr-1"}),"Back"]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>i(!1),disabled:F,children:"Cancel"}),"review"===n?(0,b.jsx)(e.Button,{onClick:Q,disabled:F||!R,children:F?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"Syncing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.default,{className:"h-4 w-4 mr-2"}),"Apply Catch-Up"]})}):(0,b.jsx)(e.Button,{onClick:O,disabled:!R,children:"Next"})]})]})]})})}a.s(["CatchUpDialog",()=>w],32592),a.s([],74475)}];

//# sourceMappingURL=_3298a37d._.js.map
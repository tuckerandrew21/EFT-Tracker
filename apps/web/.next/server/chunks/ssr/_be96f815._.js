module.exports=[28503,a=>{"use strict";var b=a.i(98143),c=a.i(97823),d=a.i(760);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,"data-slot":"input",className:(0,d.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground border-input h-9 w-full min-w-0 rounded-md border bg-[var(--bg-elevated)] px-3 py-1 text-base shadow-inset-input transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},58547,50891,a=>{"use strict";var b=a.i(98143),c=a.i(97823);a.i(78979);var d=a.i(14745),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{});a.s(["Primitive",()=>e],50891);var f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(760);function h({className:a,...c}){return(0,b.jsx)(f,{"data-slot":"label",className:(0,g.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}a.s(["Label",()=>h],58547)},69292,a=>{"use strict";let b=(0,a.i(86269).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);a.s(["ExternalLink",()=>b],69292)},45741,a=>{"use strict";let b=(0,a.i(86269).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],45741)},91729,a=>{"use strict";var b=a.i(98143),c=a.i(97823),d=a.i(74065),e=a.i(56916),f=a.i(80730);a.i(39994);var g=a.i(3896),h=a.i(63516),i=a.i(49907),j=a.i(2648),j=j,k=a.i(30703),l=a.i(12188),m=a.i(47885),n=a.i(90460);let o=["Factory","Customs","Woods","Shoreline","Interchange","Reserve","Labs","Lighthouse","Streets of Tarkov","Ground Zero"];function p({quests:a,onQuestDetails:d}){let[e,f]=(0,c.useState)(o[1]),g=(0,c.useMemo)(()=>{let b=[];for(let c of a.filter(a=>"available"===a.computedStatus))for(let a of(c.objectives||[]).filter(a=>a.map===e||null===a.map))a.map===e&&b.push({questId:c.id,questTitle:c.title,traderId:c.traderId,traderName:c.trader.name,objective:a.description,isCompleted:"completed"===c.computedStatus});return b.sort((a,b)=>a.traderName!==b.traderName?a.traderName.localeCompare(b.traderName):a.questTitle.localeCompare(b.questTitle)),b},[a,e]),h=(0,c.useMemo)(()=>{let a=new Map;for(let b of g){let c=a.get(b.questId);c?c.objectives.push(b.objective):a.set(b.questId,{quest:b,objectives:[b.objective]})}return Array.from(a.values())},[g]),p=(0,c.useMemo)(()=>({questCount:h.length,objectiveCount:g.length}),[h,g]),q=(0,c.useMemo)(()=>{let b=[],c=a.filter(a=>"available"===a.computedStatus);for(let a of o){let d=0,e=new Set;for(let b of c)for(let c of b.objectives||[])c.map===a&&(d++,e.add(b.id));d>0&&b.push({map:a,questCount:e.size,objectiveCount:d})}return b.sort((a,b)=>b.objectiveCount-a.objectiveCount).slice(0,5)},[a]);return(0,b.jsxs)("div",{className:"h-full flex flex-col",children:[(0,b.jsx)("div",{className:"p-4 border-b bg-background",children:(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.MapPin,{className:"w-5 h-5 text-[#d4a574]"}),(0,b.jsx)("h2",{className:"font-semibold",children:"Raid Planner"})]}),(0,b.jsxs)(m.Select,{value:e,onValueChange:f,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(m.SelectValue,{placeholder:"Select map"})}),(0,b.jsx)(m.SelectContent,{children:o.map(a=>(0,b.jsx)(m.SelectItem,{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[p.questCount," quest",1!==p.questCount?"s":"",","," ",p.objectiveCount," objective",1!==p.objectiveCount?"s":""]})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-auto flex",children:[(0,b.jsx)("div",{className:"flex-1 p-4 overflow-auto",children:0===h.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,b.jsx)(i.MapPin,{className:"w-12 h-12 text-muted-foreground/30 mb-4"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["No available objectives for ",e]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Complete other quests or select a different map"})]}):(0,b.jsx)("div",{className:"space-y-4 max-w-2xl",children:h.map(({quest:a,objectives:c})=>{let e=(0,n.getTraderColor)(a.traderId);return(0,b.jsxs)("div",{className:"bg-card rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:e.primary}}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h3",{className:"font-medium text-sm truncate",children:a.questTitle}),(0,b.jsx)("p",{className:"text-xs",style:{color:e.primary},children:a.traderName})]})]}),d&&(0,b.jsx)("button",{onClick:()=>d(a.questId),className:"p-1 rounded hover:bg-muted transition-colors flex-shrink-0",title:"View quest details",children:(0,b.jsx)(k.Info,{className:"w-4 h-4 text-muted-foreground"})})]}),(0,b.jsx)("div",{className:"space-y-2",children:c.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,b.jsx)(j.default,{className:"w-4 h-4 text-muted-foreground flex-shrink-0 mt-0.5"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:a})]},c))})]},a.questId)})})}),q.length>0&&(0,b.jsxs)("div",{className:"hidden lg:block w-64 border-l p-4 bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(l.Lightbulb,{className:"w-4 h-4 text-[#d4a574]"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Suggested Maps"})]}),(0,b.jsx)("div",{className:"space-y-2",children:q.map((a,c)=>(0,b.jsxs)("button",{onClick:()=>f(a.map),className:`w-full text-left p-3 rounded-lg transition-colors ${e===a.map?"bg-primary/10 border border-primary/30":"hover:bg-muted"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.map}),0===c&&e!==a.map&&(0,b.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-emerald-500/20 text-emerald-400 rounded",children:"Best"})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[a.questCount," quest",1!==a.questCount?"s":"",","," ",a.objectiveCount," objective",1!==a.objectiveCount?"s":""]})]},a.map))})]})]})]})}a.i(54165);var q=a.i(73920);a.i(86834);var r=a.i(21311);a.i(74475);var s=a.i(32592),t=a.i(70204),u=a.i(49865);let v={locked:null,available:"completed",in_progress:"completed",completed:"available"};function w(){let{status:a}=(0,d.useSession)(),{setStats:i}=(0,f.useStats)(),{allQuests:j,loading:k,initialLoading:l,error:m,refetch:n}=(0,t.useQuests)(),{progress:o,updateStatus:w,unlockedQuests:x,clearUnlocked:y,error:z,savingQuestIds:A,lastSynced:B,isOnline:C,pendingOfflineCount:D}=(0,u.useProgress)(),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(!1),M=(0,c.useMemo)(()=>!!I&&A.has(I.id),[I,A]),N=(0,c.useRef)([]),O=(0,c.useRef)(a),P=(0,c.useRef)(w),Q=(0,c.useRef)(n),R=(0,c.useMemo)(()=>j.map(a=>{if("locked"===a.computedStatus)return{...a,computedStatus:"locked"};let b=o.get(a.id);return{...a,computedStatus:b||a.computedStatus}}),[j,o]);(0,c.useEffect)(()=>{N.current=R},[R]),(0,c.useEffect)(()=>{O.current=a},[a]),(0,c.useEffect)(()=>{P.current=w},[w]),(0,c.useEffect)(()=>{Q.current=n},[n]),(0,c.useEffect)(()=>{if(x.length>0){let a=x.length;e.toast.success(`${a} quest${a>1?"s":""} unlocked!`,{description:"New quests are now available."}),y(),n()}},[x,y,n]),(0,c.useEffect)(()=>{z&&e.toast.error("Progress Error",{description:z})},[z]),(0,c.useEffect)(()=>{k||localStorage.getItem("eft-tracker-onboarding")||F(!0)},[k]);let S=(0,c.useCallback)(()=>{localStorage.setItem("eft-tracker-onboarding","completed"),F(!1)},[]),T=(0,c.useCallback)(()=>{localStorage.setItem("eft-tracker-onboarding","completed"),F(!1),H(!0)},[]),U=(0,c.useCallback)(()=>{n()},[n]),V=(0,c.useCallback)(a=>{let b=N.current.find(b=>b.id===a);b&&(J(b),L(!0))},[]),W=(0,c.useCallback)(async a=>{let b=N.current.find(b=>b.id===a);if(!b)return;let c=b.computedStatus;if("locked"===c)return void e.toast.warning("Quest Locked",{description:"Complete prerequisites to unlock this quest."});if("authenticated"!==O.current)return void e.toast.warning("Sign In Required",{description:"Please sign in to track your progress.",action:{label:"Sign In",onClick:()=>window.location.href="/login"}});let d=v[c];d&&(await P.current(a,d)?("completed"===d&&e.toast.success("Quest Completed!",{description:b.title}),await Q.current()):e.toast.error("Failed to Update",{description:"Could not update quest status. Please try again."}))},[]),X=(0,c.useCallback)(async a=>{await W(a)},[W]),Y=(0,c.useCallback)(async(a,b)=>{if("authenticated"!==O.current)return e.toast.error("Sign in Required",{description:"Please sign in to track quest progress."}),{questStatusChanged:!1};try{let c="boolean"==typeof b?{completed:b}:{current:b.current},d=await fetch(`/api/progress/objective/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a.error||"Failed to update objective")}let f=await d.json();return await Q.current(),f.quest?.statusChanged&&("COMPLETED"===f.quest.status?e.toast.success("Quest Completed!",{description:`All objectives for ${f.quest.title} are complete.`}):"IN_PROGRESS"===f.quest.status&&e.toast.info("Quest Started",{description:f.quest.title})),{questStatusChanged:f.quest?.statusChanged??!1,newQuestStatus:f.quest?.status}}catch(a){return e.toast.error("Failed to Update Objective",{description:a instanceof Error?a.message:"Please try again."}),{questStatusChanged:!1}}},[]),Z=(0,c.useMemo)(()=>({total:R.length,completed:R.filter(a=>"completed"===a.computedStatus).length,available:R.filter(a=>"available"===a.computedStatus).length,locked:R.filter(a=>"locked"===a.computedStatus).length}),[R]);return((0,c.useEffect)(()=>(k||m||i(Z),()=>i(null)),[Z,i,k,m]),l)?(0,b.jsx)(h.QuestTreeSkeleton,{}):m?(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-lg font-medium text-destructive",children:"Error loading quests"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:m}),(0,b.jsx)("button",{onClick:()=>n(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,b.jsx)(q.WelcomeModal,{open:E,onOpenChange:F,onGetStarted:S,onCatchUp:T}),(0,b.jsx)(s.CatchUpDialog,{open:G,onOpenChange:H,quests:R,onComplete:U}),(0,b.jsx)(r.QuestDetailModal,{quest:I,open:K,onOpenChange:L,onStatusChange:X,onObjectiveToggle:Y,isSaving:M}),(0,b.jsx)("div",{className:"flex-1 min-h-0",children:(0,b.jsx)(p,{quests:R,onQuestDetails:V})}),"authenticated"===a&&(0,b.jsx)("div",{className:"shrink-0 px-4 py-2 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,b.jsx)(g.SyncStatusIndicator,{lastSynced:B,isOnline:C,isSaving:A.size>0,pendingOfflineCount:D})})]})}a.s(["RaidClient",()=>w],91729)}];

//# sourceMappingURL=_be96f815._.js.map
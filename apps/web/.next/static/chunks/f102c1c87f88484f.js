(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10012,e=>{"use strict";var t=e.i(95),r=e.i(86375),a=e.i(52088);let s=r.forwardRef(({className:e,type:r,...s},l)=>(0,t.jsx)("input",{type:r,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground border-input h-9 w-full min-w-0 rounded-md border bg-[var(--bg-elevated)] px-3 py-1 text-base shadow-inset-input transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),ref:l,...s}));s.displayName="Input",e.s(["Input",()=>s])},73554,14294,e=>{"use strict";var t=e.i(95),r=e.i(86375);e.i(34063);var a=e.i(83088),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let l=(0,a.createSlot)(`Primitive.${s}`),n=r.forwardRef((e,r)=>{let{asChild:a,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(a?l:s,{...n,ref:r})});return n.displayName=`Primitive.${s}`,{...e,[s]:n}},{});e.s(["Primitive",()=>s],14294);var l=r.forwardRef((e,r)=>(0,t.jsx)(s.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var n=e.i(52088);function o({className:e,...r}){return(0,t.jsx)(l,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>o],73554)},9473,e=>{"use strict";let t=(0,e.i(57475).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>t],9473)},88992,e=>{"use strict";let t=(0,e.i(57475).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],88992)},99282,e=>{"use strict";let t={goldOne:"#e8e6d4",goldTwo:"#c4aa6a",gunmetal:"#272727",gunmetalDark:"#1a1a1a",blackLight:"#0f0f0f",border:"rgba(196, 170, 106, 0.4)"},r={prapor:{primary:"#c41e3a",bg:t.gunmetal},therapist:{primary:"#ff69b4",bg:t.gunmetal},skier:{primary:"#1e90ff",bg:t.gunmetal},peacekeeper:{primary:"#228b22",bg:t.gunmetal},mechanic:{primary:"#ff8c00",bg:t.gunmetal},ragman:{primary:"#9370db",bg:t.gunmetal},jaeger:{primary:"#8b4513",bg:t.gunmetal},fence:{primary:"#708090",bg:t.gunmetal},lightkeeper:{primary:"#ffd700",bg:t.gunmetal},ref:{primary:"#20b2aa",bg:t.gunmetal}};function a(e){return r[e.toLowerCase()]||{primary:t.goldTwo,bg:t.gunmetal}}e.s(["EFT_COLORS",0,t,"STATUS_COLORS",0,{locked:{primary:"#5a5a5a",bg:"#1a1a1a",border:"#3a3a3a"},available:{primary:"#4db8ff",bg:"#1a1a1a",border:"#4db8ff"},in_progress:{primary:"#fbbf24",bg:"#1a1a1a",border:"#fbbf24"},completed:{primary:"#4ade80",bg:"#1e2e1e",border:"#4ade80"}},"TRADER_COLORS",0,r,"getTraderColor",()=>a])},59467,92610,e=>{"use strict";let t=(0,e.i(57475).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["default",()=>t],92610),e.s(["ChevronDown",()=>t],59467)},8139,e=>{"use strict";var t=e.i(57993);e.s(["Check",()=>t.default])},47608,e=>{"use strict";var t=e.i(95),r=e.i(31104),a=e.i(24139),s=e.i(52088);function l({...e}){return(0,t.jsx)(r.Root,{"data-slot":"dialog",...e})}function n({...e}){return(0,t.jsx)(r.Portal,{"data-slot":"dialog-portal",...e})}function o({className:e,...a}){return(0,t.jsx)(r.Overlay,{"data-slot":"dialog-overlay",className:(0,s.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...a})}function i({className:e,children:l,showCloseButton:i=!0,...d}){return(0,t.jsxs)(n,{"data-slot":"dialog-portal",children:[(0,t.jsx)(o,{}),(0,t.jsxs)(r.Content,{"data-slot":"dialog-content",className:(0,s.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-elevation-xl duration-200 sm:max-w-lg",e),...d,children:[l,i&&(0,t.jsxs)(r.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(a.XIcon,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function d({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,s.cn)("flex flex-col gap-2 text-center sm:text-left",e),...r})}function c({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,s.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...r})}function u({className:e,...a}){return(0,t.jsx)(r.Title,{"data-slot":"dialog-title",className:(0,s.cn)("text-lg leading-none font-semibold",e),...a})}function p({className:e,...a}){return(0,t.jsx)(r.Description,{"data-slot":"dialog-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}e.s(["Dialog",()=>l,"DialogContent",()=>i,"DialogDescription",()=>p,"DialogFooter",()=>c,"DialogHeader",()=>d,"DialogTitle",()=>u])},71437,e=>{"use strict";var t=e.i(20287);e.s(["ChevronRight",()=>t.default])},23158,e=>{"use strict";let t=(0,e.i(57475).default)("fast-forward",[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]]);e.s(["FastForward",()=>t],23158)},68169,e=>{"use strict";let t=(0,e.i(57475).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],68169)},56876,e=>{"use strict";function t(e){let t=new Map;for(let r of e)t.set(r.id,r);return t}function r(e,t,a=new Set){if(a.has(e))return a;let s=t.get(e);if(!s)return a;for(let l of(a.add(e),s.dependsOn||[])){let e=l.requiredQuest?.id;e&&r(e,t,a)}return a}function a(e,t){return{questId:e.id,questTitle:e.title,traderId:e.traderId,traderName:e.trader?.name||"Unknown",traderColor:e.trader?.color||"#888888",levelRequired:e.levelRequired,chainLength:r(e.id,t).size-1}}function s(e,s){return{prerequisites:function(e,s){let l=t(s),n=new Set;for(let t of e){let e=r(t,l);for(let r of(e.delete(t),e))n.add(r)}let o=[];for(let e of n){let t=l.get(e);t&&o.push(a(t,l))}return o.sort((e,t)=>e.chainLength-t.chainLength)}(e,s),completedBranches:function(e,s){let l=t(s),n=new Set(e),o=new Set;for(let t of e)for(let e of r(t,l))o.add(e);let i=new Set;for(let t of e)for(let e of function e(t,r,a=new Set){if(a.has(t))return a;let s=r.get(t);if(!s)return a;for(let l of(a.add(t),s.dependedOnBy||[])){let t=l.dependentQuest?.id;t&&e(t,r,a)}return a}(t,l))i.add(e);let d=[];for(let e of s){if(!(!e.dependedOnBy||0===e.dependedOnBy.length)||n.has(e.id)||o.has(e.id)||i.has(e.id))continue;let t=r(e.id,l),s=!1;for(let e of t)if(o.has(e)){s=!0;break}if(s){let t=a(e,l);d.push(t)}}return d.sort((e,t)=>e.levelRequired!==t.levelRequired?e.levelRequired-t.levelRequired:e.traderName.localeCompare(t.traderName))}(e,s)}}function l(e){let t=new Map;for(let r of e){let e=t.get(r.traderId)||[];e.push(r),t.set(r.traderId,e)}return t}e.s(["calculateCatchUp",()=>s,"groupByTrader",()=>l])},57213,77033,e=>{"use strict";var t=e.i(95),r=e.i(86375),a=e.i(47608),s=e.i(85902),l=e.i(10012),n=e.i(99282),o=e.i(56876),i=e.i(59467),d=e.i(71437),c=e.i(52088);let u=r.forwardRef(({className:e,onCheckedChange:r,onChange:a,...s},l)=>(0,t.jsx)("input",{type:"checkbox",className:(0,c.cn)("h-4 w-4 rounded border border-[var(--tactical-border)] bg-[var(--bg-card)]","text-[var(--accent-gold)] focus:ring-[var(--accent-gold)] focus:ring-offset-0","cursor-pointer transition-colors","checked:bg-[var(--accent-gold)] checked:border-[var(--accent-gold)]",e),ref:l,onChange:e=>{a?.(e),r?.(e.target.checked)},...s}));function p({traderName:e,traderColor:a,quests:s,showCheckboxes:l=!1,checkedQuests:n,onToggleQuest:o,defaultExpanded:c=!0}){let[p,m]=(0,r.useState)(c),f=l&&n?s.filter(e=>n.has(e.questId)).length:s.length;return(0,t.jsxs)("div",{className:"border border-[var(--tactical-border)] rounded-md overflow-hidden",children:[(0,t.jsx)("button",{type:"button",onClick:()=>m(!p),className:"w-full flex items-center justify-between p-3 bg-[var(--bg-elevated)] hover:bg-[var(--bg-panel)] transition-colors","aria-expanded":p,"aria-label":`${e} quests, ${p?"collapse":"expand"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[p?(0,t.jsx)(i.ChevronDown,{className:"h-4 w-4 text-[var(--text-secondary)]"}):(0,t.jsx)(d.ChevronRight,{className:"h-4 w-4 text-[var(--text-secondary)]"}),(0,t.jsx)("span",{className:"font-medium",style:{color:a},children:e}),(0,t.jsxs)("span",{className:"text-xs text-[var(--text-dim)]",children:["(",f,"/",s.length,")"]})]})}),p&&(0,t.jsx)("div",{className:"divide-y divide-[var(--tactical-border)]",children:s.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-[var(--bg-card)]",children:[l&&n&&o?(0,t.jsx)(u,{id:`quest-${e.questId}`,checked:n.has(e.questId),onCheckedChange:()=>o(e.questId)}):(0,t.jsx)("div",{className:"w-4 h-4 rounded border border-[var(--tactical-border)] bg-[var(--success)]/20 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-3 h-3 text-[var(--success)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("label",{htmlFor:l?`quest-${e.questId}`:void 0,className:"flex-1 text-sm text-[var(--text-bright)] cursor-pointer",children:e.questTitle}),(0,t.jsxs)("span",{className:"text-xs text-[var(--text-dim)]",children:["Lv. ",e.levelRequired]})]},e.questId))})]})}u.displayName="Checkbox";var m=e.i(57475);let f=(0,m.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var h=e.i(83832),x=e.i(98844),g=e.i(46361),g=g;let v=(0,m.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var y=e.i(26178),y=y;let b=(0,m.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var w=e.i(95403);function j({open:e,onOpenChange:i,quests:d,onComplete:c,existingProgressCount:u=0}){let[m,j]=(0,r.useState)("select"),[k,C]=(0,r.useState)(""),[N,S]=(0,r.useState)([]),[q,R]=(0,r.useState)(null),[T,L]=(0,r.useState)(new Set),[M,I]=(0,r.useState)(!1),P=(0,r.useRef)(null);(0,r.useEffect)(()=>{e||(j("select"),C(""),S([]),R(null),L(new Set))},[e]);let E=(0,r.useMemo)(()=>0===N.length||null===q?null:(0,o.calculateCatchUp)(N.map(e=>e.id),d),[N,d,q]);(0,r.useEffect)(()=>{if(E&&null!==q){let e=new Set;for(let t of E.completedBranches)t.levelRequired<=q&&e.add(t.questId);L(e)}},[E,q]);let D=(0,r.useMemo)(()=>{if(!k.trim())return[];let e=k.toLowerCase(),t=new Set(N.map(e=>e.id));return d.filter(r=>r.title.toLowerCase().includes(e)&&!t.has(r.id)).sort((t,r)=>{let a=t.title.toLowerCase()===e,s=r.title.toLowerCase()===e;return a&&!s?-1:!a&&s?1:t.levelRequired-r.levelRequired}).slice(0,20)},[k,d,N]),O=(0,r.useCallback)(e=>{S(t=>[...t,e]),C(""),P.current?.focus()},[]),A=(0,r.useCallback)(e=>{S(t=>t.filter(t=>t.id!==e))},[]),H=(0,r.useCallback)(e=>{let t=parseInt(e,10);""===e?R(null):!isNaN(t)&&t>=1&&t<=79&&R(t)},[]),B=(0,r.useCallback)(e=>{L(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),z=(0,r.useCallback)(()=>{"select"===m?u>0?j("confirm-reset"):j("review"):"confirm-reset"===m&&j("review")},[m,u]),_=(0,r.useCallback)(()=>{"review"===m?u>0?j("confirm-reset"):j("select"):"confirm-reset"===m&&j("select")},[m,u]),F=(0,r.useCallback)(async()=>{if(0!==N.length&&null!==q){I(!0);try{let e=await fetch("/api/progress/catch-up",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetQuests:N.map(e=>e.id),playerLevel:q,confirmedBranches:Array.from(T)})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to catch up progress")}let t=await e.json();w.toast.success("Progress synced!",{description:`Completed ${t.completed.length} prerequisite quests${t.completedBranches?.length>0?` and ${t.completedBranches.length} branch quests`:""}.`}),c(),i(!1)}catch(e){w.toast.error("Failed to sync",{description:e instanceof Error?e.message:"Please try again."})}finally{I(!1)}}},[N,q,T,c,i]),$=N.length>0&&null!==q,U=(0,r.useMemo)(()=>E?(0,o.groupByTrader)(E.prerequisites):new Map,[E]),Q=(0,r.useMemo)(()=>E?(0,o.groupByTrader)(E.completedBranches):new Map,[E]);return(0,t.jsx)(a.Dialog,{open:e,onOpenChange:i,children:(0,t.jsxs)(a.DialogContent,{className:"max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsxs)(a.DialogTitle,{children:["select"===m&&"Catch Up Progress","confirm-reset"===m&&"Progress Reset Warning","review"===m&&"Review Catch-Up"]}),(0,t.jsxs)(a.DialogDescription,{children:["select"===m&&"Select the quests you're currently working on and enter your PMC level.","confirm-reset"===m&&"This will reset your existing progress before applying the catch-up.","review"===m&&"Review the quests that will be marked as completed."]})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-4 py-2 min-h-0 overflow-hidden",children:["select"===m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"shrink-0",children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-1.5 block",children:"Your PMC Level"}),(0,t.jsx)(l.Input,{type:"number",min:1,max:79,value:q??"",onChange:e=>H(e.target.value),placeholder:"Enter level (1-79)",className:"w-32"})]}),(0,t.jsxs)("div",{className:"relative shrink-0",children:[(0,t.jsx)(f,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(l.Input,{ref:P,value:k,onChange:e=>C(e.target.value),placeholder:"Search quests...",className:"pl-9"})]}),k.trim()&&D.length>0&&(0,t.jsx)("div",{className:"border rounded-md max-h-48 overflow-y-auto shrink-0",children:D.map(e=>{let r=(0,n.getTraderColor)(e.traderId);return(0,t.jsxs)("button",{type:"button",onClick:()=>O(e),className:"w-full px-3 py-2 text-left hover:bg-muted flex items-center gap-2 text-sm",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:r.primary}}),(0,t.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground shrink-0",children:["Lv ",e.levelRequired]})]},e.id)})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:N.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected quests (",N.length,"):"]}),(0,t.jsx)("div",{className:"space-y-1",children:N.map(e=>{let r=(0,n.getTraderColor)(e.traderId);return(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded-md text-sm",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:r.primary}}),(0,t.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground shrink-0",children:["Lv ",e.levelRequired]}),(0,t.jsx)("button",{type:"button",onClick:()=>A(e.id),className:"p-1 hover:bg-muted rounded-sm","aria-label":`Remove ${e.title}`,children:(0,t.jsx)(h.X,{className:"h-3 w-3"})})]},e.id)})})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(f,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"Search for quests you're currently working on"})]})})]}),"confirm-reset"===m&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 gap-4",children:[(0,t.jsx)(y.default,{className:"h-12 w-12 text-yellow-500"}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsxs)("p",{className:"font-medium",children:["You have ",u," quest",1!==u?"s":""," marked complete."]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Continuing will reset all existing progress and apply the new catch-up state. This cannot be undone."})]})]}),"review"===m&&E&&(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(b,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("h3",{className:"text-sm font-medium",children:"Prerequisites"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",E.prerequisites.length," quests)"]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"These quests must be completed to reach your selected quests."}),E.prerequisites.length>0?(0,t.jsx)("div",{className:"space-y-1",children:Array.from(U.entries()).map(([e,r])=>(0,t.jsx)(p,{traderId:e,traderName:r[0].traderName,traderColor:r[0].traderColor,quests:r,locked:!0},e))}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No prerequisites needed."})]}),E.completedBranches.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(g.default,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("h3",{className:"text-sm font-medium",children:"Completed Branches"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",E.completedBranches.length," terminal quests)"]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"These quest chains ended before your current position. Check the ones you've completed."}),(0,t.jsx)("div",{className:"space-y-1",children:Array.from(Q.entries()).map(([e,r])=>(0,t.jsx)(p,{traderId:e,traderName:r[0].traderName,traderColor:r[0].traderColor,quests:r,showCheckboxes:!0,checkedIds:T,onToggle:B,playerLevel:q},e))})]})]})]}),(0,t.jsxs)(a.DialogFooter,{className:"flex-row justify-between sm:justify-between",children:[(0,t.jsx)("div",{children:"select"!==m&&(0,t.jsxs)(s.Button,{variant:"outline",onClick:_,disabled:M,children:[(0,t.jsx)(v,{className:"h-4 w-4 mr-1"}),"Back"]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>i(!1),disabled:M,children:"Cancel"}),"review"===m?(0,t.jsx)(s.Button,{onClick:F,disabled:M||!$,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"Syncing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.default,{className:"h-4 w-4 mr-2"}),"Apply Catch-Up"]})}):(0,t.jsx)(s.Button,{onClick:z,disabled:!$,children:"Next"})]})]})]})})}e.s(["CatchUpDialog",()=>j],77033),e.s([],57213)},37834,e=>{"use strict";var t=e.i(95),r=e.i(47608),a=e.i(85902),s=e.i(7347),l=e.i(99282);function n({open:e,onOpenChange:n,targetQuest:o,prerequisites:i,onConfirm:d,isLoading:c=!1}){if(!o)return null;let u=new Map;for(let e of i){let t=e.trader.id;u.has(t)||u.set(t,[]),u.get(t).push(e)}return(0,t.jsx)(r.Dialog,{open:e,onOpenChange:n,children:(0,t.jsxs)(r.DialogContent,{className:"max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[(0,t.jsxs)(r.DialogHeader,{children:[(0,t.jsx)(r.DialogTitle,{children:"Skip to Quest"}),(0,t.jsxs)(r.DialogDescription,{children:["Mark all prerequisite quests as completed to unlock"," ",(0,t.jsx)("span",{className:"font-semibold",children:o.title}),"?"]})]}),i.length>0?(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto py-4",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["The following ",i.length," quest",i.length>1?"s":""," will be marked as completed:"]}),(0,t.jsx)("div",{className:"space-y-3",children:Array.from(u.entries()).map(([e,r])=>{let a=(0,l.getTraderColor)(e),n=r[0].trader.name;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:a.primary}}),(0,t.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:n}),(0,t.jsx)(s.Badge,{variant:"secondary",className:"text-xs",children:r.length})]}),(0,t.jsx)("ul",{className:"space-y-1 ml-4",children:r.map(e=>(0,t.jsxs)("li",{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:a.primary}}),e.title,(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Lv.",e.levelRequired]})]},e.id))})]},e)})})]}):(0,t.jsx)("div",{className:"py-4 text-sm text-muted-foreground",children:"This quest has no incomplete prerequisites. It should already be available!"}),(0,t.jsxs)(r.DialogFooter,{children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>n(!1),disabled:c,children:"Cancel"}),(0,t.jsx)(a.Button,{onClick:d,disabled:c||0===i.length,children:c?"Completing...":`Complete ${i.length} Quest${1!==i.length?"s":""}`})]})]})})}e.s(["SkipQuestDialog",()=>n])},80707,e=>{"use strict";var t=e.i(95),r=e.i(86375),a=e.i(34063);function s(e,[t,r]){return Math.min(r,Math.max(t,e))}var l=e.i(91967),n=e.i(20977),o=e.i(60856),i=e.i(50439),d=e.i(49399),c=e.i(59025),u=e.i(64614),p=e.i(67194),m=e.i(19104),f=e.i(74907),h=e.i(62746),x=e.i(81026),g=e.i(36740),v=e.i(55406),y=e.i(68494),b=e.i(72852),w=e.i(5685),j=e.i(43231),k=e.i(73772),C=e.i(14329),N=[" ","Enter","ArrowUp","ArrowDown"],S=[" ","Enter"],q="Select",[R,T,L]=(0,n.createCollection)(q),[M,I]=(0,i.createContextScope)(q,[L,f.createPopperScope]),P=(0,f.createPopperScope)(),[E,D]=M(q),[O,A]=M(q),H=e=>{let{__scopeSelect:a,children:s,open:l,defaultOpen:n,onOpenChange:o,value:i,defaultValue:c,onValueChange:u,dir:p,name:h,autoComplete:x,disabled:g,required:v,form:b}=e,w=P(a),[j,k]=r.useState(null),[C,N]=r.useState(null),[S,T]=r.useState(!1),L=(0,d.useDirection)(p),[M,I]=(0,y.useControllableState)({prop:l,defaultProp:n??!1,onChange:o,caller:q}),[D,A]=(0,y.useControllableState)({prop:i,defaultProp:c,onChange:u,caller:q}),H=r.useRef(null),B=!j||b||!!j.closest("form"),[z,_]=r.useState(new Set),F=Array.from(z).map(e=>e.props.value).join(";");return(0,t.jsx)(f.Root,{...w,children:(0,t.jsxs)(E,{required:v,scope:a,trigger:j,onTriggerChange:k,valueNode:C,onValueNodeChange:N,valueNodeHasChildren:S,onValueNodeHasChildrenChange:T,contentId:(0,m.useId)(),value:D,onValueChange:A,open:M,onOpenChange:I,dir:L,triggerPointerDownPosRef:H,disabled:g,children:[(0,t.jsx)(R.Provider,{scope:a,children:(0,t.jsx)(O,{scope:e.__scopeSelect,onNativeOptionAdd:r.useCallback(e=>{_(t=>new Set(t).add(e))},[]),onNativeOptionRemove:r.useCallback(e=>{_(t=>{let r=new Set(t);return r.delete(e),r})},[]),children:s})}),B?(0,t.jsxs)(ew,{"aria-hidden":!0,required:v,tabIndex:-1,name:h,autoComplete:x,value:D,onChange:e=>A(e.target.value),disabled:g,form:b,children:[void 0===D?(0,t.jsx)("option",{value:""}):null,Array.from(z)]},F):null]})})};H.displayName=q;var B="SelectTrigger",z=r.forwardRef((e,a)=>{let{__scopeSelect:s,disabled:n=!1,...i}=e,d=P(s),c=D(B,s),u=c.disabled||n,p=(0,o.useComposedRefs)(a,c.onTriggerChange),m=T(s),h=r.useRef("touch"),[g,v,y]=ek(e=>{let t=m().filter(e=>!e.disabled),r=t.find(e=>e.value===c.value),a=eC(t,e,r);void 0!==a&&c.onValueChange(a.value)}),b=e=>{u||(c.onOpenChange(!0),y()),e&&(c.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,t.jsx)(f.Anchor,{asChild:!0,...d,children:(0,t.jsx)(x.Primitive.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":ej(c.value)?"":void 0,...i,ref:p,onClick:(0,l.composeEventHandlers)(i.onClick,e=>{e.currentTarget.focus(),"mouse"!==h.current&&b(e)}),onPointerDown:(0,l.composeEventHandlers)(i.onPointerDown,e=>{h.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(b(e),e.preventDefault())}),onKeyDown:(0,l.composeEventHandlers)(i.onKeyDown,e=>{let t=""!==g.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||v(e.key),(!t||" "!==e.key)&&N.includes(e.key)&&(b(),e.preventDefault())})})})});z.displayName=B;var _="SelectValue",F=r.forwardRef((e,r)=>{let{__scopeSelect:a,className:s,style:l,children:n,placeholder:i="",...d}=e,c=D(_,a),{onValueNodeHasChildrenChange:u}=c,p=void 0!==n,m=(0,o.useComposedRefs)(r,c.onValueNodeChange);return(0,b.useLayoutEffect)(()=>{u(p)},[u,p]),(0,t.jsx)(x.Primitive.span,{...d,ref:m,style:{pointerEvents:"none"},children:ej(c.value)?(0,t.jsx)(t.Fragment,{children:i}):n})});F.displayName=_;var $=r.forwardRef((e,r)=>{let{__scopeSelect:a,children:s,...l}=e;return(0,t.jsx)(x.Primitive.span,{"aria-hidden":!0,...l,ref:r,children:s||"â–¼"})});$.displayName="SelectIcon";var U=e=>(0,t.jsx)(h.Portal,{asChild:!0,...e});U.displayName="SelectPortal";var Q="SelectContent",V=r.forwardRef((e,s)=>{let l=D(Q,e.__scopeSelect),[n,o]=r.useState();return((0,b.useLayoutEffect)(()=>{o(new DocumentFragment)},[]),l.open)?(0,t.jsx)(X,{...e,ref:s}):n?a.createPortal((0,t.jsx)(K,{scope:e.__scopeSelect,children:(0,t.jsx)(R.Slot,{scope:e.__scopeSelect,children:(0,t.jsx)("div",{children:e.children})})}),n):null});V.displayName=Q;var[K,W]=M(Q),Y=(0,g.createSlot)("SelectContent.RemoveScroll"),X=r.forwardRef((e,a)=>{let{__scopeSelect:s,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:d,onPointerDownOutside:m,side:f,sideOffset:h,align:x,alignOffset:g,arrowPadding:v,collisionBoundary:y,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:N,...S}=e,q=D(Q,s),[R,L]=r.useState(null),[M,I]=r.useState(null),P=(0,o.useComposedRefs)(a,e=>L(e)),[E,O]=r.useState(null),[A,H]=r.useState(null),B=T(s),[z,_]=r.useState(!1),F=r.useRef(!1);r.useEffect(()=>{if(R)return(0,k.hideOthers)(R)},[R]),(0,u.useFocusGuards)();let $=r.useCallback(e=>{let[t,...r]=B().map(e=>e.ref.current),[a]=r.slice(-1),s=document.activeElement;for(let r of e)if(r===s||(r?.scrollIntoView({block:"nearest"}),r===t&&M&&(M.scrollTop=0),r===a&&M&&(M.scrollTop=M.scrollHeight),r?.focus(),document.activeElement!==s))return},[B,M]),U=r.useCallback(()=>$([E,R]),[$,E,R]);r.useEffect(()=>{z&&U()},[z,U]);let{onOpenChange:V,triggerPointerDownPosRef:W}=q;r.useEffect(()=>{if(R){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(W.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(W.current?.y??0))}},r=r=>{e.x<=10&&e.y<=10?r.preventDefault():R.contains(r.target)||V(!1),document.removeEventListener("pointermove",t),W.current=null};return null!==W.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",r,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",r,{capture:!0})}}},[R,V,W]),r.useEffect(()=>{let e=()=>V(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[V]);let[X,Z]=ek(e=>{let t=B().filter(e=>!e.disabled),r=t.find(e=>e.ref.current===document.activeElement),a=eC(t,e,r);a&&setTimeout(()=>a.ref.current.focus())}),ee=r.useCallback((e,t,r)=>{let a=!F.current&&!r;(void 0!==q.value&&q.value===t||a)&&(O(e),a&&(F.current=!0))},[q.value]),et=r.useCallback(()=>R?.focus(),[R]),er=r.useCallback((e,t,r)=>{let a=!F.current&&!r;(void 0!==q.value&&q.value===t||a)&&H(e)},[q.value]),ea="popper"===n?J:G,es=ea===J?{side:f,sideOffset:h,align:x,alignOffset:g,arrowPadding:v,collisionBoundary:y,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:N}:{};return(0,t.jsx)(K,{scope:s,content:R,viewport:M,onViewportChange:I,itemRefCallback:ee,selectedItem:E,onItemLeave:et,itemTextRefCallback:er,focusSelectedItem:U,selectedItemText:A,position:n,isPositioned:z,searchRef:X,children:(0,t.jsx)(C.RemoveScroll,{as:Y,allowPinchZoom:!0,children:(0,t.jsx)(p.FocusScope,{asChild:!0,trapped:q.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:(0,l.composeEventHandlers)(i,e=>{q.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,t.jsx)(c.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>q.onOpenChange(!1),children:(0,t.jsx)(ea,{role:"listbox",id:q.contentId,"data-state":q.open?"open":"closed",dir:q.dir,onContextMenu:e=>e.preventDefault(),...S,...es,onPlaced:()=>_(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:(0,l.composeEventHandlers)(S.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||Z(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=B().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let r=e.target,a=t.indexOf(r);t=t.slice(a+1)}setTimeout(()=>$(t)),e.preventDefault()}})})})})})})});X.displayName="SelectContentImpl";var G=r.forwardRef((e,a)=>{let{__scopeSelect:l,onPlaced:n,...i}=e,d=D(Q,l),c=W(Q,l),[u,p]=r.useState(null),[m,f]=r.useState(null),h=(0,o.useComposedRefs)(a,e=>f(e)),g=T(l),v=r.useRef(!1),y=r.useRef(!0),{viewport:w,selectedItem:j,selectedItemText:k,focusSelectedItem:C}=c,N=r.useCallback(()=>{if(d.trigger&&d.valueNode&&u&&m&&w&&j&&k){let e=d.trigger.getBoundingClientRect(),t=m.getBoundingClientRect(),r=d.valueNode.getBoundingClientRect(),a=k.getBoundingClientRect();if("rtl"!==d.dir){let l=a.left-t.left,n=r.left-l,o=e.left-n,i=e.width+o,d=Math.max(i,t.width),c=s(n,[10,Math.max(10,window.innerWidth-10-d)]);u.style.minWidth=i+"px",u.style.left=c+"px"}else{let l=t.right-a.right,n=window.innerWidth-r.right-l,o=window.innerWidth-e.right-n,i=e.width+o,d=Math.max(i,t.width),c=s(n,[10,Math.max(10,window.innerWidth-10-d)]);u.style.minWidth=i+"px",u.style.right=c+"px"}let l=g(),o=window.innerHeight-20,i=w.scrollHeight,c=window.getComputedStyle(m),p=parseInt(c.borderTopWidth,10),f=parseInt(c.paddingTop,10),h=parseInt(c.borderBottomWidth,10),x=p+f+i+parseInt(c.paddingBottom,10)+h,y=Math.min(5*j.offsetHeight,x),b=window.getComputedStyle(w),C=parseInt(b.paddingTop,10),N=parseInt(b.paddingBottom,10),S=e.top+e.height/2-10,q=j.offsetHeight/2,R=p+f+(j.offsetTop+q);if(R<=S){let e=l.length>0&&j===l[l.length-1].ref.current;u.style.bottom="0px";let t=Math.max(o-S,q+(e?N:0)+(m.clientHeight-w.offsetTop-w.offsetHeight)+h);u.style.height=R+t+"px"}else{let e=l.length>0&&j===l[0].ref.current;u.style.top="0px";let t=Math.max(S,p+w.offsetTop+(e?C:0)+q);u.style.height=t+(x-R)+"px",w.scrollTop=R-S+w.offsetTop}u.style.margin="10px 0",u.style.minHeight=y+"px",u.style.maxHeight=o+"px",n?.(),requestAnimationFrame(()=>v.current=!0)}},[g,d.trigger,d.valueNode,u,m,w,j,k,d.dir,n]);(0,b.useLayoutEffect)(()=>N(),[N]);let[S,q]=r.useState();(0,b.useLayoutEffect)(()=>{m&&q(window.getComputedStyle(m).zIndex)},[m]);let R=r.useCallback(e=>{e&&!0===y.current&&(N(),C?.(),y.current=!1)},[N,C]);return(0,t.jsx)(Z,{scope:l,contentWrapper:u,shouldExpandOnScrollRef:v,onScrollButtonChange:R,children:(0,t.jsx)("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:(0,t.jsx)(x.Primitive.div,{...i,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});G.displayName="SelectItemAlignedPosition";var J=r.forwardRef((e,r)=>{let{__scopeSelect:a,align:s="start",collisionPadding:l=10,...n}=e,o=P(a);return(0,t.jsx)(f.Content,{...o,...n,ref:r,align:s,collisionPadding:l,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});J.displayName="SelectPopperPosition";var[Z,ee]=M(Q,{}),et="SelectViewport",er=r.forwardRef((e,a)=>{let{__scopeSelect:s,nonce:n,...i}=e,d=W(et,s),c=ee(et,s),u=(0,o.useComposedRefs)(a,d.onViewportChange),p=r.useRef(0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),(0,t.jsx)(R.Slot,{scope:s,children:(0,t.jsx)(x.Primitive.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:(0,l.composeEventHandlers)(i.onScroll,e=>{let t=e.currentTarget,{contentWrapper:r,shouldExpandOnScrollRef:a}=c;if(a?.current&&r){let e=Math.abs(p.current-t.scrollTop);if(e>0){let a=window.innerHeight-20,s=Math.max(parseFloat(r.style.minHeight),parseFloat(r.style.height));if(s<a){let l=s+e,n=Math.min(a,l),o=l-n;r.style.height=n+"px","0px"===r.style.bottom&&(t.scrollTop=o>0?o:0,r.style.justifyContent="flex-end")}}}p.current=t.scrollTop})})})]})});er.displayName=et;var ea="SelectGroup",[es,el]=M(ea);r.forwardRef((e,r)=>{let{__scopeSelect:a,...s}=e,l=(0,m.useId)();return(0,t.jsx)(es,{scope:a,id:l,children:(0,t.jsx)(x.Primitive.div,{role:"group","aria-labelledby":l,...s,ref:r})})}).displayName=ea;var en="SelectLabel";r.forwardRef((e,r)=>{let{__scopeSelect:a,...s}=e,l=el(en,a);return(0,t.jsx)(x.Primitive.div,{id:l.id,...s,ref:r})}).displayName=en;var eo="SelectItem",[ei,ed]=M(eo),ec=r.forwardRef((e,a)=>{let{__scopeSelect:s,value:n,disabled:i=!1,textValue:d,...c}=e,u=D(eo,s),p=W(eo,s),f=u.value===n,[h,g]=r.useState(d??""),[v,y]=r.useState(!1),b=(0,o.useComposedRefs)(a,e=>p.itemRefCallback?.(e,n,i)),w=(0,m.useId)(),j=r.useRef("touch"),k=()=>{i||(u.onValueChange(n),u.onOpenChange(!1))};if(""===n)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,t.jsx)(ei,{scope:s,value:n,disabled:i,textId:w,isSelected:f,onItemTextChange:r.useCallback(e=>{g(t=>t||(e?.textContent??"").trim())},[]),children:(0,t.jsx)(R.ItemSlot,{scope:s,value:n,disabled:i,textValue:h,children:(0,t.jsx)(x.Primitive.div,{role:"option","aria-labelledby":w,"data-highlighted":v?"":void 0,"aria-selected":f&&v,"data-state":f?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...c,ref:b,onFocus:(0,l.composeEventHandlers)(c.onFocus,()=>y(!0)),onBlur:(0,l.composeEventHandlers)(c.onBlur,()=>y(!1)),onClick:(0,l.composeEventHandlers)(c.onClick,()=>{"mouse"!==j.current&&k()}),onPointerUp:(0,l.composeEventHandlers)(c.onPointerUp,()=>{"mouse"===j.current&&k()}),onPointerDown:(0,l.composeEventHandlers)(c.onPointerDown,e=>{j.current=e.pointerType}),onPointerMove:(0,l.composeEventHandlers)(c.onPointerMove,e=>{j.current=e.pointerType,i?p.onItemLeave?.():"mouse"===j.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:(0,l.composeEventHandlers)(c.onPointerLeave,e=>{e.currentTarget===document.activeElement&&p.onItemLeave?.()}),onKeyDown:(0,l.composeEventHandlers)(c.onKeyDown,e=>{(p.searchRef?.current===""||" "!==e.key)&&(S.includes(e.key)&&k()," "===e.key&&e.preventDefault())})})})})});ec.displayName=eo;var eu="SelectItemText",ep=r.forwardRef((e,s)=>{let{__scopeSelect:l,className:n,style:i,...d}=e,c=D(eu,l),u=W(eu,l),p=ed(eu,l),m=A(eu,l),[f,h]=r.useState(null),g=(0,o.useComposedRefs)(s,e=>h(e),p.onItemTextChange,e=>u.itemTextRefCallback?.(e,p.value,p.disabled)),v=f?.textContent,y=r.useMemo(()=>(0,t.jsx)("option",{value:p.value,disabled:p.disabled,children:v},p.value),[p.disabled,p.value,v]),{onNativeOptionAdd:w,onNativeOptionRemove:j}=m;return(0,b.useLayoutEffect)(()=>(w(y),()=>j(y)),[w,j,y]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Primitive.span,{id:p.textId,...d,ref:g}),p.isSelected&&c.valueNode&&!c.valueNodeHasChildren?a.createPortal(d.children,c.valueNode):null]})});ep.displayName=eu;var em="SelectItemIndicator",ef=r.forwardRef((e,r)=>{let{__scopeSelect:a,...s}=e;return ed(em,a).isSelected?(0,t.jsx)(x.Primitive.span,{"aria-hidden":!0,...s,ref:r}):null});ef.displayName=em;var eh="SelectScrollUpButton",ex=r.forwardRef((e,a)=>{let s=W(eh,e.__scopeSelect),l=ee(eh,e.__scopeSelect),[n,i]=r.useState(!1),d=(0,o.useComposedRefs)(a,l.onScrollButtonChange);return(0,b.useLayoutEffect)(()=>{if(s.viewport&&s.isPositioned){let e=function(){i(t.scrollTop>0)},t=s.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[s.viewport,s.isPositioned]),n?(0,t.jsx)(ey,{...e,ref:d,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=s;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});ex.displayName=eh;var eg="SelectScrollDownButton",ev=r.forwardRef((e,a)=>{let s=W(eg,e.__scopeSelect),l=ee(eg,e.__scopeSelect),[n,i]=r.useState(!1),d=(0,o.useComposedRefs)(a,l.onScrollButtonChange);return(0,b.useLayoutEffect)(()=>{if(s.viewport&&s.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;i(Math.ceil(t.scrollTop)<e)},t=s.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[s.viewport,s.isPositioned]),n?(0,t.jsx)(ey,{...e,ref:d,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=s;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});ev.displayName=eg;var ey=r.forwardRef((e,a)=>{let{__scopeSelect:s,onAutoScroll:n,...o}=e,i=W("SelectScrollButton",s),d=r.useRef(null),c=T(s),u=r.useCallback(()=>{null!==d.current&&(window.clearInterval(d.current),d.current=null)},[]);return r.useEffect(()=>()=>u(),[u]),(0,b.useLayoutEffect)(()=>{let e=c().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[c]),(0,t.jsx)(x.Primitive.div,{"aria-hidden":!0,...o,ref:a,style:{flexShrink:0,...o.style},onPointerDown:(0,l.composeEventHandlers)(o.onPointerDown,()=>{null===d.current&&(d.current=window.setInterval(n,50))}),onPointerMove:(0,l.composeEventHandlers)(o.onPointerMove,()=>{i.onItemLeave?.(),null===d.current&&(d.current=window.setInterval(n,50))}),onPointerLeave:(0,l.composeEventHandlers)(o.onPointerLeave,()=>{u()})})});r.forwardRef((e,r)=>{let{__scopeSelect:a,...s}=e;return(0,t.jsx)(x.Primitive.div,{"aria-hidden":!0,...s,ref:r})}).displayName="SelectSeparator";var eb="SelectArrow";r.forwardRef((e,r)=>{let{__scopeSelect:a,...s}=e,l=P(a),n=D(eb,a),o=W(eb,a);return n.open&&"popper"===o.position?(0,t.jsx)(f.Arrow,{...l,...s,ref:r}):null}).displayName=eb;var ew=r.forwardRef(({__scopeSelect:e,value:a,...s},l)=>{let n=r.useRef(null),i=(0,o.useComposedRefs)(l,n),d=(0,w.usePrevious)(a);return r.useEffect(()=>{let e=n.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(d!==a&&t){let r=new Event("change",{bubbles:!0});t.call(e,a),e.dispatchEvent(r)}},[d,a]),(0,t.jsx)(x.Primitive.select,{...s,style:{...j.VISUALLY_HIDDEN_STYLES,...s.style},ref:i,defaultValue:a})});function ej(e){return""===e||void 0===e}function ek(e){let t=(0,v.useCallbackRef)(e),a=r.useRef(""),s=r.useRef(0),l=r.useCallback(e=>{let r=a.current+e;t(r),function e(t){a.current=t,window.clearTimeout(s.current),""!==t&&(s.current=window.setTimeout(()=>e(""),1e3))}(r)},[t]),n=r.useCallback(()=>{a.current="",window.clearTimeout(s.current)},[]);return r.useEffect(()=>()=>window.clearTimeout(s.current),[]),[a,l,n]}function eC(e,t,r){var a,s;let l=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,n=r?e.indexOf(r):-1,o=(a=e,s=Math.max(n,0),a.map((e,t)=>a[(s+t)%a.length]));1===l.length&&(o=o.filter(e=>e!==r));let i=o.find(e=>e.textValue.toLowerCase().startsWith(l.toLowerCase()));return i!==r?i:void 0}ew.displayName="SelectBubbleInput";var eN=e.i(55660),eS=e.i(92610),eS=eS;let eq=(0,e.i(57475).default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var eR=e.i(52088);function eT({...e}){return(0,t.jsx)(H,{"data-slot":"select",...e})}function eL({...e}){return(0,t.jsx)(F,{"data-slot":"select-value",...e})}function eM({className:e,size:r="default",children:a,...s}){return(0,t.jsxs)(z,{"data-slot":"select-trigger","data-size":r,className:(0,eR.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[a,(0,t.jsx)($,{asChild:!0,children:(0,t.jsx)(eS.default,{className:"size-4 opacity-50"})})]})}function eI({className:e,children:r,position:a="popper",align:s="center",...l}){return(0,t.jsx)(U,{children:(0,t.jsxs)(V,{"data-slot":"select-content",className:(0,eR.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,align:s,...l,children:[(0,t.jsx)(eE,{}),(0,t.jsx)(er,{className:(0,eR.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),(0,t.jsx)(eD,{})]})})}function eP({className:e,children:r,...a}){return(0,t.jsxs)(ec,{"data-slot":"select-item",className:(0,eR.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...a,children:[(0,t.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,t.jsx)(ef,{children:(0,t.jsx)(eN.CheckIcon,{className:"size-4"})})}),(0,t.jsx)(ep,{children:r})]})}function eE({className:e,...r}){return(0,t.jsx)(ex,{"data-slot":"select-scroll-up-button",className:(0,eR.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:(0,t.jsx)(eq,{className:"size-4"})})}function eD({className:e,...r}){return(0,t.jsx)(ev,{"data-slot":"select-scroll-down-button",className:(0,eR.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:(0,t.jsx)(eS.default,{className:"size-4"})})}e.s(["Select",()=>eT,"SelectContent",()=>eI,"SelectItem",()=>eP,"SelectTrigger",()=>eM,"SelectValue",()=>eL],80707)},38544,e=>{"use strict";let t=(0,e.i(57475).default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);e.s(["Lightbulb",()=>t],38544)},54180,e=>{"use strict";var t=e.i(95),r=e.i(86375),a=e.i(97624),s=e.i(95403),l=e.i(3957),n=e.i(9714);e.i(75746);var o=e.i(28736);e.i(57979);var i=e.i(32798),d=e.i(73554),c=e.i(32555),u=e.i(80707),p=e.i(36804),m=e.i(99282);function f({traders:e,quests:a,filters:s,onFilterChange:l,onApplyFilters:n}){let o=(0,p.useUpdateUserPrefs)(),f=(0,r.useRef)(n);(0,r.useEffect)(()=>{f.current=n}),(0,r.useEffect)(()=>{let e=setTimeout(()=>{void 0!==s.playerLevel&&null!==s.playerLevel&&o.mutate({playerLevel:s.playerLevel})},1e3);return()=>clearTimeout(e)},[s.playerLevel]);let h=(0,r.useCallback)(e=>{l(e),setTimeout(()=>f.current(),0)},[l]),x=(0,r.useRef)(null),g=(0,r.useCallback)(e=>{l({playerLevel:e}),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{f.current()},500)},[l]);return(0,t.jsx)("div",{className:"bg-background border-b",children:(0,t.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsxs)(u.Select,{value:s.traderId||"all",onValueChange:e=>h({traderId:"all"===e?null:e}),children:[(0,t.jsx)(u.SelectTrigger,{className:"h-9 w-[140px]",children:(0,t.jsx)(u.SelectValue,{placeholder:"All Traders"})}),(0,t.jsxs)(u.SelectContent,{children:[(0,t.jsx)(u.SelectItem,{value:"all",children:"All Traders"}),e.map(e=>(0,t.jsx)(u.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:(0,m.getTraderColor)(e.id).primary}}),e.name]})},e.id))]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"player-level",className:"text-sm whitespace-nowrap",children:"Level:"}),(0,t.jsx)("input",{id:"player-level",type:"number",min:1,max:79,placeholder:"1-79",value:s.playerLevel??"",onChange:e=>{let t=parseInt(e.target.value);g(isNaN(t)?null:Math.min(79,Math.max(1,t)))},className:"h-9 w-16 rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(c.Switch,{id:"kappa-only",checked:s.kappaOnly,onCheckedChange:e=>h({kappaOnly:e})}),(0,t.jsx)(d.Label,{htmlFor:"kappa-only",className:"text-sm cursor-pointer whitespace-nowrap",children:"Kappa Only"})]})]}),(0,t.jsx)("div",{className:"hidden sm:block",children:(0,t.jsx)(i.ProgressStats,{quests:a,traders:e})})]})})}var h=e.i(1122),x=e.i(37834),g=e.i(29917),v=e.i(9473),y=e.i(52088),b=e.i(65986);let w={color:"#636363"};function j({quest:e,playerLevel:a,onStatusChange:s,onQuestDetails:l}){let n=(0,m.getTraderColor)(e.traderId),o=m.STATUS_COLORS[e.computedStatus],[i,d]=(0,r.useState)(!1),c=null!=a&&e.levelRequired<=a,u=null!=a&&e.levelRequired>a&&e.levelRequired<=a+5,p=(0,r.useMemo)(()=>{if(!e.dependsOn)return[];let t=new Map;for(let r of e.dependsOn)if(r.requiredQuest.traderId.toLowerCase()!==e.traderId.toLowerCase()){let e=r.requiredQuest.traderId.toLowerCase(),a=t.get(e);a?a.count++:t.set(e,{name:r.requiredQuest.trader.name,count:1})}return Array.from(t.entries()).map(([e,t])=>({traderId:e,...t}))},[e.dependsOn,e.traderId]);return(0,t.jsxs)("div",{onClick:()=>{d(!0),setTimeout(()=>d(!1),150),s(e.id,e.computedStatus)},onContextMenu:t=>{t.preventDefault(),l&&l(e.id)},className:(0,y.cn)("relative p-2 rounded-lg border transition-all duration-150 cursor-pointer min-h-[44px]","hover:shadow-md",i&&"scale-95","locked"===e.computedStatus&&"opacity-70","completed"===e.computedStatus&&"opacity-70","available"===e.computedStatus&&"shadow-sm hover:shadow-lg",u&&"completed"!==e.computedStatus&&"ring-1 ring-amber-300"),style:{backgroundColor:o.bg,borderColor:"available"===e.computedStatus?n.primary:o.border,borderLeftWidth:4,borderLeftColor:n.primary},children:[e.kappaRequired&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full flex items-center justify-center text-[8px] font-bold text-white",style:{backgroundColor:"#FFD700"},title:"Required for Kappa",children:"K"}),p.length>0&&(0,t.jsxs)("div",{className:"flex gap-0.5 mb-1",children:[p.slice(0,2).map(e=>{let r=(0,m.getTraderColor)(e.traderId);return(0,t.jsx)("div",{className:"px-1 rounded text-[8px] font-medium text-white",style:{backgroundColor:r.primary},title:`Requires quest(s) from ${e.name}`,children:e.name.slice(0,2)},e.traderId)}),p.length>2&&(0,t.jsxs)("div",{className:"px-1 rounded text-[8px] font-medium text-white",style:{backgroundColor:"#636363"},children:["+",p.length-2]})]}),(0,t.jsx)("div",{className:"font-semibold text-[14px] leading-tight line-clamp-2",style:{color:"#c7c5b3"},title:e.title,children:e.title}),e.objectivesSummary&&e.objectivesSummary.total>0&&"locked"!==e.computedStatus&&(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("div",{className:"h-1 w-full bg-black/30 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-emerald-500 transition-all duration-300",style:{width:`${e.objectivesSummary.completed/e.objectivesSummary.total*100}%`}})})}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-[12px] font-semibold",style:{color:n.primary},children:e.trader.name}),(0,t.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-wide",style:{color:"var(--text-tertiary)"},children:"Lv"}),(0,t.jsx)("span",{className:"text-[12px] font-semibold",style:{color:c?"var(--success)":u?"#ca8a00":"var(--text-secondary)"},children:e.levelRequired})]}),e.objectivesSummary&&e.objectivesSummary.total>0&&"locked"!==e.computedStatus&&(0,t.jsxs)("span",{className:"text-[10px]",style:{color:"var(--text-tertiary)"},children:["(",e.objectivesSummary.completed,"/",e.objectivesSummary.total,")"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[l&&(0,t.jsxs)(b.Tooltip,{delayDuration:300,children:[(0,t.jsx)(b.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),l&&l(e.id)},onMouseDown:e=>{e.stopPropagation()},onTouchStart:e=>e.stopPropagation(),onTouchEnd:t=>{t.stopPropagation(),t.preventDefault(),l&&l(e.id)},className:"w-6 h-6 flex items-center justify-center opacity-60 hover:opacity-100 transition-colors duration-150 rounded-full hover:bg-black/20 focus:outline-none focus:ring-1 focus:ring-offset-1 pointer-events-auto",style:w,"aria-label":`View ${e.title} details`,children:(0,t.jsx)(g.Info,{className:"w-[14px] h-[14px]"})})}),(0,t.jsx)(b.TooltipContent,{side:"top",sideOffset:4,children:(0,t.jsx)("p",{className:"text-xs",children:"View Details"})})]}),e.wikiLink&&(0,t.jsxs)(b.Tooltip,{delayDuration:300,children:[(0,t.jsx)(b.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),e.wikiLink&&window.open(e.wikiLink,"_blank","noopener,noreferrer")},onMouseDown:e=>{e.stopPropagation()},onTouchStart:e=>e.stopPropagation(),onTouchEnd:t=>{t.stopPropagation(),t.preventDefault(),e.wikiLink&&window.open(e.wikiLink,"_blank","noopener,noreferrer")},className:"w-6 h-6 flex items-center justify-center opacity-60 hover:opacity-100 transition-colors duration-150 rounded-full hover:bg-black/20 focus:outline-none focus:ring-1 focus:ring-offset-1 pointer-events-auto",style:w,"aria-label":`Open ${e.title} wiki page`,children:(0,t.jsx)(v.ExternalLink,{className:"w-[14px] h-[14px]"})})}),(0,t.jsx)(b.TooltipContent,{side:"top",sideOffset:4,children:(0,t.jsx)("p",{className:"text-xs",children:"View on Tarkov Wiki"})})]})]})]}),"completed"===e.computedStatus&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsx)("svg",{className:"w-6 h-6 opacity-30",style:{color:"#00a700"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})}var k=e.i(38544),C=e.i(71437),N=e.i(91058),S=e.i(57475);let q=(0,S.default)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),R=(0,S.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function T({quests:e,playerLevel:a,onQuestClick:s}){let l=(0,r.useMemo)(()=>{let t=[],r=e.filter(e=>"available"===e.computedStatus);if(a)for(let e of r.filter(e=>e.levelRequired<=a&&e.levelRequired>=a-5).slice(0,3))t.push({quest:e,reason:`Perfect for level ${a}`,priority:100-Math.abs(a-e.levelRequired),icon:"level"});for(let e of r.filter(e=>e.kappaRequired).slice(0,2))t.find(t=>t.quest.id===e.id)||t.push({quest:e,reason:"Required for Kappa",priority:90,icon:"kappa"});let s=new Map;for(let t of e)for(let e of t.dependsOn||[]){let t=s.get(e.requiredQuest.id)||0;s.set(e.requiredQuest.id,t+1)}for(let e of r.filter(e=>(s.get(e.id)||0)>=2).sort((e,t)=>(s.get(t.id)||0)-(s.get(e.id)||0)).slice(0,2))if(!t.find(t=>t.quest.id===e.id)){let r=s.get(e.id)||0;t.push({quest:e,reason:`Unlocks ${r} quest${r>1?"s":""}`,priority:80+r,icon:"chain"})}let l=function(e,t){let r=new Map;for(let a of t){let t=function(e,t){let r=new Set([e.id]),a=e=>{for(let s of e.dependsOn||[])if(!r.has(s.requiredQuest.id)){r.add(s.requiredQuest.id);let e=t.find(e=>e.id===s.requiredQuest.id);e&&a(e)}};return a(e),t.filter(e=>r.has(e.id))}(a,e),s=t.filter(e=>"completed"===e.computedStatus).length,l=t.length,n=l>0?s/l:0;r.set(a.id,{completed:s,total:l,completionRate:n})}return r}(e,r);for(let e of r.filter(e=>{let t=l.get(e.id);return t&&t.completionRate>=.6}).slice(0,2))if(!t.find(t=>t.quest.id===e.id)){let r=l.get(e.id);t.push({quest:e,reason:`${r.completed}/${r.total} in chain - finish it!`,priority:85+10*r.completionRate,icon:"momentum"})}let n=function(e){let t=new Map;for(let r of e)for(let e of r.objectives||[])e.map&&t.set(e.map,(t.get(e.map)||0)+1);return t}(r);for(let e of r.filter(e=>(e.objectives||[]).map(e=>e.map).filter(e=>!!e).some(e=>(n.get(e)||0)>=3)).sort((e,t)=>{let r=(e.objectives||[]).map(e=>e.map).filter(e=>!!e),a=(t.objectives||[]).map(e=>e.map).filter(e=>!!e),s=r.length>0?Math.max(...r.map(e=>n.get(e)||0)):0;return(a.length>0?Math.max(...a.map(e=>n.get(e)||0)):0)-s}).slice(0,2))if(!t.find(t=>t.quest.id===e.id)){let r=(e.objectives||[]).map(e=>e.map).filter(e=>!!e),a=r.length>0?Math.max(...r.map(e=>n.get(e)||0)):0,s=r.find(e=>n.get(e)===a);t.push({quest:e,reason:`${a} quests on ${s} - efficient!`,priority:75+Math.min(a,10),icon:"map"})}let o=function(e){let t=new Map;for(let r of e){let e=t.get(r.traderId)||{completed:0,total:0};e.total++,"completed"===r.computedStatus&&e.completed++,t.set(r.traderId,e)}let r=new Map;for(let[e,a]of t.entries())r.set(e,a.completed/a.total);return r}(e);for(let e of r.filter(e=>(o.get(e.traderId)||0)>=.7).sort((e,t)=>(o.get(t.traderId)||0)-(o.get(e.traderId)||0)).slice(0,1))if(!t.find(t=>t.quest.id===e.id)){let r=o.get(e.traderId);t.push({quest:e,reason:`${Math.round(100*r)}% ${e.trader.name} done`,priority:70+5*r,icon:"trader"})}if(a){for(let e of r.filter(e=>{let t=e.experience/1e3;return a<=20?t<5:a>=41?t>20:t>=5&&t<=30}).sort((e,t)=>{let r=e.experience/1e3,s=t.experience/1e3;return a&&a<=20?r-s:a&&a>=41?s-r:0}).slice(0,1))if(!t.find(t=>t.quest.id===e.id)){var i;let r=(i=e.experience/1e3)<3?"Quick win":i<10?"Easy":i<20?"Medium":i<30?"Hard":"Challenge";t.push({quest:e,reason:`${r} - ${e.experience.toLocaleString()} XP`,priority:function(e,t,r){if(!t)return 60;let a=r/1e3;return t<=20&&a<5||t>=41&&a>20?70:60}(60,a,e.experience),icon:"difficulty"})}}let d=new Map;for(let e of r)for(let t of e.objectives||[])t.map&&d.set(t.map,(d.get(t.map)||0)+1);let c=Array.from(d.entries()).sort((e,t)=>t[1]-e[1])[0];if(c)for(let e of r.filter(e=>(e.objectives||[]).some(e=>e.map===c[0])).slice(0,2))t.find(t=>t.quest.id===e.id)||t.push({quest:e,reason:`${c[0]} efficiency`,priority:70,icon:"map"});return(function(e){let t=new Map,r=[];for(let a of e){let e=a.quest.questType,s=t.get(e)||0;s<2&&(r.push(a),t.set(e,s+1))}return r})(t).sort((e,t)=>t.priority-e.priority).slice(0,5)},[e,a]);return 0===l.length?null:(0,t.jsxs)("div",{className:"bg-card border rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(k.Lightbulb,{className:"w-4 h-4 text-[#d4a574]"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Next Up"}),(0,t.jsx)(L,{})]}),(0,t.jsx)("div",{className:"space-y-2",children:l.map(({quest:e,reason:r,icon:a})=>{let l=(0,m.getTraderColor)(e.traderId),n=new Map;for(let t of e.objectives||[])t.map&&n.set(t.map,(n.get(t.map)||0)+1);let o=Array.from(n.entries()).sort((e,t)=>t[1]-e[1])[0]?.[0];return(0,t.jsx)("button",{type:"button",onClick:()=>s?.(e.id),className:"w-full text-left p-2 rounded hover:bg-muted transition-colors group",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0",style:{backgroundColor:l.primary}}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium leading-tight group-hover:text-primary transition-colors",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[11px] mt-0.5",children:[(0,t.jsx)("span",{className:"font-medium",style:{color:l.primary},children:e.trader.name}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"â€¢"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:o})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-0.5",children:[(e=>{switch(e){case"level":return(0,t.jsx)(R,{className:"w-3 h-3 text-emerald-400"});case"kappa":return(0,t.jsx)(N.Star,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"});case"chain":return(0,t.jsx)(C.ChevronRight,{className:"w-3 h-3 text-blue-400"});case"map":return(0,t.jsx)(q,{className:"w-3 h-3 text-purple-400"});case"momentum":return(0,t.jsx)(R,{className:"w-3 h-3 text-orange-400"});case"trader":return(0,t.jsx)(N.Star,{className:"w-3 h-3 text-cyan-400"});case"difficulty":return(0,t.jsx)(k.Lightbulb,{className:"w-3 h-3 text-yellow-500"})}})(a),(0,t.jsx)("span",{children:r})]})]})]})},e.id)})})]})}function L(){return(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)("button",{type:"button",title:"How Next Up Works",className:"text-muted-foreground hover:text-foreground transition-colors",children:(0,t.jsxs)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"2"}),(0,t.jsx)("path",{d:"M12 16v-4M12 8h.01",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,t.jsxs)("div",{className:"absolute left-0 top-full mt-2 w-64 bg-popover border rounded-lg p-3 text-xs opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 shadow-lg",children:[(0,t.jsx)("p",{className:"font-medium mb-2",children:"How Next Up Works"}),(0,t.jsxs)("ul",{className:"space-y-1 text-muted-foreground",children:[(0,t.jsx)("li",{children:"â€¢ Your level and available quests"}),(0,t.jsx)("li",{children:"â€¢ Kappa requirements"}),(0,t.jsx)("li",{children:"â€¢ Quest chains and dependencies"}),(0,t.jsx)("li",{children:"â€¢ Map efficiency and synergy"}),(0,t.jsx)("li",{children:"â€¢ Your trader progress"}),(0,t.jsx)("li",{children:"â€¢ Quest difficulty based on XP rewards"})]})]})]})}let M=["Factory","Customs","Woods","Shoreline","Interchange","Reserve","Labs","Lighthouse","Streets of Tarkov","Ground Zero"],I="Any Location";function P(e){return e.progress?.[0]?.completed??!1}function E({quests:e,allQuests:a,playerLevel:s,onStatusChange:l,onQuestDetails:n}){let o=(0,r.useMemo)(()=>{let t=new Map;for(let e of M)t.set(e,[]);for(let r of(t.set(I,[]),e)){let e=function(e){let t=new Set,r=!1;for(let a of e.objectives)if(!P(a)&&a.maps&&a.maps.length>0)for(let e of(r=!0,a.maps))t.add(e);return!r&&(e.objectives.some(e=>!P(e))||"completed"!==e.computedStatus)?e.location?[e.location]:[]:Array.from(t)}(r);if(0===e.length)t.get(I).push(r);else for(let a of e)t.has(a)&&t.get(a).push(r)}for(let[,e]of t)e.sort((e,t)=>e.levelRequired!==t.levelRequired?e.levelRequired-t.levelRequired:e.trader.name.localeCompare(t.trader.name));return t},[e]),i=(0,r.useMemo)(()=>{let e=new Map;for(let t of[...M,I]){let r=o.get(t)||[];e.set(t,{total:r.length,completed:r.filter(e=>"completed"===e.computedStatus).length,available:r.filter(e=>"available"===e.computedStatus).length})}return e},[o]),d=(0,r.useMemo)(()=>[...M,I].sort((e,t)=>{let r=i.get(e)?.total||0,a=i.get(t)?.total||0;return a!==r?a-r:e.localeCompare(t)}),[i]),c=a??[];return(0,t.jsx)("div",{className:"h-full overflow-auto",children:(0,t.jsxs)("div",{className:"flex gap-2 p-4 min-w-max",children:[c&&c.length>0&&(0,t.jsx)("div",{className:"flex-shrink-0 w-48 sticky left-4 z-20",children:(0,t.jsx)(T,{quests:c,playerLevel:s,onQuestClick:e=>{n?.(e)}})}),d.map(e=>{let r=o.get(e)||[],a=i.get(e);return 0===r.length&&e!==I?null:(0,t.jsxs)("div",{className:"flex-shrink-0 w-36 sm:w-48",children:[(0,t.jsxs)("div",{className:"sticky top-0 z-10 p-2 rounded-t-lg border-b-2",style:{backgroundColor:"#383945",borderColor:a.available>0?"#0292c0":"#636363"},children:[(0,t.jsx)("div",{className:"font-semibold text-sm",style:{color:"#c7c5b3"},children:e}),(0,t.jsxs)("div",{className:"text-xs",style:{color:"#636363"},children:[a.completed,"/",a.total," completed",a.available>0&&(0,t.jsxs)("span",{style:{color:"#0292c0"},className:"ml-1",children:["(",a.available," available)"]})]})]}),(0,t.jsx)("div",{className:"space-y-2 p-2 min-h-[200px] rounded-b-lg",style:{backgroundColor:"rgba(56, 57, 69, 0.5)"},children:0===r.length?(0,t.jsx)("div",{className:"text-xs text-center py-4",style:{color:"#636363"},children:"No quests"}):r.map(e=>(0,t.jsx)(j,{quest:e,playerLevel:s,onStatusChange:l,onQuestDetails:n},e.id))})]},e)})]})})}e.i(25693);var D=e.i(50168);e.i(46466);var O=e.i(13097);e.i(57213);var A=e.i(77033),H=e.i(71529),B=e.i(6803),z=e.i(18183);let _={locked:null,available:"completed",in_progress:"completed",completed:"available"};function F(){let{status:e}=(0,a.useSession)(),{setStats:i}=(0,l.useStats)(),{prefs:d,isLoading:c}=(0,n.useUserPrefsContext)(),u="loading"===e||"authenticated"===e&&c,p=(0,r.useMemo)(()=>({statuses:["available"],playerLevel:d?.playerLevel??1}),[d]),{quests:m,allQuests:g,traders:v,loading:y,initialLoading:b,error:w,filters:j,setFilters:k,applyFilters:C,refetch:N}=(0,H.useQuests)({initialFilters:p}),S=(0,r.useRef)(!1);(0,r.useEffect)(()=>{d&&!S.current&&(S.current=!0,k({playerLevel:d.playerLevel??1}),C())},[d,k,C]);let{progress:q,updateStatus:R,unlockedQuests:T,clearUnlocked:L,error:M,savingQuestIds:I,lastSynced:P,isOnline:F,pendingOfflineCount:$}=(0,B.useProgress)(),[U,Q]=(0,r.useState)(!1),[V,K]=(0,r.useState)(null),[W,Y]=(0,r.useState)(!1),[X,G]=(0,r.useState)(!1),[J,Z]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(null),[er,ea]=(0,r.useState)(!1),es=(0,r.useMemo)(()=>!!ee&&I.has(ee.id),[ee,I]),el=(0,r.useRef)([]),en=(0,r.useRef)(e),eo=(0,r.useRef)(R),ei=(0,r.useRef)(N),ed=(0,r.useMemo)(()=>m.map(e=>{if("locked"===e.computedStatus)return{...e,computedStatus:"locked"};let t=q.get(e.id);return{...e,computedStatus:t||e.computedStatus}}),[m,q]),ec=(0,r.useMemo)(()=>g.map(e=>{if("locked"===e.computedStatus)return{...e,computedStatus:"locked"};let t=q.get(e.id);return{...e,computedStatus:t||e.computedStatus}}),[g,q]);(0,r.useEffect)(()=>{el.current=ed},[ed]),(0,r.useEffect)(()=>{en.current=e},[e]),(0,r.useEffect)(()=>{eo.current=R},[R]),(0,r.useEffect)(()=>{ei.current=N},[N]),(0,r.useEffect)(()=>{if(T.length>0){let e=T.length;s.toast.success(`${e} quest${e>1?"s":""} unlocked!`,{description:"New quests are now available."}),L(),N()}},[T,L,N]),(0,r.useEffect)(()=>{M&&s.toast.error("Progress Error",{description:M})},[M]),(0,r.useEffect)(()=>{y||localStorage.getItem("eft-tracker-onboarding")||G(!0)},[y]);let eu=(0,r.useCallback)(()=>{localStorage.setItem("eft-tracker-onboarding","completed"),G(!1)},[]),ep=(0,r.useCallback)(()=>{localStorage.setItem("eft-tracker-onboarding","completed"),G(!1),Z(!0)},[]),em=(0,r.useCallback)(()=>{N()},[N]),ef=(0,r.useCallback)(e=>{let t=el.current.find(t=>t.id===e);t&&(et(t),ea(!0))},[]),eh=(0,r.useMemo)(()=>V?(0,z.getIncompletePrerequisites)(V.id,ec):[],[V,ec]),ex=(0,r.useCallback)(async()=>{if(V&&0!==eh.length){Y(!0);try{for(let e of eh)if(!await R(e.id,"completed")){s.toast.error("Failed to Update",{description:`Could not complete ${e.title}. Please try again.`}),Y(!1);return}s.toast.success(`${eh.length} quest${eh.length>1?"s":""} completed!`,{description:`${V.title} is now available.`}),Q(!1),K(null),await N()}catch{s.toast.error("Failed to Update",{description:"Could not complete prerequisite quests. Please try again."})}finally{Y(!1)}}},[V,eh,R,N]),eg=(0,r.useCallback)(async e=>{let t=el.current.find(t=>t.id===e);if(!t)return;let r=t.computedStatus;if("locked"===r)return"authenticated"!==en.current?void s.toast.warning("Sign In Required",{description:"Please sign in to track your progress.",action:{label:"Sign In",onClick:()=>window.location.href="/login"}}):(K(t),void Q(!0));if("authenticated"!==en.current)return void s.toast.warning("Sign In Required",{description:"Please sign in to track your progress.",action:{label:"Sign In",onClick:()=>window.location.href="/login"}});let a=_[r];a&&(await eo.current(e,a)?("completed"===a&&s.toast.success("Quest Completed!",{description:t.title}),await ei.current()):s.toast.error("Failed to Update",{description:"Could not update quest status. Please try again."}))},[]),ev=(0,r.useCallback)(async e=>{await eg(e)},[eg]),ey=(0,r.useCallback)(async(e,t)=>{if("authenticated"!==en.current)return s.toast.error("Sign in Required",{description:"Please sign in to track quest progress."}),{questStatusChanged:!1};try{let r="boolean"==typeof t?{completed:t}:{current:t.current},a=await fetch(`/api/progress/objective/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.error||"Failed to update objective")}let l=await a.json();return await ei.current(),l.quest?.statusChanged&&("COMPLETED"===l.quest.status?s.toast.success("Quest Completed!",{description:`All objectives for ${l.quest.title} are complete.`}):"IN_PROGRESS"===l.quest.status&&s.toast.info("Quest Started",{description:l.quest.title})),{questStatusChanged:l.quest?.statusChanged??!1,newQuestStatus:l.quest?.status}}catch(e){return s.toast.error("Failed to Update Objective",{description:e instanceof Error?e.message:"Please try again."}),{questStatusChanged:!1}}},[]),eb=(0,r.useMemo)(()=>({total:ed.length,completed:ed.filter(e=>"completed"===e.computedStatus).length,available:ed.filter(e=>"available"===e.computedStatus).length,locked:ed.filter(e=>"locked"===e.computedStatus).length}),[ed]);return((0,r.useEffect)(()=>(y||w||i(eb),()=>i(null)),[eb,i,y,w]),b||u)?(0,t.jsx)(h.QuestTreeSkeleton,{}):w?(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-lg font-medium text-destructive",children:"Error loading quests"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:w}),(0,t.jsx)("button",{onClick:()=>N(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Try Again"})]})}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(D.WelcomeModal,{open:X,onOpenChange:G,onGetStarted:eu,onCatchUp:ep}),(0,t.jsx)(A.CatchUpDialog,{open:J,onOpenChange:Z,quests:ec,onComplete:em}),(0,t.jsx)(x.SkipQuestDialog,{open:U,onOpenChange:Q,targetQuest:V,prerequisites:eh,onConfirm:ex,isLoading:W}),(0,t.jsx)(O.QuestDetailModal,{quest:ee,open:er,onOpenChange:ea,onStatusChange:ev,onObjectiveToggle:ey,isSaving:es}),(0,t.jsx)(f,{traders:v,quests:ec,filters:j,onFilterChange:k,onApplyFilters:C}),(0,t.jsx)("div",{className:"flex-1 min-h-0",children:ed.length>0?(0,t.jsx)(E,{quests:ed,allQuests:ec,playerLevel:j.playerLevel,onStatusChange:eg,onQuestDetails:ef}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No quests found matching your filters."})})}),"authenticated"===e&&(0,t.jsx)("div",{className:"shrink-0 px-4 py-2 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,t.jsx)(o.SyncStatusIndicator,{lastSynced:P,isOnline:F,isSaving:I.size>0,pendingOfflineCount:$})})]})}e.s(["MapsClient",()=>F],54180)}]);
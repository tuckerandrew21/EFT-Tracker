{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/lib/trader-colors.ts"],"sourcesContent":["export interface TraderColor {\n  primary: string;\n  bg: string;\n}\n\n// EFT Brand Colors - Tarkov Wiki inspired for maximum readability\nexport const EFT_COLORS = {\n  goldOne: \"#e8e6d4\", // Bright cream/gold for maximum text readability\n  goldTwo: \"#c4aa6a\", // Brighter gold for accents\n  gunmetal: \"#272727\", // Darker, more neutral background\n  gunmetalDark: \"#1a1a1a\", // Near-black\n  blackLight: \"#0f0f0f\", // True dark\n  border: \"rgba(196, 170, 106, 0.4)\", // Gold-tinted borders for visibility\n} as const;\n\n// Distinct colors per trader for easy visual identification\nexport const TRADER_COLORS: Record<string, TraderColor> = {\n  prapor: { primary: \"#c41e3a\", bg: EFT_COLORS.gunmetal }, // Red\n  therapist: { primary: \"#ff69b4\", bg: EFT_COLORS.gunmetal }, // Pink\n  skier: { primary: \"#1e90ff\", bg: EFT_COLORS.gunmetal }, // Blue\n  peacekeeper: { primary: \"#228b22\", bg: EFT_COLORS.gunmetal }, // Green\n  mechanic: { primary: \"#ff8c00\", bg: EFT_COLORS.gunmetal }, // Orange\n  ragman: { primary: \"#9370db\", bg: EFT_COLORS.gunmetal }, // Purple\n  jaeger: { primary: \"#8b4513\", bg: EFT_COLORS.gunmetal }, // Brown\n  fence: { primary: \"#708090\", bg: EFT_COLORS.gunmetal }, // Slate gray\n  lightkeeper: { primary: \"#ffd700\", bg: EFT_COLORS.gunmetal }, // Gold\n  ref: { primary: \"#20b2aa\", bg: EFT_COLORS.gunmetal }, // Teal\n};\n\nexport function getTraderColor(traderId: string): TraderColor {\n  return (\n    TRADER_COLORS[traderId.toLowerCase()] || {\n      primary: EFT_COLORS.goldTwo,\n      bg: EFT_COLORS.gunmetal,\n    }\n  );\n}\n\n// Status colors - dark backgrounds with bright accent borders for readability\nexport const STATUS_COLORS = {\n  locked: {\n    primary: \"#5a5a5a\", // Dimmer gray\n    bg: \"#1a1a1a\", // Near-black\n    border: \"#3a3a3a\", // Subtle border\n  },\n  available: {\n    primary: \"#4db8ff\", // Bright sky blue\n    bg: \"#1a1a1a\", // Same dark background for consistency\n    border: \"#4db8ff\", // Bright blue border\n  },\n  in_progress: {\n    primary: \"#fbbf24\", // Amber for in-progress\n    bg: \"#1a1a1a\", // Same dark background\n    border: \"#fbbf24\", // Amber border\n  },\n  completed: {\n    primary: \"#4ade80\", // Bright green\n    bg: \"#1e2e1e\", // Tinted green background for clear distinction\n    border: \"#4ade80\", // Bright green border to stand out\n  },\n} as const;\n\nexport type StatusColorKey = keyof typeof STATUS_COLORS;\n"],"names":[],"mappings":";;;;;;;;;;AAMO,MAAM,aAAa;IACxB,SAAS;IACT,SAAS;IACT,UAAU;IACV,cAAc;IACd,YAAY;IACZ,QAAQ;AACV;AAGO,MAAM,gBAA6C;IACxD,QAAQ;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACtD,WAAW;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACzD,OAAO;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACrD,aAAa;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IAC3D,UAAU;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACxD,QAAQ;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACtD,QAAQ;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACtD,OAAO;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IACrD,aAAa;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;IAC3D,KAAK;QAAE,SAAS;QAAW,IAAI,WAAW,QAAQ;IAAC;AACrD;AAEO,SAAS,eAAe,QAAgB;IAC7C,OACE,aAAa,CAAC,SAAS,WAAW,GAAG,IAAI;QACvC,SAAS,WAAW,OAAO;QAC3B,IAAI,WAAW,QAAQ;IACzB;AAEJ;AAGO,MAAM,gBAAgB;IAC3B,QAAQ;QACN,SAAS;QACT,IAAI;QACJ,QAAQ;IACV;IACA,WAAW;QACT,SAAS;QACT,IAAI;QACJ,QAAQ;IACV;IACA,aAAa;QACX,SAAS;QACT,IAAI;QACJ,QAAQ;IACV;IACA,WAAW;QACT,SAAS;QACT,IAAI;QACJ,QAAQ;IACV;AACF"}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/tooltip.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction TooltipProvider({\n  delayDuration = 0,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\n  return (\n    <TooltipPrimitive.Provider\n      data-slot=\"tooltip-provider\"\n      delayDuration={delayDuration}\n      {...props}\n    />\n  );\n}\n\nfunction Tooltip({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\n  return (\n    <TooltipProvider>\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\n    </TooltipProvider>\n  );\n}\n\nfunction TooltipTrigger({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />;\n}\n\nfunction TooltipContent({\n  className,\n  sideOffset = 0,\n  children,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\n  return (\n    <TooltipPrimitive.Portal>\n      <TooltipPrimitive.Content\n        data-slot=\"tooltip-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        <TooltipPrimitive.Arrow className=\"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]\" />\n      </TooltipPrimitive.Content>\n    </TooltipPrimitive.Portal>\n  );\n}\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,gBAAgB,EACvB,gBAAgB,CAAC,EACjB,GAAG,OACoD;IACvD,qBACE,6VAAC,yRAAyB;QACxB,aAAU;QACV,eAAe;QACd,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,QAAQ,EACf,GAAG,OACgD;IACnD,qBACE,6VAAC;kBACC,cAAA,6VAAC,qRAAqB;YAAC,aAAU;YAAW,GAAG,KAAK;;;;;;;;;;;AAG1D;AAEA,SAAS,eAAe,EACtB,GAAG,OACmD;IACtD,qBAAO,6VAAC,wRAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;AAEA,SAAS,eAAe,EACtB,SAAS,EACT,aAAa,CAAC,EACd,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,6VAAC,uRAAuB;kBACtB,cAAA,6VAAC,wRAAwB;YACvB,aAAU;YACV,YAAY;YACZ,WAAW,IAAA,wIAAE,EACX,qaACA;YAED,GAAG,KAAK;;gBAER;8BACD,6VAAC,sRAAsB;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI1C"}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/hooks/useLongPress.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useRef } from \"react\";\n\ninterface UseLongPressOptions {\n  /** Duration in ms before long press triggers (default: 500ms) */\n  threshold?: number;\n  /** Callback when long press is detected */\n  onLongPress: () => void;\n  /** Optional callback for regular click (fires if released before threshold) */\n  onClick?: () => void;\n}\n\ninterface UseLongPressReturn {\n  onTouchStart: (e: React.TouchEvent) => void;\n  onTouchEnd: (e: React.TouchEvent) => void;\n  onTouchMove: (e: React.TouchEvent) => void;\n  onMouseDown: (e: React.MouseEvent) => void;\n  onMouseUp: (e: React.MouseEvent) => void;\n  onMouseLeave: (e: React.MouseEvent) => void;\n}\n\n/**\n * Hook for detecting long press on touch and mouse devices.\n * Prevents context menu on long press for cleaner mobile UX.\n */\nexport function useLongPress({\n  threshold = 500,\n  onLongPress,\n  onClick,\n}: UseLongPressOptions): UseLongPressReturn {\n  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const isLongPressRef = useRef(false);\n  const startPosRef = useRef<{ x: number; y: number } | null>(null);\n\n  const clear = useCallback(() => {\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = null;\n    }\n  }, []);\n\n  const start = useCallback(\n    (x: number, y: number) => {\n      clear();\n      isLongPressRef.current = false;\n      startPosRef.current = { x, y };\n\n      timerRef.current = setTimeout(() => {\n        isLongPressRef.current = true;\n        onLongPress();\n      }, threshold);\n    },\n    [clear, onLongPress, threshold]\n  );\n\n  const end = useCallback(() => {\n    if (!isLongPressRef.current && onClick) {\n      // Only fire click if it wasn't a long press\n      onClick();\n    }\n    clear();\n    startPosRef.current = null;\n  }, [clear, onClick]);\n\n  // Cancel if user moves finger/mouse too far (prevents accidental triggers while scrolling)\n  const move = useCallback(\n    (x: number, y: number) => {\n      if (!startPosRef.current) return;\n      const dx = Math.abs(x - startPosRef.current.x);\n      const dy = Math.abs(y - startPosRef.current.y);\n      // Cancel if moved more than 10px\n      if (dx > 10 || dy > 10) {\n        clear();\n        startPosRef.current = null;\n      }\n    },\n    [clear]\n  );\n\n  const onTouchStart = useCallback(\n    (e: React.TouchEvent) => {\n      const touch = e.touches[0];\n      start(touch.clientX, touch.clientY);\n    },\n    [start]\n  );\n\n  const onTouchEnd = useCallback(() => {\n    end();\n  }, [end]);\n\n  const onTouchMove = useCallback(\n    (e: React.TouchEvent) => {\n      const touch = e.touches[0];\n      move(touch.clientX, touch.clientY);\n    },\n    [move]\n  );\n\n  const onMouseDown = useCallback(\n    (e: React.MouseEvent) => {\n      // Only for left click\n      if (e.button !== 0) return;\n      start(e.clientX, e.clientY);\n    },\n    [start]\n  );\n\n  const onMouseUp = useCallback(() => {\n    end();\n  }, [end]);\n\n  const onMouseLeave = useCallback(() => {\n    clear();\n    startPosRef.current = null;\n  }, [clear]);\n\n  return {\n    onTouchStart,\n    onTouchEnd,\n    onTouchMove,\n    onMouseDown,\n    onMouseUp,\n    onMouseLeave,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AA0BO,SAAS,aAAa,EAC3B,YAAY,GAAG,EACf,WAAW,EACX,OAAO,EACa;IACpB,MAAM,WAAW,IAAA,8TAAM,EAAuC;IAC9D,MAAM,iBAAiB,IAAA,8TAAM,EAAC;IAC9B,MAAM,cAAc,IAAA,8TAAM,EAAkC;IAE5D,MAAM,QAAQ,IAAA,mUAAW,EAAC;QACxB,IAAI,SAAS,OAAO,EAAE;YACpB,aAAa,SAAS,OAAO;YAC7B,SAAS,OAAO,GAAG;QACrB;IACF,GAAG,EAAE;IAEL,MAAM,QAAQ,IAAA,mUAAW,EACvB,CAAC,GAAW;QACV;QACA,eAAe,OAAO,GAAG;QACzB,YAAY,OAAO,GAAG;YAAE;YAAG;QAAE;QAE7B,SAAS,OAAO,GAAG,WAAW;YAC5B,eAAe,OAAO,GAAG;YACzB;QACF,GAAG;IACL,GACA;QAAC;QAAO;QAAa;KAAU;IAGjC,MAAM,MAAM,IAAA,mUAAW,EAAC;QACtB,IAAI,CAAC,eAAe,OAAO,IAAI,SAAS;YACtC,4CAA4C;YAC5C;QACF;QACA;QACA,YAAY,OAAO,GAAG;IACxB,GAAG;QAAC;QAAO;KAAQ;IAEnB,2FAA2F;IAC3F,MAAM,OAAO,IAAA,mUAAW,EACtB,CAAC,GAAW;QACV,IAAI,CAAC,YAAY,OAAO,EAAE;QAC1B,MAAM,KAAK,KAAK,GAAG,CAAC,IAAI,YAAY,OAAO,CAAC,CAAC;QAC7C,MAAM,KAAK,KAAK,GAAG,CAAC,IAAI,YAAY,OAAO,CAAC,CAAC;QAC7C,iCAAiC;QACjC,IAAI,KAAK,MAAM,KAAK,IAAI;YACtB;YACA,YAAY,OAAO,GAAG;QACxB;IACF,GACA;QAAC;KAAM;IAGT,MAAM,eAAe,IAAA,mUAAW,EAC9B,CAAC;QACC,MAAM,QAAQ,EAAE,OAAO,CAAC,EAAE;QAC1B,MAAM,MAAM,OAAO,EAAE,MAAM,OAAO;IACpC,GACA;QAAC;KAAM;IAGT,MAAM,aAAa,IAAA,mUAAW,EAAC;QAC7B;IACF,GAAG;QAAC;KAAI;IAER,MAAM,cAAc,IAAA,mUAAW,EAC7B,CAAC;QACC,MAAM,QAAQ,EAAE,OAAO,CAAC,EAAE;QAC1B,KAAK,MAAM,OAAO,EAAE,MAAM,OAAO;IACnC,GACA;QAAC;KAAK;IAGR,MAAM,cAAc,IAAA,mUAAW,EAC7B,CAAC;QACC,sBAAsB;QACtB,IAAI,EAAE,MAAM,KAAK,GAAG;QACpB,MAAM,EAAE,OAAO,EAAE,EAAE,OAAO;IAC5B,GACA;QAAC;KAAM;IAGT,MAAM,YAAY,IAAA,mUAAW,EAAC;QAC5B;IACF,GAAG;QAAC;KAAI;IAER,MAAM,eAAe,IAAA,mUAAW,EAAC;QAC/B;QACA,YAAY,OAAO,GAAG;IACxB,GAAG;QAAC;KAAM;IAEV,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 288, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/QuestNode.tsx"],"sourcesContent":["\"use client\";\n\nimport { memo, useMemo } from \"react\";\nimport { Handle, Position, type NodeProps } from \"@xyflow/react\";\nimport { ExternalLink, Info, Loader2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { getTraderColor, STATUS_COLORS, EFT_COLORS } from \"@/lib/trader-colors\";\nimport type { QuestNode as QuestNodeType } from \"@/types\";\nimport {\n  Tooltip,\n  TooltipTrigger,\n  TooltipContent,\n} from \"@/components/ui/tooltip\";\nimport { useLongPress } from \"@/hooks/useLongPress\";\n\n// Responsive node sizes - built around 14px title / 12px level fonts\nexport const QUEST_NODE_WIDTH = 155;\nexport const QUEST_NODE_HEIGHT = 58;\nexport const QUEST_NODE_WIDTH_MOBILE = 130;\nexport const QUEST_NODE_HEIGHT_MOBILE = 58;\n\n// Static styles extracted to module-level constants (prevents object recreation)\nconst HANDLE_STYLE = { backgroundColor: STATUS_COLORS.locked.primary };\nconst KAPPA_BADGE_STYLE = { backgroundColor: \"#FFD700\" };\nconst WIKI_LINK_STYLE = { color: STATUS_COLORS.locked.primary };\nconst TITLE_STYLE = { color: EFT_COLORS.goldOne };\nconst CHECKMARK_STYLE = { color: STATUS_COLORS.completed.primary };\n\nfunction QuestNodeComponent({ data, selected }: NodeProps<QuestNodeType>) {\n  const {\n    quest,\n    // nodeHeight - dynamic height is passed but we use fixed dimensions for now\n    // onClick - available for selection, but status change is handled by parent\n    onDetails,\n    isRoot,\n    isLeaf,\n    isFocused,\n    isInFocusChain,\n    hasFocusMode,\n    playerLevel,\n    isSaving,\n    isKeyboardSelected,\n  } = data;\n  const traderColor = getTraderColor(quest.traderId);\n  const statusColor = STATUS_COLORS[quest.computedStatus];\n\n  // Level-based highlighting\n  const isLevelAppropriate =\n    playerLevel !== null && quest.levelRequired <= playerLevel;\n  const isUpcoming =\n    playerLevel !== null &&\n    quest.levelRequired > playerLevel &&\n    quest.levelRequired <= playerLevel + 5;\n\n  // Find cross-trader dependencies (prereqs from different traders)\n  const crossTraderDeps = useMemo(() => {\n    if (!quest.dependsOn) return [];\n    return quest.dependsOn\n      .filter(\n        (dep) =>\n          dep.requiredQuest.traderId.toLowerCase() !==\n          quest.traderId.toLowerCase()\n      )\n      .map((dep) => ({\n        traderId: dep.requiredQuest.traderId.toLowerCase(),\n        traderName: dep.requiredQuest.trader.name,\n        questTitle: dep.requiredQuest.title,\n      }));\n  }, [quest.dependsOn, quest.traderId]);\n\n  // Group by trader for display\n  const crossTraderBadges = useMemo(() => {\n    const byTrader = new Map<string, { name: string; count: number }>();\n    for (const dep of crossTraderDeps) {\n      const existing = byTrader.get(dep.traderId);\n      if (existing) {\n        existing.count++;\n      } else {\n        byTrader.set(dep.traderId, { name: dep.traderName, count: 1 });\n      }\n    }\n    return Array.from(byTrader.entries()).map(([traderId, info]) => ({\n      traderId,\n      ...info,\n    }));\n  }, [crossTraderDeps]);\n\n  // Should this node be dimmed? (focus mode active but not in chain)\n  const isDimmed = hasFocusMode && !isInFocusChain && !isFocused;\n\n  // Memoize style objects to prevent breaking memo equality checks\n  const nodeStyle = useMemo(() => {\n    // All quests use trader color for border (dimmed gets gray)\n    const borderColor = isDimmed ? \"#636363\" : traderColor.primary;\n\n    return {\n      width: QUEST_NODE_WIDTH,\n      minHeight: QUEST_NODE_HEIGHT,\n      backgroundColor: isDimmed ? \"#424242\" : statusColor.bg,\n      borderColor,\n    };\n  }, [isDimmed, statusColor.bg, traderColor.primary]);\n\n  const levelBadgeStyle = useMemo(\n    () => ({\n      color: isLevelAppropriate\n        ? STATUS_COLORS.completed.primary\n        : isUpcoming\n          ? STATUS_COLORS.available.primary\n          : STATUS_COLORS.locked.primary,\n      fontWeight: isLevelAppropriate ? 600 : 400,\n    }),\n    [isLevelAppropriate, isUpcoming]\n  );\n\n  const handleContextMenu = (e: React.MouseEvent) => {\n    e.preventDefault();\n    // Right-click to open quest details\n    if (onDetails) {\n      onDetails(quest.id);\n    }\n  };\n\n  const handleInfoClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation(); // Prevents node click/status change\n    if (onDetails) {\n      onDetails(quest.id);\n    }\n  };\n\n  const handleInfoMouseDown = (e: React.MouseEvent) => {\n    e.stopPropagation(); // Prevent React Flow from intercepting\n  };\n\n  const handleWikiLinkClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation(); // Prevents node click/status change\n\n    if (quest.wikiLink) {\n      window.open(quest.wikiLink, \"_blank\", \"noopener,noreferrer\");\n    }\n  };\n\n  const handleWikiLinkMouseDown = (e: React.MouseEvent) => {\n    e.stopPropagation(); // Prevent React Flow from intercepting\n  };\n\n  // Long-press handler for mobile (alternative to right-click context menu)\n  const longPressHandlers = useLongPress({\n    threshold: 500,\n    onLongPress: () => {\n      if (onDetails && !isDimmed) {\n        onDetails(quest.id);\n      }\n    },\n  });\n\n  return (\n    <>\n      {/* Only show left handle if quest has dependencies (not a root node) */}\n      {!isRoot && (\n        <Handle\n          type=\"target\"\n          position={Position.Left}\n          className=\"!w-1.5 !h-1.5\"\n          style={HANDLE_STYLE}\n        />\n      )}\n      <div\n        onContextMenu={handleContextMenu}\n        {...longPressHandlers}\n        className={cn(\n          \"relative cursor-pointer rounded border-2 p-2 transition-all duration-150\",\n          \"hover:shadow-md active:scale-95\",\n          selected && \"ring-2 ring-offset-2 ring-blue-500\",\n          quest.computedStatus === \"locked\" && !isDimmed && \"opacity-70\",\n          quest.computedStatus === \"completed\" && !isDimmed && \"opacity-80\",\n          quest.computedStatus === \"available\" &&\n            !isDimmed &&\n            \"shadow-sm hover:shadow-lg\",\n          // Visual hierarchy indicators (only when not dimmed)\n          isRoot && !isDimmed && \"border-l-4 border-l-emerald-500\",\n          isLeaf && !isDimmed && \"border-r-4 border-r-violet-500\",\n          // Kappa indicated by badge only, no ring\n          // Focus mode styling\n          isFocused && \"ring-4 ring-blue-500 shadow-lg scale-105\",\n          isInFocusChain && !isFocused && \"ring-2 ring-blue-300\",\n          isDimmed && \"opacity-40 pointer-events-auto\",\n          // Level-based highlighting (only for available quests, not when keyboard selected)\n          // Kappa quests use badge indicator, so skip ring highlighting for them\n          isLevelAppropriate &&\n            quest.computedStatus === \"available\" &&\n            !isDimmed &&\n            !isFocused &&\n            !isKeyboardSelected &&\n            !quest.kappaRequired &&\n            \"ring-2 ring-emerald-400 shadow-emerald-100\",\n          isUpcoming &&\n            quest.computedStatus !== \"completed\" &&\n            !isDimmed &&\n            !isFocused &&\n            !isKeyboardSelected &&\n            !quest.kappaRequired && // Kappa quests use badge, not ring\n            \"ring-1 ring-amber-300\",\n          // Keyboard navigation selection (orange ring to distinguish from focus) - applied last to take precedence\n          isKeyboardSelected &&\n            !isFocused &&\n            \"ring-2 ring-orange-400 ring-offset-1 shadow-lg\"\n        )}\n        style={nodeStyle}\n      >\n        {/* Kappa badge */}\n        {quest.kappaRequired && (\n          <div\n            className=\"absolute -top-1 -right-1 w-3 h-3 rounded-full flex items-center justify-center text-[7px] font-bold text-white\"\n            style={KAPPA_BADGE_STYLE}\n            title=\"Required for Kappa\"\n          >\n            K\n          </div>\n        )}\n\n        {/* Cross-trader dependency badges */}\n        {crossTraderBadges.length > 0 && !isDimmed && (\n          <div className=\"absolute -top-1 left-1 flex gap-px\">\n            {crossTraderBadges.slice(0, 2).map((badge) => {\n              const badgeColor = getTraderColor(badge.traderId);\n              return (\n                <div\n                  key={badge.traderId}\n                  className=\"px-0.5 rounded text-[7px] font-medium text-white\"\n                  style={{ backgroundColor: badgeColor.primary }}\n                  title={`Requires quest(s) from ${badge.name}`}\n                >\n                  {badge.name.slice(0, 2)}\n                </div>\n              );\n            })}\n            {crossTraderBadges.length > 2 && (\n              <div\n                className=\"px-0.5 rounded text-[7px] font-medium text-white\"\n                style={HANDLE_STYLE}\n              >\n                +{crossTraderBadges.length - 2}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Saving spinner overlay */}\n        {isSaving && (\n          <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none bg-black/20 rounded\">\n            <Loader2 className=\"w-5 h-5 animate-spin text-primary\" />\n          </div>\n        )}\n\n        {/* Completed checkmark overlay */}\n        {quest.computedStatus === \"completed\" && !isSaving && (\n          <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\n            <svg\n              className=\"w-5 h-5 opacity-40\"\n              style={CHECKMARK_STYLE}\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={3}\n                d=\"M5 13l4 4L19 7\"\n              />\n            </svg>\n          </div>\n        )}\n\n        {/* Quest title */}\n        <div\n          className=\"font-semibold text-[14px] leading-tight line-clamp-2\"\n          style={TITLE_STYLE}\n          title={quest.title}\n        >\n          {quest.title}\n        </div>\n\n        {/* Level badge and action buttons row */}\n        {/* Refactoring UI: Labels tertiary, data primary */}\n        <div className=\"flex items-center justify-between mt-1\">\n          <span className=\"flex items-center gap-0.5\">\n            <span\n              className=\"text-[10px] uppercase tracking-wide\"\n              style={{ color: \"var(--text-tertiary)\" }}\n            >\n              Lv\n            </span>\n            <span className=\"text-[12px] font-semibold\" style={levelBadgeStyle}>\n              {quest.levelRequired}\n            </span>\n            {/* Objective count badge */}\n          </span>\n          {/* Action buttons - info and wiki link */}\n          {/* Touch targets: 24px visible area with padding for easier clicking */}\n          <div className=\"flex items-center gap-1\">\n            {/* Info button - opens quest details */}\n            {!isDimmed && onDetails && (\n              <Tooltip delayDuration={300}>\n                <TooltipTrigger asChild>\n                  <button\n                    type=\"button\"\n                    onClick={handleInfoClick}\n                    onMouseDown={handleInfoMouseDown}\n                    onTouchStart={(e) => e.stopPropagation()}\n                    onTouchEnd={(e) => {\n                      e.stopPropagation();\n                      e.preventDefault();\n                      if (onDetails) onDetails(quest.id);\n                    }}\n                    className=\"w-6 h-6 flex items-center justify-center opacity-60 hover:opacity-100 transition-colors duration-150 rounded-full hover:bg-black/20 focus:outline-none focus:ring-1 focus:ring-offset-1 pointer-events-auto\"\n                    style={WIKI_LINK_STYLE}\n                    aria-label={`View ${quest.title} details`}\n                  >\n                    <Info className=\"w-[14px] h-[14px]\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"top\" sideOffset={4}>\n                  <p className=\"text-xs\">View Details</p>\n                </TooltipContent>\n              </Tooltip>\n            )}\n            {/* Wiki link */}\n            {quest.wikiLink && !isDimmed && (\n              <Tooltip delayDuration={300}>\n                <TooltipTrigger asChild>\n                  <button\n                    type=\"button\"\n                    onClick={handleWikiLinkClick}\n                    onMouseDown={handleWikiLinkMouseDown}\n                    onTouchStart={(e) => e.stopPropagation()}\n                    onTouchEnd={(e) => {\n                      e.stopPropagation();\n                      e.preventDefault();\n                      if (quest.wikiLink) {\n                        window.open(\n                          quest.wikiLink,\n                          \"_blank\",\n                          \"noopener,noreferrer\"\n                        );\n                      }\n                    }}\n                    className=\"w-6 h-6 flex items-center justify-center opacity-60 hover:opacity-100 transition-colors duration-150 rounded-full hover:bg-black/20 focus:outline-none focus:ring-1 focus:ring-offset-1 pointer-events-auto\"\n                    style={WIKI_LINK_STYLE}\n                    aria-label={`Open ${quest.title} wiki page`}\n                  >\n                    <ExternalLink className=\"w-[14px] h-[14px]\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"top\" sideOffset={4}>\n                  <p className=\"text-xs\">View on Tarkov Wiki</p>\n                </TooltipContent>\n              </Tooltip>\n            )}\n          </div>\n        </div>\n      </div>\n      {/* Only show right handle if quest has dependents (not a leaf node) */}\n      {!isLeaf && (\n        <Handle\n          type=\"source\"\n          position={Position.Right}\n          className=\"!w-1.5 !h-1.5\"\n          style={HANDLE_STYLE}\n        />\n      )}\n    </>\n  );\n}\n\nexport const QuestNode = memo(QuestNodeComponent);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 752, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/lib/quest-layout.ts"],"sourcesContent":["import dagre from \"dagre\";\nimport type { Edge } from \"@xyflow/react\";\nimport type {\n  QuestWithProgress,\n  QuestNode,\n  QuestEdge,\n  QuestStatus,\n  Trader,\n  TraderNode,\n  TraderQuestGroup,\n  RequirementStatusType,\n} from \"@/types\";\nimport {\n  QUEST_NODE_WIDTH,\n  QUEST_NODE_HEIGHT,\n} from \"@/components/quest-tree/QuestNode\";\nimport { getTraderColor } from \"@/lib/trader-colors\";\n\nconst LAYOUT_CONFIG = {\n  rankdir: \"LR\" as const, // Left-to-right layout\n  nodesep: 10, // Comfortable vertical spacing between nodes\n  ranksep: 20, // Comfortable horizontal spacing between ranks\n  marginx: 5, // Minimal padding from left edge\n  marginy: 10, // Minimal padding from top edge\n};\n\n// Lane-based layout configuration\nexport const LANE_CONFIG = {\n  TRADER_NODE_WIDTH: 60,\n  TRADER_NODE_HEIGHT: 40,\n  BASE_LANE_HEIGHT: 80, // Minimum lane height (increased for better spacing)\n  LANE_SPACING: 25, // Comfortable gap between lanes (increased)\n  TRADER_TO_QUEST_GAP: 20, // Comfortable gap after trader header\n  QUEST_VERTICAL_GAP: 25, // Gap between quests\n};\n\n// Fixed trader order (optimized for common cross-dependencies)\nconst TRADER_ORDER = [\n  \"prapor\",\n  \"therapist\",\n  \"skier\",\n  \"peacekeeper\",\n  \"mechanic\",\n  \"ragman\",\n  \"jaeger\",\n  \"fence\",\n  \"lightkeeper\",\n];\n\n/**\n * Calculate dynamic node height based on quest title length\n * Allows quest names to span multiple lines instead of truncating\n *\n * Current node specs: 155px width, p-2 padding (8px each side), 14px title font\n */\nexport function calculateNodeHeight(title: string): number {\n  // Base height for single-line title (matches QUEST_NODE_HEIGHT)\n  const baseHeight = QUEST_NODE_HEIGHT;\n\n  // Approximate characters per line at 14px font for 155px width node with 16px total padding\n  // Content width ~139px, at ~9px per char average = ~15 chars per line\n  const charsPerLine = 15;\n  const estimatedLines = Math.ceil(title.length / charsPerLine);\n\n  // Cap at 2 lines maximum (matches line-clamp-2 in QuestNode)\n  const lines = Math.min(estimatedLines, 2);\n\n  // 18px per additional line (14px font + line spacing)\n  return baseHeight + (lines - 1) * 18;\n}\n\ninterface BuildQuestGraphOptions {\n  onStatusChange: (questId: string, status: QuestStatus) => void;\n  onClick: (questId: string) => void;\n  onFocus: (questId: string) => void;\n  onDetails?: (questId: string) => void; // Open quest details modal\n  selectedQuestId?: string | null;\n  focusedQuestId?: string | null;\n  focusChain?: Set<string>;\n  playerLevel?: number | null;\n  maxColumns?: number | null; // Limit number of columns (depth) shown per trader - null = show all\n  savingQuestIds?: Set<string>; // Set of quest IDs currently being saved\n  keyboardSelectedId?: string | null; // Currently keyboard-selected quest for navigation\n}\n\nexport interface QuestGraph {\n  nodes: QuestNode[];\n  edges: QuestEdge[];\n}\n\n/**\n * Calculate the full dependency chain for a quest (prerequisites + dependents)\n */\nexport function getQuestChain(\n  questId: string,\n  quests: QuestWithProgress[]\n): Set<string> {\n  const questMap = new Map(quests.map((q) => [q.id, q]));\n  const chain = new Set<string>();\n\n  // Add the focused quest itself\n  chain.add(questId);\n\n  // Recursively get all prerequisites (quests this one depends on)\n  function getPrerequisites(id: string) {\n    const quest = questMap.get(id);\n    if (!quest) return;\n\n    for (const dep of quest.dependsOn || []) {\n      if (!chain.has(dep.requiredQuest.id)) {\n        chain.add(dep.requiredQuest.id);\n        getPrerequisites(dep.requiredQuest.id);\n      }\n    }\n  }\n\n  // Recursively get all dependents (quests that depend on this one)\n  function getDependents(id: string) {\n    const quest = questMap.get(id);\n    if (!quest) return;\n\n    for (const dep of quest.dependedOnBy || []) {\n      if (!chain.has(dep.dependentQuest.id)) {\n        chain.add(dep.dependentQuest.id);\n        getDependents(dep.dependentQuest.id);\n      }\n    }\n  }\n\n  getPrerequisites(questId);\n  getDependents(questId);\n\n  return chain;\n}\n\n/**\n * Get all incomplete prerequisites for a quest (recursively).\n * Returns quests that need to be completed before this quest can be started,\n * in dependency order (deepest prerequisites first).\n * Does NOT include the target quest itself.\n */\nexport function getIncompletePrerequisites(\n  questId: string,\n  quests: QuestWithProgress[]\n): QuestWithProgress[] {\n  const questMap = new Map(quests.map((q) => [q.id, q]));\n  const prerequisites: QuestWithProgress[] = [];\n  const seen = new Set<string>();\n\n  function collectPrereqs(id: string) {\n    const quest = questMap.get(id);\n    if (!quest) return;\n\n    for (const dep of quest.dependsOn || []) {\n      const prereqId = dep.requiredQuest.id;\n      if (seen.has(prereqId)) continue;\n      seen.add(prereqId);\n\n      // First recurse to get deeper prerequisites (post-order traversal)\n      collectPrereqs(prereqId);\n\n      // Then add this prerequisite (after its own prerequisites)\n      const prereqQuest = questMap.get(prereqId);\n      if (prereqQuest && prereqQuest.computedStatus !== \"completed\") {\n        prerequisites.push(prereqQuest);\n      }\n    }\n  }\n\n  collectPrereqs(questId);\n\n  // Return in dependency order (no sorting - order matters for skip feature)\n  return prerequisites;\n}\n\nexport function buildQuestGraph(\n  quests: QuestWithProgress[],\n  options: BuildQuestGraphOptions\n): QuestGraph {\n  const {\n    onStatusChange,\n    onClick,\n    onFocus,\n    onDetails,\n    selectedQuestId,\n    focusedQuestId,\n    focusChain,\n    playerLevel,\n    savingQuestIds,\n    keyboardSelectedId,\n  } = options;\n  const hasFocusMode = focusedQuestId !== null && focusedQuestId !== undefined;\n\n  // Create a map for quick quest lookup\n  const questMap = new Map(quests.map((q) => [q.id, q]));\n\n  // Create Dagre graph\n  const g = new dagre.graphlib.Graph().setDefaultEdgeLabel(() => ({}));\n  g.setGraph(LAYOUT_CONFIG);\n\n  // Add nodes\n  for (const quest of quests) {\n    g.setNode(quest.id, {\n      width: QUEST_NODE_WIDTH,\n      height: QUEST_NODE_HEIGHT,\n    });\n  }\n\n  // Add edges (from required quest to dependent quest)\n  const edges: QuestEdge[] = [];\n  for (const quest of quests) {\n    for (const dep of quest.dependsOn || []) {\n      const requiredQuest = questMap.get(dep.requiredQuest.id);\n      if (requiredQuest) {\n        g.setEdge(dep.requiredQuest.id, quest.id);\n\n        // Check if this edge is part of the focus chain\n        const isEdgeInFocusChain =\n          focusChain?.has(quest.id) && focusChain?.has(dep.requiredQuest.id);\n        const shouldDimEdge = hasFocusMode && !isEdgeInFocusChain;\n\n        // Get requirement status (default to [\"complete\"] for backwards compatibility)\n        const requirementStatus = (dep.requirementStatus || [\n          \"complete\",\n        ]) as RequirementStatusType[];\n        const isActiveOnly =\n          requirementStatus.includes(\"active\") &&\n          !requirementStatus.includes(\"complete\");\n\n        edges.push({\n          id: `${dep.requiredQuest.id}-${quest.id}`,\n          source: dep.requiredQuest.id,\n          target: quest.id,\n          type: \"default\", // Bezier curves for smoother flow\n          animated: quest.computedStatus === \"available\" && !shouldDimEdge,\n          style: {\n            stroke: shouldDimEdge\n              ? \"#D1D5DB\" // Dim gray when not in focus chain\n              : quest.computedStatus === \"completed\"\n                ? \"#10B981\"\n                : quest.computedStatus === \"available\"\n                  ? \"#3B82F6\"\n                  : quest.computedStatus === \"locked\"\n                    ? \"#6B7280\"\n                    : \"#9CA3AF\",\n            strokeWidth: isEdgeInFocusChain ? 3 : quest.kappaRequired ? 3 : 2,\n            strokeDasharray: isActiveOnly ? \"5,5\" : undefined, // Dashed line for \"active only\" requirements\n            opacity: shouldDimEdge\n              ? 0.4\n              : quest.computedStatus === \"locked\"\n                ? 0.5\n                : 1,\n          },\n          data: {\n            sourceStatus: requiredQuest.computedStatus,\n            targetStatus: quest.computedStatus,\n            requirementStatus,\n          },\n        });\n      }\n    }\n  }\n\n  // Run Dagre layout\n  dagre.layout(g);\n\n  // Find root quests (no incoming edges / no dependencies)\n  const rootQuestIds = new Set(\n    quests.filter((q) => !q.dependsOn?.length).map((q) => q.id)\n  );\n\n  // Find leaf quests (no outgoing edges / no dependents)\n  const leafQuestIds = new Set(\n    quests.filter((q) => !q.dependedOnBy?.length).map((q) => q.id)\n  );\n\n  // Find the minimum x position among root quests to align them at the left\n  let minRootX = Infinity;\n  for (const questId of rootQuestIds) {\n    const node = g.node(questId);\n    if (node && node.x < minRootX) {\n      minRootX = node.x;\n    }\n  }\n\n  // Calculate shift to align roots at left margin\n  const shiftX = minRootX - QUEST_NODE_WIDTH / 2 - LAYOUT_CONFIG.marginx;\n\n  // Convert to React Flow nodes with adjusted positions\n  const nodes: QuestNode[] = quests.map((quest) => {\n    const nodeWithPosition = g.node(quest.id);\n    const isInFocusChain = focusChain?.has(quest.id) ?? false;\n    return {\n      id: quest.id,\n      type: \"quest\",\n      position: {\n        // Dagre returns center position, adjust to top-left for React Flow\n        // Also shift all nodes left so roots align at the margin\n        x: nodeWithPosition.x - QUEST_NODE_WIDTH / 2 - shiftX,\n        y: nodeWithPosition.y - QUEST_NODE_HEIGHT / 2,\n      },\n      data: {\n        quest,\n        isSelected: quest.id === selectedQuestId,\n        isRoot: rootQuestIds.has(quest.id),\n        isLeaf: leafQuestIds.has(quest.id),\n        isFocused: quest.id === focusedQuestId,\n        isInFocusChain,\n        hasFocusMode,\n        playerLevel: playerLevel ?? null,\n        isSaving: savingQuestIds?.has(quest.id) ?? false,\n        isKeyboardSelected: quest.id === keyboardSelectedId,\n        onStatusChange,\n        onClick,\n        onFocus,\n        onDetails,\n      },\n    };\n  });\n\n  return { nodes, edges };\n}\n\n// Filter quests by trader and return subgraph\nexport function filterQuestsByTrader(\n  quests: QuestWithProgress[],\n  traderId: string\n): QuestWithProgress[] {\n  return quests.filter((q) => q.traderId === traderId);\n}\n\n/**\n * Calculate depth (column) for each quest within a trader's tree.\n * Depth 0 = root quests (no same-trader prerequisites)\n * Depth N = max depth of same-trader prerequisites + 1\n */\nexport function calculateTraderLocalDepths(\n  quests: QuestWithProgress[],\n  traderId: string\n): Map<string, number> {\n  const depths = new Map<string, number>();\n  const traderQuests = quests.filter(\n    (q) => q.traderId.toLowerCase() === traderId.toLowerCase()\n  );\n  const questMap = new Map(traderQuests.map((q) => [q.id, q]));\n\n  function getDepth(questId: string, visited: Set<string>): number {\n    if (visited.has(questId)) return 0;\n    visited.add(questId);\n\n    if (depths.has(questId)) return depths.get(questId)!;\n\n    const quest = questMap.get(questId);\n    if (!quest) return 0;\n\n    // Find same-trader prerequisites\n    const sameTraderPrereqs = (quest.dependsOn || []).filter((dep) => {\n      const prereq = questMap.get(dep.requiredQuest.id);\n      return prereq !== undefined;\n    });\n\n    if (sameTraderPrereqs.length === 0) {\n      depths.set(questId, 0);\n      return 0;\n    }\n\n    let maxPrereqDepth = 0;\n    for (const dep of sameTraderPrereqs) {\n      const prereqDepth = getDepth(dep.requiredQuest.id, new Set(visited));\n      maxPrereqDepth = Math.max(maxPrereqDepth, prereqDepth);\n    }\n\n    const depth = maxPrereqDepth + 1;\n    depths.set(questId, depth);\n    return depth;\n  }\n\n  for (const quest of traderQuests) {\n    getDepth(quest.id, new Set());\n  }\n\n  return depths;\n}\n\n/**\n * Filter quests to only include those within the first N columns (depths).\n * maxColumns: number of columns to show (1 = only root quests, 2 = roots + their direct dependents, etc.)\n * globalDepths: Optional pre-computed global depths that consider cross-trader dependencies.\n *               If provided, uses global depths for filtering (recommended for accurate cross-trader handling).\n *               If not provided, falls back to local depths (same-trader only).\n */\nexport function filterQuestsByColumns(\n  quests: QuestWithProgress[],\n  traderId: string,\n  maxColumns: number | null,\n  globalDepths?: Map<string, number>\n): QuestWithProgress[] {\n  if (maxColumns === null) return quests;\n\n  const traderQuests = quests.filter(\n    (q) => q.traderId.toLowerCase() === traderId.toLowerCase()\n  );\n\n  // Use global depths if provided, otherwise fall back to local depths\n  const depths = globalDepths ?? calculateTraderLocalDepths(quests, traderId);\n\n  // Include quests with depth < maxColumns (0-indexed, so depth 0-4 for maxColumns=5)\n  return traderQuests.filter((q) => {\n    const depth = depths.get(q.id) ?? 0;\n    return depth < maxColumns;\n  });\n}\n\n// Get all unique maps from quest objectives\nexport function getQuestMaps(quests: QuestWithProgress[]): string[] {\n  const maps = new Set<string>();\n  for (const quest of quests) {\n    for (const obj of quest.objectives || []) {\n      if (obj.map) {\n        maps.add(obj.map);\n      }\n    }\n  }\n  return Array.from(maps).sort();\n}\n\n// Compute quest status based on dependencies\nexport function computeQuestStatus(\n  quest: QuestWithProgress,\n  questMap: Map<string, QuestWithProgress>\n): QuestStatus {\n  // If user has explicit progress, use that\n  if (quest.progress) {\n    return quest.progress.status;\n  }\n\n  // Check if all dependencies are completed\n  const allDepsCompleted = (quest.dependsOn || []).every((dep) => {\n    const requiredQuest = questMap.get(dep.requiredQuest.id);\n    return requiredQuest?.computedStatus === \"completed\";\n  });\n\n  // If no dependencies or all completed, quest is available\n  if (quest.dependsOn?.length === 0 || allDepsCompleted) {\n    return \"available\";\n  }\n\n  return \"locked\";\n}\n\n// ============================================================================\n// TRADER LANE LAYOUT FUNCTIONS\n// ============================================================================\n\n/**\n * Calculate the global depth for each quest considering ALL dependencies\n * (both intra-trader and cross-trader). This ensures quests are positioned\n * in the correct column based on when they can actually be started.\n */\nexport function calculateGlobalDepths(\n  quests: QuestWithProgress[]\n): Map<string, number> {\n  const depths = new Map<string, number>();\n  const questMap = new Map(quests.map((q) => [q.id, q]));\n  // Single Set for cycle detection - reused across all calculations\n  const visiting = new Set<string>();\n\n  // Recursive function to calculate depth with memoization\n  function getDepth(questId: string): number {\n    // Return cached result if available\n    if (depths.has(questId)) {\n      return depths.get(questId)!;\n    }\n\n    // Prevent infinite loops (cycle detection)\n    if (visiting.has(questId)) return 0;\n    visiting.add(questId);\n\n    const quest = questMap.get(questId);\n    if (!quest) {\n      visiting.delete(questId);\n      return 0;\n    }\n\n    // No dependencies = depth 0 (root quest)\n    if (!quest.dependsOn || quest.dependsOn.length === 0) {\n      visiting.delete(questId);\n      depths.set(questId, 0);\n      return 0;\n    }\n\n    // Depth = max depth of all dependencies + 1\n    let maxDepPrereqDepth = 0;\n    for (const dep of quest.dependsOn) {\n      const prereqDepth = getDepth(dep.requiredQuest.id);\n      maxDepPrereqDepth = Math.max(maxDepPrereqDepth, prereqDepth);\n    }\n\n    const depth = maxDepPrereqDepth + 1;\n    visiting.delete(questId);\n    depths.set(questId, depth);\n    return depth;\n  }\n\n  // Calculate depth for all quests\n  for (const quest of quests) {\n    getDepth(quest.id);\n  }\n\n  return depths;\n}\n\n/**\n * Split quests by trader and categorize dependencies\n */\nexport function splitQuestsByTrader(\n  quests: QuestWithProgress[]\n): Map<string, TraderQuestGroup> {\n  const groups = new Map<string, TraderQuestGroup>();\n\n  // Group quests by trader\n  for (const quest of quests) {\n    const traderId = quest.traderId.toLowerCase();\n    if (!groups.has(traderId)) {\n      groups.set(traderId, {\n        traderId,\n        trader: quest.trader,\n        quests: [],\n        rootQuests: [],\n        intraTraderDeps: [],\n        crossTraderDeps: [],\n      });\n    }\n    groups.get(traderId)!.quests.push(quest);\n  }\n\n  // Classify dependencies for each quest\n  for (const quest of quests) {\n    const traderId = quest.traderId.toLowerCase();\n    const group = groups.get(traderId)!;\n    let hasIntraTraderDep = false;\n\n    for (const dep of quest.dependsOn || []) {\n      const sourceTraderId = dep.requiredQuest.traderId.toLowerCase();\n\n      if (sourceTraderId === traderId) {\n        // Intra-trader dependency\n        group.intraTraderDeps.push({\n          sourceId: dep.requiredQuest.id,\n          targetId: quest.id,\n        });\n        hasIntraTraderDep = true;\n      } else {\n        // Cross-trader dependency\n        group.crossTraderDeps.push({\n          sourceQuestId: dep.requiredQuest.id,\n          sourceTraderId,\n          targetQuestId: quest.id,\n          targetTraderId: traderId,\n        });\n\n        // Also add to the source trader's group\n        const sourceGroup = groups.get(sourceTraderId);\n        if (sourceGroup) {\n          sourceGroup.crossTraderDeps.push({\n            sourceQuestId: dep.requiredQuest.id,\n            sourceTraderId,\n            targetQuestId: quest.id,\n            targetTraderId: traderId,\n          });\n        }\n      }\n    }\n\n    // If no intra-trader dependencies, it's a root quest for this trader\n    if (!hasIntraTraderDep) {\n      group.rootQuests.push(quest);\n    }\n  }\n\n  return groups;\n}\n\n/**\n * Compute optimal trader order based on cross-dependencies\n */\nexport function computeTraderOrder(\n  groups: Map<string, TraderQuestGroup>\n): string[] {\n  // Build adjacency weights (count of cross-trader dependencies)\n  const weights = new Map<string, Map<string, number>>();\n\n  for (const group of groups.values()) {\n    if (!weights.has(group.traderId)) {\n      weights.set(group.traderId, new Map());\n    }\n\n    for (const dep of group.crossTraderDeps) {\n      // Count connections between traders\n      const w = weights.get(group.traderId)!;\n      const currentWeight = w.get(dep.sourceTraderId) || 0;\n      w.set(dep.sourceTraderId, currentWeight + 1);\n    }\n  }\n\n  // Start with fixed order, but could be optimized with barycenter heuristic\n  const traderIds = Array.from(groups.keys());\n\n  // Sort by TRADER_ORDER, unknown traders go to end\n  traderIds.sort((a, b) => {\n    const aIndex = TRADER_ORDER.indexOf(a);\n    const bIndex = TRADER_ORDER.indexOf(b);\n    if (aIndex === -1 && bIndex === -1) return 0;\n    if (aIndex === -1) return 1;\n    if (bIndex === -1) return -1;\n    return aIndex - bIndex;\n  });\n\n  return traderIds;\n}\n\ninterface TraderLaneLayout {\n  traderId: string;\n  nodes: QuestNode[];\n  edges: QuestEdge[];\n  laneHeight: number;\n  laneWidth: number;\n}\n\n/**\n * Layout a single trader's quest lane using Dagre\n * Uses global depths to position quests correctly based on cross-trader dependencies\n */\nexport function layoutTraderLane(\n  group: TraderQuestGroup,\n  options: BuildQuestGraphOptions,\n  globalDepths: Map<string, number>\n): TraderLaneLayout {\n  const {\n    onStatusChange,\n    onClick,\n    onFocus,\n    onDetails,\n    selectedQuestId,\n    focusedQuestId,\n    focusChain,\n    playerLevel,\n    savingQuestIds,\n    keyboardSelectedId,\n  } = options;\n  const hasFocusMode = focusedQuestId !== null && focusedQuestId !== undefined;\n\n  // Create Dagre graph for this trader only\n  const g = new dagre.graphlib.Graph().setDefaultEdgeLabel(() => ({}));\n  g.setGraph({\n    rankdir: \"LR\",\n    nodesep: LANE_CONFIG.QUEST_VERTICAL_GAP, // Vertical spacing between nodes\n    ranksep: LAYOUT_CONFIG.ranksep,\n    marginx: 0,\n    marginy: 0,\n  });\n\n  // Find minimum depth in this trader's quests (to normalize positions)\n  let minDepthInLane = Infinity;\n  for (const quest of group.quests) {\n    const depth = globalDepths.get(quest.id) ?? 0;\n    minDepthInLane = Math.min(minDepthInLane, depth);\n  }\n  if (minDepthInLane === Infinity) minDepthInLane = 0;\n\n  // Add quest nodes with dynamic heights\n  for (const quest of group.quests) {\n    const nodeHeight = calculateNodeHeight(quest.title);\n    g.setNode(quest.id, {\n      width: QUEST_NODE_WIDTH,\n      height: nodeHeight,\n    });\n  }\n\n  // For quests with cross-trader deps, we need to add invisible spacer nodes\n  // to push them to the correct column based on their global depth.\n  // This handles both: quests with ONLY cross-trader deps, AND quests with\n  // both intra-trader AND cross-trader deps (Dagre uses max constraint).\n  const questsWithCrossTraderDeps = group.quests.filter((quest) => {\n    return group.crossTraderDeps.some((d) => d.targetQuestId === quest.id);\n  });\n\n  // Create a chain of spacer nodes for each depth level needed\n  const spacersByDepth = new Map<number, string>();\n  let maxSpacerDepth = 0;\n\n  for (const quest of questsWithCrossTraderDeps) {\n    const globalDepth = globalDepths.get(quest.id) ?? 0;\n    // Normalize to lane-relative depth\n    const localDepth = globalDepth - minDepthInLane;\n    if (localDepth > 0) {\n      maxSpacerDepth = Math.max(maxSpacerDepth, localDepth);\n    }\n  }\n\n  // Create spacer chain: spacer-0 -> spacer-1 -> spacer-2 -> ...\n  // The spacer chain is anchored to root quests so Dagre aligns them properly\n  if (maxSpacerDepth > 0) {\n    for (let i = 0; i <= maxSpacerDepth; i++) {\n      const spacerId = `__spacer_${group.traderId}_${i}`;\n      spacersByDepth.set(i, spacerId);\n      g.setNode(spacerId, {\n        width: 1, // Invisible, minimal width\n        height: 1,\n      });\n      if (i > 0) {\n        const prevSpacerId = spacersByDepth.get(i - 1)!;\n        g.setEdge(prevSpacerId, spacerId);\n      }\n    }\n\n    // Anchor spacer_0 to root quests so the spacer chain aligns with the quest tree\n    const spacer0 = spacersByDepth.get(0);\n    if (spacer0) {\n      for (const rootQuest of group.rootQuests) {\n        // Only connect if this root quest doesn't have cross-trader deps\n        // (otherwise it will be connected to a deeper spacer)\n        const hasCrossTraderDep = questsWithCrossTraderDeps.some(\n          (q) => q.id === rootQuest.id\n        );\n        if (!hasCrossTraderDep) {\n          g.setEdge(spacer0, rootQuest.id);\n        }\n      }\n    }\n  }\n\n  // Connect quests with cross-trader deps to the appropriate spacer\n  // Dagre will use the maximum of all incoming edge constraints\n  for (const quest of questsWithCrossTraderDeps) {\n    const globalDepth = globalDepths.get(quest.id) ?? 0;\n    const localDepth = globalDepth - minDepthInLane;\n    if (localDepth > 0) {\n      // Connect from the spacer at depth-1 to this quest\n      const spacerId = spacersByDepth.get(localDepth - 1);\n      if (spacerId) {\n        g.setEdge(spacerId, quest.id);\n      }\n    }\n  }\n\n  // Add only intra-trader edges\n  const edges: QuestEdge[] = [];\n  const questMap = new Map(group.quests.map((q) => [q.id, q]));\n\n  for (const dep of group.intraTraderDeps) {\n    g.setEdge(dep.sourceId, dep.targetId);\n\n    const sourceQuest = questMap.get(dep.sourceId);\n    const targetQuest = questMap.get(dep.targetId);\n\n    if (sourceQuest && targetQuest) {\n      const isEdgeInFocusChain =\n        focusChain?.has(targetQuest.id) && focusChain?.has(dep.sourceId);\n      const shouldDimEdge = hasFocusMode && !isEdgeInFocusChain;\n\n      // Find the dependency to get requirementStatus\n      const dependency = targetQuest.dependsOn?.find(\n        (d) => d.requiredQuest.id === dep.sourceId\n      );\n      const requirementStatus = (dependency?.requirementStatus || [\n        \"complete\",\n      ]) as RequirementStatusType[];\n      const isActiveOnly =\n        requirementStatus.includes(\"active\") &&\n        !requirementStatus.includes(\"complete\");\n\n      edges.push({\n        id: `${dep.sourceId}-${dep.targetId}`,\n        source: dep.sourceId,\n        target: dep.targetId,\n        type: \"default\",\n        animated: targetQuest.computedStatus === \"available\" && !shouldDimEdge,\n        style: {\n          stroke: shouldDimEdge\n            ? \"#D1D5DB\"\n            : targetQuest.computedStatus === \"completed\"\n              ? \"#10B981\"\n              : targetQuest.computedStatus === \"available\"\n                ? \"#3B82F6\"\n                : targetQuest.computedStatus === \"locked\"\n                  ? \"#6B7280\"\n                  : \"#9CA3AF\",\n          strokeWidth: isEdgeInFocusChain\n            ? 3\n            : targetQuest.kappaRequired\n              ? 3\n              : 2,\n          strokeDasharray: isActiveOnly ? \"5,5\" : undefined, // Dashed line for \"active only\" requirements\n          opacity: shouldDimEdge\n            ? 0.4\n            : targetQuest.computedStatus === \"locked\"\n              ? 0.5\n              : 1,\n        },\n        data: {\n          sourceStatus: sourceQuest.computedStatus,\n          targetStatus: targetQuest.computedStatus,\n          requirementStatus,\n        },\n      });\n    }\n  }\n\n  // Run Dagre layout\n  dagre.layout(g);\n\n  // Find bounds\n  let maxX = 0;\n  let maxY = 0;\n  let minY = Infinity;\n\n  for (const quest of group.quests) {\n    const node = g.node(quest.id);\n    if (node) {\n      maxX = Math.max(maxX, node.x + QUEST_NODE_WIDTH / 2);\n      maxY = Math.max(maxY, node.y + QUEST_NODE_HEIGHT / 2);\n      minY = Math.min(minY, node.y - QUEST_NODE_HEIGHT / 2);\n    }\n  }\n\n  // Calculate lane height based on actual content\n  const contentHeight =\n    group.quests.length > 0 ? maxY - minY : QUEST_NODE_HEIGHT;\n  const laneHeight = Math.max(LANE_CONFIG.BASE_LANE_HEIGHT, contentHeight + 20);\n\n  // Find root quests for visual indicator\n  const rootQuestIds = new Set(group.rootQuests.map((q) => q.id));\n\n  // Find leaf quests\n  const hasOutgoingDep = new Set(group.intraTraderDeps.map((d) => d.sourceId));\n  const leafQuestIds = new Set(\n    group.quests.filter((q) => !hasOutgoingDep.has(q.id)).map((q) => q.id)\n  );\n\n  // Convert to nodes (positions relative to lane origin)\n  // First pass: calculate positions\n  const nodePositions = group.quests.map((quest) => {\n    const nodeWithPosition = g.node(quest.id);\n    return {\n      quest,\n      x: nodeWithPosition.x - QUEST_NODE_WIDTH / 2,\n      // Convert from Dagre center position to top-left\n      y: nodeWithPosition.y - QUEST_NODE_HEIGHT / 2,\n    };\n  });\n\n  // Find the minimum Y to normalize all positions so first quest starts at y=0\n  const minQuestY = Math.min(...nodePositions.map((p) => p.y));\n\n  // Second pass: create nodes with normalized positions\n  const nodes: QuestNode[] = nodePositions.map(({ quest, x, y }) => {\n    const isInFocusChain = focusChain?.has(quest.id) ?? false;\n\n    // Calculate dynamic height for this quest\n    const nodeHeight = calculateNodeHeight(quest.title);\n\n    return {\n      id: quest.id,\n      type: \"quest\",\n      position: {\n        x,\n        y: y - minQuestY, // Normalize so topmost quest is at y=0\n      },\n      data: {\n        quest,\n        nodeHeight, // Pass dynamic height to component\n        isSelected: quest.id === selectedQuestId,\n        isRoot: rootQuestIds.has(quest.id),\n        isLeaf: leafQuestIds.has(quest.id),\n        isFocused: quest.id === focusedQuestId,\n        isInFocusChain,\n        hasFocusMode,\n        playerLevel: playerLevel ?? null,\n        isSaving: savingQuestIds?.has(quest.id) ?? false,\n        isKeyboardSelected: quest.id === keyboardSelectedId,\n        onStatusChange,\n        onClick,\n        onFocus,\n        onDetails,\n      },\n    };\n  });\n\n  return {\n    traderId: group.traderId,\n    nodes,\n    edges,\n    laneHeight,\n    laneWidth: maxX,\n  };\n}\n\ninterface StackedLayout {\n  nodes: Array<QuestNode | TraderNode>;\n  edges: QuestEdge[];\n  laneYOffsets: Map<string, { y: number; height: number }>;\n}\n\n/**\n * Stack trader lanes vertically\n */\nexport function stackTraderLanes(\n  laneLayouts: TraderLaneLayout[],\n  traderOrder: string[],\n  groups: Map<string, TraderQuestGroup>\n): StackedLayout {\n  const allNodes: Array<QuestNode | TraderNode> = [];\n  const allEdges: QuestEdge[] = [];\n  const laneYOffsets = new Map<string, { y: number; height: number }>();\n\n  let currentY = LAYOUT_CONFIG.marginy;\n\n  for (const traderId of traderOrder) {\n    const lane = laneLayouts.find((l) => l.traderId === traderId);\n    const group = groups.get(traderId);\n\n    if (!lane || !group) continue;\n\n    // Store lane position\n    laneYOffsets.set(traderId, { y: currentY, height: lane.laneHeight });\n\n    // Create trader header node\n    const traderColor = getTraderColor(traderId);\n    const completedCount = group.quests.filter(\n      (q) => q.computedStatus === \"completed\"\n    ).length;\n\n    // Create trader node on the left, spanning full lane height\n    const traderNode: TraderNode = {\n      id: `trader-${traderId}`,\n      type: \"trader\",\n      position: {\n        x: 0, // Will be at left edge after normalization\n        y: currentY,\n      },\n      data: {\n        traderId,\n        traderName: group.trader.name,\n        color: traderColor.primary,\n        questCount: group.quests.length,\n        completedCount,\n        laneHeight: lane.laneHeight, // Pass lane height for full-height rendering\n      },\n    };\n    allNodes.push(traderNode);\n\n    // Offset quest nodes to the right of trader\n    const xOffset =\n      LANE_CONFIG.TRADER_NODE_WIDTH + LANE_CONFIG.TRADER_TO_QUEST_GAP;\n\n    for (const node of lane.nodes) {\n      allNodes.push({\n        ...node,\n        position: {\n          x: node.position.x + xOffset,\n          y: node.position.y + currentY,\n        },\n      });\n    }\n\n    // Add edges\n    allEdges.push(...lane.edges);\n\n    // Move to next lane\n    currentY += lane.laneHeight + LANE_CONFIG.LANE_SPACING;\n  }\n\n  // Normalize positions so content starts near (0, 0) with padding\n  // Include ALL nodes (traders + quests) in minX calculation so traders don't end up negative\n  if (allNodes.length > 0) {\n    const minX = Math.min(...allNodes.map((n) => n.position.x));\n    const minY = Math.min(...allNodes.map((n) => n.position.y));\n\n    // Normalize all nodes\n    const normalizedNodes = allNodes.map((node) => ({\n      ...node,\n      position: {\n        x: node.position.x - minX + LAYOUT_CONFIG.marginx,\n        y: node.position.y - minY + LAYOUT_CONFIG.marginy,\n      },\n    }));\n\n    return { nodes: normalizedNodes, edges: allEdges, laneYOffsets };\n  }\n\n  return { nodes: allNodes, edges: allEdges, laneYOffsets };\n}\n\n/**\n * Build cross-trader dependency edges\n */\nexport function buildCrossTraderEdges(\n  groups: Map<string, TraderQuestGroup>,\n  options: { focusChain?: Set<string>; hasFocusMode: boolean }\n): Edge[] {\n  const { focusChain, hasFocusMode } = options;\n  const crossEdges: Edge[] = [];\n  const seenEdges = new Set<string>();\n\n  for (const group of groups.values()) {\n    for (const dep of group.crossTraderDeps) {\n      // Only add edge once (from source side)\n      if (dep.sourceTraderId !== group.traderId) continue;\n\n      const edgeId = `cross-${dep.sourceQuestId}-${dep.targetQuestId}`;\n      if (seenEdges.has(edgeId)) continue;\n      seenEdges.add(edgeId);\n\n      const isInFocusChain =\n        focusChain?.has(dep.sourceQuestId) &&\n        focusChain?.has(dep.targetQuestId);\n      const shouldDim = hasFocusMode && !isInFocusChain;\n\n      crossEdges.push({\n        id: edgeId,\n        source: dep.sourceQuestId,\n        target: dep.targetQuestId,\n        type: \"smoothstep\",\n        animated: false,\n        style: {\n          stroke: shouldDim ? \"#E5E7EB\" : \"#9CA3AF\",\n          strokeWidth: 1.5,\n          strokeDasharray: \"6,4\",\n          opacity: shouldDim ? 0.4 : 0.7,\n        },\n        data: {\n          isCrossTrader: true,\n          sourceTraderId: dep.sourceTraderId,\n          targetTraderId: dep.targetTraderId,\n        },\n      });\n    }\n  }\n\n  return crossEdges;\n}\n\nexport interface TraderLaneGraph {\n  nodes: Array<QuestNode | TraderNode>;\n  edges: Array<QuestEdge | Edge>;\n  laneYOffsets: Map<string, { y: number; height: number }>;\n  traderOrder: string[];\n}\n\n/**\n * Main function to build the trader lane graph\n * @param quests - Filtered quests to display\n * @param allQuests - All quests (unfiltered) for accurate global depth calculation\n * @param traders - Trader data\n * @param options - Build options\n */\nexport function buildTraderLaneGraph(\n  quests: QuestWithProgress[],\n  allQuests: QuestWithProgress[],\n  traders: Trader[],\n  options: BuildQuestGraphOptions\n): TraderLaneGraph {\n  const { maxColumns } = options;\n\n  // Step 1: Calculate global depths using ALL quests (not just filtered)\n  // This ensures cross-trader dependencies are correctly positioned even when filtered\n  const globalDepths = calculateGlobalDepths(allQuests);\n\n  // Step 2: Split quests by trader\n  const groups = splitQuestsByTrader(quests);\n\n  // Step 2.5: Apply column-based filtering if maxColumns is set\n  // Use global depths so cross-trader dependencies are correctly accounted for\n  if (maxColumns !== null && maxColumns !== undefined) {\n    for (const [traderId, group] of groups) {\n      const filteredQuests = filterQuestsByColumns(\n        quests,\n        traderId,\n        maxColumns,\n        globalDepths // Pass global depths to properly filter cross-trader quests\n      );\n\n      // Update group with filtered quests\n      group.quests = filteredQuests;\n\n      // Recalculate root quests and dependencies for filtered set\n      const filteredIds = new Set(filteredQuests.map((q) => q.id));\n\n      // Filter intra-trader deps to only include edges where both quests are visible\n      group.intraTraderDeps = group.intraTraderDeps.filter(\n        (dep) => filteredIds.has(dep.sourceId) && filteredIds.has(dep.targetId)\n      );\n\n      // Recalculate root quests (no intra-trader deps pointing to them)\n      const hasIncomingDep = new Set(\n        group.intraTraderDeps.map((d) => d.targetId)\n      );\n      group.rootQuests = filteredQuests.filter(\n        (q) => !hasIncomingDep.has(q.id)\n      );\n\n      // Filter cross-trader deps to only include visible quests\n      group.crossTraderDeps = group.crossTraderDeps.filter(\n        (dep) =>\n          filteredIds.has(dep.sourceQuestId) ||\n          filteredIds.has(dep.targetQuestId)\n      );\n    }\n  }\n\n  // Step 3: Compute trader order\n  const traderOrder = computeTraderOrder(groups);\n\n  // Step 4: Layout each trader lane (with global depths for cross-trader positioning)\n  const laneLayouts: TraderLaneLayout[] = [];\n  for (const traderId of traderOrder) {\n    const group = groups.get(traderId);\n    if (group && group.quests.length > 0) {\n      laneLayouts.push(layoutTraderLane(group, options, globalDepths));\n    }\n  }\n\n  // Step 5: Stack lanes vertically\n  const stackedLayout = stackTraderLanes(laneLayouts, traderOrder, groups);\n\n  // Note: Cross-trader edges removed - they create confusing long paths.\n  // Cross-trader dependencies are shown via badges on QuestNode instead.\n\n  return {\n    nodes: stackedLayout.nodes,\n    edges: stackedLayout.edges,\n    laneYOffsets: stackedLayout.laneYOffsets,\n    traderOrder,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1569, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/TraderNode.tsx"],"sourcesContent":["\"use client\";\n\nimport { memo } from \"react\";\nimport type { NodeProps } from \"@xyflow/react\";\nimport { cn } from \"@/lib/utils\";\nimport type { TraderNode as TraderNodeType } from \"@/types\";\nimport { LANE_CONFIG } from \"@/lib/quest-layout\";\n\nfunction TraderNodeComponent({ data }: NodeProps<TraderNodeType>) {\n  const { traderName, color, questCount, completedCount, laneHeight } = data;\n\n  // Use lane height if provided, otherwise fall back to default\n  const nodeHeight = laneHeight || LANE_CONFIG.TRADER_NODE_HEIGHT;\n\n  return (\n    <>\n      <div\n        className={cn(\n          \"rounded border flex items-center justify-center\",\n          \"shadow-md font-medium bg-background\"\n        )}\n        style={{\n          width: LANE_CONFIG.TRADER_NODE_WIDTH,\n          height: nodeHeight,\n          borderColor: color,\n        }}\n      >\n        {/* Vertical text container */}\n        <div\n          className=\"flex flex-col items-center justify-center gap-1\"\n          style={{\n            writingMode: \"vertical-rl\",\n            textOrientation: \"mixed\",\n            transform: \"rotate(180deg)\",\n          }}\n        >\n          {/* Trader Name */}\n          <span className=\"font-bold text-xs\" style={{ color }}>\n            {traderName}\n          </span>\n\n          {/* Quest Progress Count */}\n          <span className=\"text-[10px] text-muted-foreground\">\n            {completedCount}/{questCount}\n          </span>\n        </div>\n      </div>\n      {/* No Handle needed - trader nodes don't connect via edges to quest nodes */}\n    </>\n  );\n}\n\nexport const TraderNode = memo(TraderNodeComponent);\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAEA;AANA;;;;;AAQA,SAAS,oBAAoB,EAAE,IAAI,EAA6B;IAC9D,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE,cAAc,EAAE,UAAU,EAAE,GAAG;IAEtE,8DAA8D;IAC9D,MAAM,aAAa,cAAc,2JAAW,CAAC,kBAAkB;IAE/D,qBACE;kBACE,cAAA,6VAAC;YACC,WAAW,IAAA,wIAAE,EACX,mDACA;YAEF,OAAO;gBACL,OAAO,2JAAW,CAAC,iBAAiB;gBACpC,QAAQ;gBACR,aAAa;YACf;sBAGA,cAAA,6VAAC;gBACC,WAAU;gBACV,OAAO;oBACL,aAAa;oBACb,iBAAiB;oBACjB,WAAW;gBACb;;kCAGA,6VAAC;wBAAK,WAAU;wBAAoB,OAAO;4BAAE;wBAAM;kCAChD;;;;;;kCAIH,6VAAC;wBAAK,WAAU;;4BACb;4BAAe;4BAAE;;;;;;;;;;;;;;;;;;;AAO9B;AAEO,MAAM,2BAAa,IAAA,4TAAI,EAAC"}},
    {"offset": {"line": 1643, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/hooks/useIsMobile.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\n/**\n * Hook to detect mobile viewport (width < 768px).\n * Uses Tailwind's md breakpoint as the threshold.\n *\n * Returns `null` during SSR/hydration to prevent hydration mismatch,\n * then resolves to boolean after client-side hydration.\n */\nexport function useIsMobile(): boolean {\n  const [isMobile, setIsMobile] = useState(false);\n\n  useEffect(() => {\n    const checkMobile = () => setIsMobile(window.innerWidth < 768);\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  return isMobile;\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAWO,SAAS;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gUAAQ,EAAC;IAEzC,IAAA,iUAAS,EAAC;QACR,MAAM,cAAc,IAAM,YAAY,OAAO,UAAU,GAAG;QAC1D;QACA,OAAO,gBAAgB,CAAC,UAAU;QAClC,OAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;IACpD,GAAG,EAAE;IAEL,OAAO;AACT"}},
    {"offset": {"line": 1664, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/QuestTree.tsx"],"sourcesContent":["// @ts-nocheck - React 19 ReactFlow component type compatibility\n\"use client\";\n\nimport { useCallback, useMemo, useState, useEffect, useRef } from \"react\";\nimport {\n  ReactFlow,\n  Controls,\n  MiniMap,\n  Background,\n  BackgroundVariant,\n  useNodesState,\n  useEdgesState,\n  useReactFlow,\n  type NodeTypes,\n  type Node,\n  ReactFlowProvider,\n} from \"@xyflow/react\";\nimport \"@xyflow/react/dist/style.css\";\n\nimport { Keyboard } from \"lucide-react\";\nimport { QuestNode, QUEST_NODE_WIDTH, QUEST_NODE_HEIGHT } from \"./QuestNode\";\nimport { TraderNode } from \"./TraderNode\";\nimport { buildTraderLaneGraph, getQuestChain } from \"@/lib/quest-layout\";\nimport { getTraderColor } from \"@/lib/trader-colors\";\nimport { useIsMobile } from \"@/hooks/useIsMobile\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport type {\n  QuestWithProgress,\n  QuestStatus,\n  QuestNodeData,\n  Trader,\n} from \"@/types\";\n\n// Register custom node types\nconst nodeTypes: NodeTypes = {\n  quest: QuestNode,\n  trader: TraderNode,\n};\n\ninterface QuestTreeProps {\n  quests: QuestWithProgress[];\n  allQuests: QuestWithProgress[]; // All quests (unfiltered) for accurate depth calculation\n  traders: Trader[];\n  selectedQuestId?: string | null;\n  playerLevel?: number | null;\n  maxColumns?: number | null; // Limit number of columns (depth) shown per trader\n  savingQuestIds?: Set<string>; // Set of quest IDs currently being saved\n  onQuestSelect: (questId: string) => void;\n  onStatusChange: (questId: string, status: QuestStatus) => void;\n  onQuestDetails?: (questId: string) => void; // Open quest details modal\n}\n\nfunction QuestTreeInner({\n  quests,\n  allQuests,\n  traders,\n  selectedQuestId,\n  playerLevel,\n  maxColumns,\n  savingQuestIds,\n  onQuestSelect,\n  onStatusChange,\n  onQuestDetails,\n}: QuestTreeProps) {\n  const isMobile = useIsMobile();\n  const { fitView, setViewport, getViewport } = useReactFlow();\n  const isInitializedRef = useRef(false);\n  // Ref to access current nodes without causing effect re-runs\n  const nodesRef = useRef<Node[]>([]);\n  // Ref for container to attach custom wheel handler\n  const containerRef = useRef<HTMLDivElement>(null);\n  // Ref to store translate extent for use in wheel handler\n  const translateExtentRef = useRef<\n    [[number, number], [number, number]] | undefined\n  >(undefined);\n\n  // Focus mode state\n  const [focusedQuestId, setFocusedQuestId] = useState<string | null>(null);\n\n  // Keyboard navigation state - tracks currently keyboard-selected node\n  const [keyboardSelectedId, setKeyboardSelectedId] = useState<string | null>(\n    null\n  );\n\n  // Calculate focus chain when focused quest changes\n  // Use allQuests to include cross-trader dependencies in the chain\n  const focusChain = useMemo(() => {\n    if (!focusedQuestId) return undefined;\n    return getQuestChain(focusedQuestId, allQuests);\n  }, [focusedQuestId, allQuests]);\n\n  // Handle focus on a quest\n  const handleFocus = useCallback((questId: string) => {\n    // Toggle focus if same quest, otherwise focus on new quest\n    setFocusedQuestId((prev) => (prev === questId ? null : questId));\n  }, []);\n\n  // Build graph with layout\n  const { initialNodes, initialEdges } = useMemo(() => {\n    const graph = buildTraderLaneGraph(quests, allQuests, traders, {\n      onStatusChange,\n      onClick: onQuestSelect,\n      onFocus: handleFocus,\n      onDetails: onQuestDetails,\n      selectedQuestId,\n      focusedQuestId,\n      focusChain,\n      playerLevel,\n      maxColumns,\n      savingQuestIds,\n      keyboardSelectedId,\n    });\n    return {\n      initialNodes: graph.nodes,\n      initialEdges: graph.edges,\n    };\n  }, [\n    quests,\n    allQuests,\n    traders,\n    selectedQuestId,\n    playerLevel,\n    maxColumns,\n    savingQuestIds,\n    focusedQuestId,\n    focusChain,\n    onStatusChange,\n    onQuestSelect,\n    handleFocus,\n    onQuestDetails,\n    keyboardSelectedId,\n  ]);\n\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n\n  // Update nodes when quests or selection changes\n  useEffect(() => {\n    setNodes(initialNodes);\n    setEdges(initialEdges);\n  }, [initialNodes, initialEdges, setNodes, setEdges]);\n\n  // Keep nodesRef in sync with nodes for use in effects that shouldn't re-run on node changes\n  useEffect(() => {\n    nodesRef.current = nodes;\n  }, [nodes]);\n\n  // Get quest nodes only (excluding trader nodes) for keyboard navigation\n  const questNodes = useMemo(() => {\n    return nodes.filter((n) => n.type === \"quest\");\n  }, [nodes]);\n\n  // Find nearest node in a direction for keyboard navigation\n  const findNearestNode = useCallback(\n    (\n      currentId: string,\n      direction: \"up\" | \"down\" | \"left\" | \"right\"\n    ): string | null => {\n      const currentNode = questNodes.find((n) => n.id === currentId);\n      if (!currentNode) return questNodes[0]?.id || null;\n\n      const { x: cx, y: cy } = currentNode.position;\n\n      // Filter nodes in the desired direction\n      const candidates = questNodes.filter((n) => {\n        if (n.id === currentId) return false;\n        const { x, y } = n.position;\n        switch (direction) {\n          case \"up\":\n            return y < cy;\n          case \"down\":\n            return y > cy;\n          case \"left\":\n            return x < cx;\n          case \"right\":\n            return x > cx;\n        }\n      });\n\n      if (candidates.length === 0) return null;\n\n      // Find the closest node in that direction\n      // Weight the primary direction more heavily\n      const getDistance = (node: Node) => {\n        const dx = Math.abs(node.position.x - cx);\n        const dy = Math.abs(node.position.y - cy);\n        // Primary direction weighted more\n        if (direction === \"up\" || direction === \"down\") {\n          return dy + dx * 0.5;\n        }\n        return dx + dy * 0.5;\n      };\n\n      candidates.sort((a, b) => getDistance(a) - getDistance(b));\n      return candidates[0]?.id || null;\n    },\n    [questNodes]\n  );\n\n  // Handle keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Don't handle if user is typing in an input\n      const target = e.target as HTMLElement;\n      if (\n        target.tagName === \"INPUT\" ||\n        target.tagName === \"TEXTAREA\" ||\n        target.isContentEditable\n      ) {\n        return;\n      }\n\n      // ESC exits focus mode\n      if (e.key === \"Escape\") {\n        if (focusedQuestId) {\n          setFocusedQuestId(null);\n        } else if (keyboardSelectedId) {\n          setKeyboardSelectedId(null);\n        }\n        return;\n      }\n\n      // Arrow keys for navigation\n      if ([\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(e.key)) {\n        e.preventDefault();\n\n        // If no node selected, select the first quest node\n        if (!keyboardSelectedId) {\n          const firstQuest = questNodes[0];\n          if (firstQuest) {\n            setKeyboardSelectedId(firstQuest.id);\n          }\n          return;\n        }\n\n        const direction = e.key.replace(\"Arrow\", \"\").toLowerCase() as\n          | \"up\"\n          | \"down\"\n          | \"left\"\n          | \"right\";\n        const nextId = findNearestNode(keyboardSelectedId, direction);\n        if (nextId) {\n          setKeyboardSelectedId(nextId);\n          // Center view on the selected node\n          const node = nodesRef.current.find((n) => n.id === nextId);\n          if (node) {\n            fitView({\n              nodes: [node],\n              duration: 150,\n              padding: 0.5,\n              maxZoom: 1.5,\n            });\n          }\n        }\n        return;\n      }\n\n      // Only handle action keys if a node is selected\n      if (!keyboardSelectedId) return;\n\n      const selectedNode = nodesRef.current.find(\n        (n) => n.id === keyboardSelectedId\n      );\n      const data = selectedNode?.data as QuestNodeData | undefined;\n      if (!data?.quest) return;\n\n      // Enter: Toggle quest status\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        onStatusChange(data.quest.id, data.quest.computedStatus);\n        return;\n      }\n\n      // Space: Open quest details\n      if (e.key === \" \") {\n        e.preventDefault();\n        if (onQuestDetails) {\n          onQuestDetails(data.quest.id);\n        }\n        return;\n      }\n\n      // F: Enter focus mode on selected quest\n      if (e.key === \"f\" || e.key === \"F\") {\n        e.preventDefault();\n        handleFocus(data.quest.id);\n        return;\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [\n    focusedQuestId,\n    keyboardSelectedId,\n    questNodes,\n    findNearestNode,\n    onStatusChange,\n    onQuestDetails,\n    handleFocus,\n    fitView,\n  ]);\n\n  // Set initial viewport to center content with appropriate zoom when React Flow is ready\n  // Uses nodesRef to avoid callback recreation on every nodes change\n  const onInit = useCallback(() => {\n    if (!isInitializedRef.current && nodesRef.current.length > 0) {\n      // First: fit all content to center it properly\n      fitView({ padding: 0.1, duration: 0 });\n\n      // Then: zoom in by 50% after fitView completes\n      // Use setTimeout because fitView updates viewport asynchronously\n      setTimeout(() => {\n        const { x, y, zoom } = getViewport();\n        setViewport({ x, y, zoom: zoom * 1.5 }, { duration: 0 });\n      }, 50);\n\n      isInitializedRef.current = true;\n    }\n  }, [fitView, getViewport, setViewport]);\n\n  // Calculate bounds to constrain panning - include ALL nodes (traders + quests)\n  const translateExtent = useMemo(() => {\n    if (nodes.length === 0) {\n      return undefined;\n    }\n\n    const padding = 50; // Padding around all nodes\n\n    // Use ALL nodes for bounds calculation so traders are included\n    const minX = Math.min(...nodes.map((n) => n.position.x)) - padding;\n    const minY = Math.min(...nodes.map((n) => n.position.y)) - padding;\n    const maxX =\n      Math.max(...nodes.map((n) => n.position.x + QUEST_NODE_WIDTH)) + padding;\n    const maxY =\n      Math.max(...nodes.map((n) => n.position.y + QUEST_NODE_HEIGHT)) + padding;\n\n    return [\n      [minX, minY],\n      [maxX, maxY],\n    ] as [[number, number], [number, number]];\n  }, [nodes]);\n\n  // Sync translateExtent to ref for use in wheel handler (must be in effect, not render)\n  useEffect(() => {\n    translateExtentRef.current = translateExtent;\n  }, [translateExtent]);\n\n  // Center on focused quest when focus changes\n  // Uses nodesRef to avoid re-centering when nodes update while already focused\n  useEffect(() => {\n    if (focusedQuestId) {\n      const focusedNode = nodesRef.current.find((n) => n.id === focusedQuestId);\n      if (focusedNode) {\n        fitView({\n          nodes: [focusedNode],\n          duration: 300,\n          padding: 0.5,\n          maxZoom: 1,\n        });\n      }\n    }\n  }, [focusedQuestId, fitView]);\n\n  // Custom wheel handler for vertical-only scrolling with bounds clamping\n  // React Flow's panOnScrollMode doesn't reliably prevent horizontal movement on all devices\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleWheel = (e: WheelEvent) => {\n      // Only handle scroll events, not pinch-to-zoom (which has ctrlKey)\n      if (e.ctrlKey) return;\n\n      e.preventDefault();\n\n      const { x, y, zoom } = getViewport();\n      // Only use deltaY for vertical scrolling, ignore deltaX completely\n      const panSpeed = 0.8;\n      let newY = y - e.deltaY * panSpeed;\n\n      // Clamp to translateExtent bounds if available\n      const extent = translateExtentRef.current;\n      if (extent) {\n        const [[, minY], [, maxY]] = extent;\n        const viewportHeight = container.clientHeight;\n\n        // Calculate valid viewport.y range:\n        // - maxViewportY: can't scroll higher than top of content\n        // - minViewportY: can't scroll lower than bottom of content\n        const maxViewportY = -minY * zoom;\n        const minViewportY = viewportHeight - maxY * zoom;\n\n        // Clamp newY within valid range\n        newY = Math.max(minViewportY, Math.min(maxViewportY, newY));\n      }\n\n      setViewport({ x, y: newY, zoom }, { duration: 0 });\n    };\n\n    container.addEventListener(\"wheel\", handleWheel, { passive: false });\n    return () => container.removeEventListener(\"wheel\", handleWheel);\n  }, [getViewport, setViewport]);\n\n  // Handle background click to exit focus mode\n  const handlePaneClick = useCallback(() => {\n    if (focusedQuestId) {\n      setFocusedQuestId(null);\n    }\n  }, [focusedQuestId]);\n\n  // Handle node click for status change\n  const handleNodeClick = useCallback(\n    (_event: React.MouseEvent, node: { data?: unknown }) => {\n      // Only handle quest nodes, not trader nodes\n      const data = node.data as QuestNodeData | undefined;\n      if (data?.quest) {\n        const quest = data.quest;\n        // Call status change handler\n        onStatusChange(quest.id, quest.computedStatus);\n      }\n    },\n    [onStatusChange]\n  );\n\n  // Handle node double-click for focus mode\n  const handleNodeDoubleClick = useCallback(\n    (_event: React.MouseEvent, node: { data?: unknown }) => {\n      // Only handle quest nodes, not trader nodes\n      const data = node.data as QuestNodeData | undefined;\n      if (data?.quest) {\n        handleFocus(data.quest.id);\n      }\n    },\n    [handleFocus]\n  );\n\n  // MiniMap node color based on trader\n  const getNodeColor = useCallback(\n    (node: { data: Record<string, unknown> }) => {\n      const data = node.data as QuestNodeData | undefined;\n      if (data?.quest) {\n        return getTraderColor(data.quest.traderId).primary;\n      }\n      return \"#636363\";\n    },\n    []\n  );\n\n  return (\n    <div ref={containerRef} className=\"w-full h-full touch-pan-y relative\">\n      {/* Top action bar */}\n      <div className=\"absolute top-2 left-2 z-10 flex items-center gap-2\">\n        {/* Focus mode indicator */}\n        {focusedQuestId && (\n          <div\n            className=\"text-xs px-3 py-1.5 rounded-full shadow-md flex items-center gap-2\"\n            style={{ backgroundColor: \"#9a8866\", color: \"#1b1919\" }}\n          >\n            <span>Focus Mode</span>\n            <button\n              onClick={() => setFocusedQuestId(null)}\n              className=\"rounded-full p-0.5 hover:opacity-80\"\n              title=\"Exit focus mode (ESC)\"\n            >\n              <svg\n                className=\"w-3 h-3\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                stroke=\"currentColor\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M6 18L18 6M6 6l12 12\"\n                />\n              </svg>\n            </button>\n          </div>\n        )}\n      </div>\n      {/* Keyboard shortcuts help - top right, hidden on mobile */}\n      {!isMobile && (\n        <div className=\"absolute top-2 right-2 z-10\">\n          <Tooltip delayDuration={200}>\n            <TooltipTrigger asChild>\n              <button\n                className=\"p-2 rounded-md bg-background/80 border border-border shadow-sm hover:bg-background transition-colors\"\n                aria-label=\"Keyboard shortcuts\"\n              >\n                <Keyboard className=\"w-4 h-4 text-muted-foreground\" />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent side=\"left\" align=\"start\" className=\"max-w-xs\">\n              <div className=\"space-y-2 text-xs\">\n                <p className=\"font-semibold text-foreground\">\n                  Keyboard Shortcuts\n                </p>\n                <div className=\"space-y-1 text-muted-foreground\">\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Navigate quests</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      Arrow keys\n                    </kbd>\n                  </div>\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Toggle status</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      Enter\n                    </kbd>\n                  </div>\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Quest details</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      Space\n                    </kbd>\n                  </div>\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Focus mode</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      F\n                    </kbd>\n                  </div>\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Search quests</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      /\n                    </kbd>\n                  </div>\n                  <div className=\"flex justify-between gap-4\">\n                    <span>Exit / Clear</span>\n                    <kbd className=\"px-1.5 py-0.5 bg-muted rounded text-[10px] font-mono\">\n                      Esc\n                    </kbd>\n                  </div>\n                </div>\n              </div>\n            </TooltipContent>\n          </Tooltip>\n        </div>\n      )}\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        onNodesChange={onNodesChange}\n        onEdgesChange={onEdgesChange}\n        onPaneClick={handlePaneClick}\n        onNodeClick={handleNodeClick}\n        onNodeDoubleClick={handleNodeDoubleClick}\n        onInit={onInit}\n        nodeTypes={nodeTypes}\n        nodesDraggable={false}\n        nodesConnectable={false}\n        elementsSelectable={false}\n        defaultViewport={{ x: 0, y: 0, zoom: 1 }}\n        translateExtent={translateExtent}\n        minZoom={0.1}\n        maxZoom={isMobile ? 2 : 4}\n        defaultEdgeOptions={{\n          type: \"default\", // Bezier curves\n        }}\n        proOptions={{ hideAttribution: true }}\n        panOnScroll={false}\n        zoomOnScroll={false}\n        panOnDrag={[1, 2]}\n        zoomOnPinch={true}\n        zoomOnDoubleClick={false}\n      >\n        <Controls\n          showInteractive={false}\n          className=\"!shadow-md\"\n          position={isMobile ? \"bottom-left\" : \"bottom-left\"}\n        />\n        {/* Solid dark background for contrast */}\n        <Background\n          variant={BackgroundVariant.Dots}\n          gap={100}\n          size={0}\n          color=\"transparent\"\n          style={{ backgroundColor: \"#1e1e20\" }}\n        />\n        {/* Hide MiniMap on mobile for more screen space */}\n        {!isMobile && (\n          <MiniMap\n            nodeColor={getNodeColor}\n            nodeStrokeWidth={3}\n            zoomable\n            pannable\n            className=\"!bg-background/80 !border-border\"\n          />\n        )}\n      </ReactFlow>\n    </div>\n  );\n}\n\n// Wrapper component that provides ReactFlowProvider\nexport function QuestTree(props: QuestTreeProps) {\n  return (\n    <ReactFlowProvider>\n      <QuestTreeInner {...props} />\n    </ReactFlowProvider>\n  );\n}\n\nexport default QuestTree;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2449, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\";\nimport { cn } from \"@/lib/utils\";\n\nconst Progress = React.forwardRef<\n  React.ComponentRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root> & {\n    indicatorClassName?: string;\n  }\n>(({ className, value, indicatorClassName, style, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className={cn(\n        \"h-full w-full flex-1 transition-all\",\n        indicatorClassName || \"bg-primary\"\n      )}\n      style={{\n        transform: `translateX(-${100 - (value || 0)}%)`,\n        backgroundColor: style?.[\"--progress-color\" as keyof typeof style] as\n          | string\n          | undefined,\n      }}\n    />\n  </ProgressPrimitive.Root>\n));\nProgress.displayName = ProgressPrimitive.Root.displayName;\n\nexport { Progress };\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,MAAM,yBAAW,kUAAgB,CAK/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,kBAAkB,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBAC5D,6VAAC,sRAAsB;QACrB,KAAK;QACL,WAAW,IAAA,wIAAE,EACX,kEACA;QAED,GAAG,KAAK;kBAET,cAAA,6VAAC,2RAA2B;YAC1B,WAAW,IAAA,wIAAE,EACX,uCACA,sBAAsB;YAExB,OAAO;gBACL,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;gBAChD,iBAAiB,OAAO,CAAC,mBAAyC;YAGpE;;;;;;;;;;;AAIN,SAAS,WAAW,GAAG,sRAAsB,CAAC,WAAW"}},
    {"offset": {"line": 2488, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/popover.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction Popover({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Root>) {\n  return <PopoverPrimitive.Root data-slot=\"popover\" {...props} />;\n}\n\nfunction PopoverTrigger({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {\n  return <PopoverPrimitive.Trigger data-slot=\"popover-trigger\" {...props} />;\n}\n\nfunction PopoverAnchor({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {\n  return <PopoverPrimitive.Anchor data-slot=\"popover-anchor\" {...props} />;\n}\n\nfunction PopoverContent({\n  className,\n  align = \"center\",\n  sideOffset = 4,\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Content>) {\n  return (\n    <PopoverPrimitive.Portal>\n      <PopoverPrimitive.Content\n        data-slot=\"popover-content\"\n        align={align}\n        sideOffset={sideOffset}\n        className={cn(\n          // Refactoring UI: Popovers use elevation-lg for floating panels\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-elevation-lg outline-none\",\n          className\n        )}\n        {...props}\n      />\n    </PopoverPrimitive.Portal>\n  );\n}\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,QAAQ,EACf,GAAG,OACgD;IACnD,qBAAO,6VAAC,qRAAqB;QAAC,aAAU;QAAW,GAAG,KAAK;;;;;;AAC7D;AAEA,SAAS,eAAe,EACtB,GAAG,OACmD;IACtD,qBAAO,6VAAC,wRAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;AAEA,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6VAAC,uRAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;AAEA,SAAS,eAAe,EACtB,SAAS,EACT,QAAQ,QAAQ,EAChB,aAAa,CAAC,EACd,GAAG,OACmD;IACtD,qBACE,6VAAC,uRAAuB;kBACtB,cAAA,6VAAC,wRAAwB;YACvB,aAAU;YACV,OAAO;YACP,YAAY;YACZ,WAAW,IAAA,wIAAE,EACX,gEAAgE;YAChE,wbACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIjB"}},
    {"offset": {"line": 2560, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/progress-stats/ProgressStats.tsx"],"sourcesContent":["// @ts-nocheck - React 19 Progress component type compatibility\n\"use client\";\n\nimport { useMemo } from \"react\";\nimport { ChevronDown, Star, Trophy, Target } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { getTraderColor } from \"@/lib/trader-colors\";\nimport type { QuestWithProgress, Trader } from \"@/types\";\n\ninterface ProgressStatsProps {\n  quests: QuestWithProgress[];\n  traders: Trader[];\n}\n\ninterface TraderStats {\n  traderId: string;\n  traderName: string;\n  total: number;\n  completed: number;\n  available: number;\n  locked: number;\n  percentage: number;\n}\n\nexport function ProgressStats({ quests, traders }: ProgressStatsProps) {\n  // Calculate overall stats\n  const overallStats = useMemo(() => {\n    const total = quests.length;\n    const completed = quests.filter(\n      (q) => q.computedStatus === \"completed\"\n    ).length;\n    const available = quests.filter(\n      (q) => q.computedStatus === \"available\"\n    ).length;\n    const locked = quests.filter((q) => q.computedStatus === \"locked\").length;\n\n    return {\n      total,\n      completed,\n      available,\n      locked,\n      percentage: total > 0 ? Math.round((completed / total) * 100) : 0,\n    };\n  }, [quests]);\n\n  // Calculate Kappa stats\n  const kappaStats = useMemo(() => {\n    const kappaQuests = quests.filter((q) => q.kappaRequired);\n    const total = kappaQuests.length;\n    const completed = kappaQuests.filter(\n      (q) => q.computedStatus === \"completed\"\n    ).length;\n    const available = kappaQuests.filter(\n      (q) => q.computedStatus === \"available\"\n    ).length;\n\n    return {\n      total,\n      completed,\n      available,\n      remaining: total - completed,\n      percentage: total > 0 ? Math.round((completed / total) * 100) : 0,\n    };\n  }, [quests]);\n\n  // Calculate per-trader stats\n  const traderStats = useMemo(() => {\n    const stats: TraderStats[] = [];\n\n    for (const trader of traders) {\n      const traderQuests = quests.filter((q) => q.traderId === trader.id);\n      const total = traderQuests.length;\n      const completed = traderQuests.filter(\n        (q) => q.computedStatus === \"completed\"\n      ).length;\n      const available = traderQuests.filter(\n        (q) => q.computedStatus === \"available\"\n      ).length;\n      const locked = traderQuests.filter(\n        (q) => q.computedStatus === \"locked\"\n      ).length;\n\n      if (total > 0) {\n        stats.push({\n          traderId: trader.id,\n          traderName: trader.name,\n          total,\n          completed,\n          available,\n          locked,\n          percentage: Math.round((completed / total) * 100),\n        });\n      }\n    }\n\n    // Sort by completion percentage (descending)\n    return stats.sort((a, b) => b.percentage - a.percentage);\n  }, [quests, traders]);\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <button className=\"flex items-center gap-2 px-3 py-1.5 rounded-md bg-background/80 border border-border hover:bg-muted transition-colors text-sm\">\n          <Trophy className=\"w-4 h-4 text-[#d4a574]\" />\n          <span className=\"font-medium\">{overallStats.percentage}%</span>\n          <ChevronDown className=\"w-3 h-3 text-muted-foreground\" />\n        </button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 p-0\" align=\"start\">\n        <div className=\"p-4 space-y-4\">\n          {/* Overall Progress */}\n          <div>\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"flex items-center gap-2\">\n                <Target className=\"w-4 h-4 text-[#0292c0]\" />\n                <span className=\"font-medium text-sm\">Overall Progress</span>\n              </div>\n              <span className=\"text-sm text-muted-foreground\">\n                {overallStats.completed}/{overallStats.total}\n              </span>\n            </div>\n            <Progress\n              value={overallStats.percentage}\n              className=\"h-2\"\n              indicatorClassName=\"bg-[#00a700]\"\n            />\n            <div className=\"flex justify-between mt-1.5 text-xs text-muted-foreground\">\n              <span className=\"flex items-center gap-1\">\n                <span\n                  className=\"w-2 h-2 rounded-full\"\n                  style={{ backgroundColor: \"#00a700\" }}\n                />\n                {overallStats.completed} done\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <span\n                  className=\"w-2 h-2 rounded-full\"\n                  style={{ backgroundColor: \"#0292c0\" }}\n                />\n                {overallStats.available} available\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <span\n                  className=\"w-2 h-2 rounded-full\"\n                  style={{ backgroundColor: \"#636363\" }}\n                />\n                {overallStats.locked} locked\n              </span>\n            </div>\n          </div>\n\n          {/* Kappa Progress */}\n          <div className=\"pt-2 border-t\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"flex items-center gap-2\">\n                <Star className=\"w-4 h-4 text-yellow-500 fill-yellow-500\" />\n                <span className=\"font-medium text-sm\">Kappa Container</span>\n              </div>\n              <span className=\"text-sm text-muted-foreground\">\n                {kappaStats.completed}/{kappaStats.total}\n              </span>\n            </div>\n            <Progress\n              value={kappaStats.percentage}\n              className=\"h-2\"\n              indicatorClassName=\"bg-yellow-500\"\n            />\n            <p className=\"mt-1.5 text-xs text-muted-foreground\">\n              {kappaStats.remaining > 0\n                ? `${kappaStats.remaining} Kappa quests remaining`\n                : \"All Kappa quests completed!\"}\n            </p>\n          </div>\n\n          {/* Per-Trader Progress */}\n          <div className=\"pt-2 border-t\">\n            <p className=\"font-medium text-sm mb-3\">By Trader</p>\n            <div className=\"space-y-2.5 max-h-[200px] overflow-y-auto\">\n              {traderStats.map((trader) => {\n                const colors = getTraderColor(trader.traderId);\n                return (\n                  <div key={trader.traderId} className=\"space-y-1\">\n                    <div className=\"flex items-center justify-between text-xs\">\n                      <span\n                        className=\"font-medium\"\n                        style={{ color: colors.primary }}\n                      >\n                        {trader.traderName}\n                      </span>\n                      <span className=\"text-muted-foreground\">\n                        {trader.completed}/{trader.total} ({trader.percentage}%)\n                      </span>\n                    </div>\n                    <Progress\n                      value={trader.percentage}\n                      className=\"h-1.5\"\n                      indicatorClassName=\"transition-all\"\n                      style={\n                        {\n                          \"--progress-color\": colors.primary,\n                        } as React.CSSProperties\n                      }\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\nexport default ProgressStats;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3003, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/progress-stats/index.ts"],"sourcesContent":["export { ProgressStats } from \"./ProgressStats\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 3010, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        data-slot=\"input\"\n        className={cn(\n          // Base styles with inset shadow (Refactoring UI: \"Emulate a light source\")\n          \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground border-input h-9 w-full min-w-0 rounded-md border bg-[var(--bg-elevated)] px-3 py-1 text-base shadow-inset-input transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n          \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nInput.displayName = \"Input\";\n\nexport { Input };\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,kUAAgB,CAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6VAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,2EAA2E;QAC3E,+bACA,iFACA,0GACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 3040, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/label.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport { Label };\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6VAAC,sRAAmB;QAClB,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 3067, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        \"peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={cn(\n          \"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0\"\n        )}\n      />\n    </SwitchPrimitive.Root>\n  );\n}\n\nexport { Switch };\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,6VAAC,uRAAoB;QACnB,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,6VAAC,wRAAqB;YACpB,aAAU;YACV,WAAW,IAAA,wIAAE,EACX;;;;;;;;;;;AAKV"}},
    {"offset": {"line": 3102, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/StatusMultiSelect.tsx"],"sourcesContent":["\"use client\";\n\nimport { ChevronDown, Check } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport type { QuestStatus } from \"@/types\";\n\nconst STATUSES: { value: QuestStatus; label: string; color: string }[] = [\n  { value: \"available\", label: \"Available\", color: \"#0292c0\" },\n  { value: \"completed\", label: \"Completed\", color: \"#00a700\" },\n  { value: \"locked\", label: \"Locked\", color: \"#636363\" },\n];\n\ninterface StatusMultiSelectProps {\n  selectedStatuses: QuestStatus[];\n  onChange: (statuses: QuestStatus[]) => void;\n}\n\nexport function StatusMultiSelect({\n  selectedStatuses,\n  onChange,\n}: StatusMultiSelectProps) {\n  const handleToggle = (status: QuestStatus) => {\n    const newStatuses = selectedStatuses.includes(status)\n      ? selectedStatuses.filter((s) => s !== status)\n      : [...selectedStatuses, status];\n    onChange(newStatuses);\n  };\n\n  const getLabel = () => {\n    if (selectedStatuses.length === 0) return \"All Status\";\n    if (selectedStatuses.length === 1) {\n      return STATUSES.find((s) => s.value === selectedStatuses[0])?.label;\n    }\n    return `Status (${selectedStatuses.length})`;\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"h-9 min-w-[120px] justify-between gap-1\"\n        >\n          <span className=\"truncate\">{getLabel()}</span>\n          <ChevronDown className=\"h-4 w-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[180px] p-2\" align=\"start\">\n        <div className=\"flex flex-col gap-1\">\n          {STATUSES.map((status) => {\n            const isSelected = selectedStatuses.includes(status.value);\n            return (\n              <button\n                key={status.value}\n                type=\"button\"\n                onClick={() => handleToggle(status.value)}\n                className={`flex items-center gap-2 w-full px-2 py-1.5 text-sm rounded transition-colors text-left ${\n                  isSelected\n                    ? \"bg-primary/10 text-foreground\"\n                    : \"hover:bg-muted text-muted-foreground\"\n                }`}\n              >\n                <span\n                  className=\"w-3 h-3 rounded-full shrink-0\"\n                  style={{ backgroundColor: status.color }}\n                />\n                <span className=\"flex-1\">{status.label}</span>\n                {isSelected && (\n                  <Check className=\"h-4 w-4 shrink-0 text-primary\" />\n                )}\n              </button>\n            );\n          })}\n        </div>\n        <div className=\"mt-2 pt-2 border-t\">\n          <button\n            type=\"button\"\n            onClick={() => onChange([])}\n            className=\"w-full px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors\"\n          >\n            Clear selection (show all)\n          </button>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AAJA;;;;;AAWA,MAAM,WAAmE;IACvE;QAAE,OAAO;QAAa,OAAO;QAAa,OAAO;IAAU;IAC3D;QAAE,OAAO;QAAa,OAAO;QAAa,OAAO;IAAU;IAC3D;QAAE,OAAO;QAAU,OAAO;QAAU,OAAO;IAAU;CACtD;AAOM,SAAS,kBAAkB,EAChC,gBAAgB,EAChB,QAAQ,EACe;IACvB,MAAM,eAAe,CAAC;QACpB,MAAM,cAAc,iBAAiB,QAAQ,CAAC,UAC1C,iBAAiB,MAAM,CAAC,CAAC,IAAM,MAAM,UACrC;eAAI;YAAkB;SAAO;QACjC,SAAS;IACX;IAEA,MAAM,WAAW;QACf,IAAI,iBAAiB,MAAM,KAAK,GAAG,OAAO;QAC1C,IAAI,iBAAiB,MAAM,KAAK,GAAG;YACjC,OAAO,SAAS,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,gBAAgB,CAAC,EAAE,GAAG;QAChE;QACA,OAAO,CAAC,QAAQ,EAAE,iBAAiB,MAAM,CAAC,CAAC,CAAC;IAC9C;IAEA,qBACE,6VAAC,6JAAO;;0BACN,6VAAC,oKAAc;gBAAC,OAAO;0BACrB,cAAA,6VAAC,2JAAM;oBACL,SAAQ;oBACR,MAAK;oBACL,WAAU;;sCAEV,6VAAC;4BAAK,WAAU;sCAAY;;;;;;sCAC5B,6VAAC,uTAAW;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAG3B,6VAAC,oKAAc;gBAAC,WAAU;gBAAgB,OAAM;;kCAC9C,6VAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC;4BACb,MAAM,aAAa,iBAAiB,QAAQ,CAAC,OAAO,KAAK;4BACzD,qBACE,6VAAC;gCAEC,MAAK;gCACL,SAAS,IAAM,aAAa,OAAO,KAAK;gCACxC,WAAW,CAAC,uFAAuF,EACjG,aACI,kCACA,wCACJ;;kDAEF,6VAAC;wCACC,WAAU;wCACV,OAAO;4CAAE,iBAAiB,OAAO,KAAK;wCAAC;;;;;;kDAEzC,6VAAC;wCAAK,WAAU;kDAAU,OAAO,KAAK;;;;;;oCACrC,4BACC,6VAAC,iSAAK;wCAAC,WAAU;;;;;;;+BAfd,OAAO,KAAK;;;;;wBAmBvB;;;;;;kCAEF,6VAAC;wBAAI,WAAU;kCACb,cAAA,6VAAC;4BACC,MAAK;4BACL,SAAS,IAAM,SAAS,EAAE;4BAC1B,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 3267, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/ActiveFilterChips.tsx"],"sourcesContent":["\"use client\";\n\nimport { X } from \"lucide-react\";\nimport type { QuestFilters, QuestStatus } from \"@/types\";\n\nconst STATUS_LABELS: Record<QuestStatus, string> = {\n  available: \"Available\",\n  in_progress: \"In Progress\",\n  completed: \"Completed\",\n  locked: \"Locked\",\n};\n\ninterface ActiveFilterChipsProps {\n  filters: QuestFilters;\n  onRemoveFilter: (key: keyof QuestFilters, value?: string) => void;\n  onClearAll: () => void;\n}\n\ninterface ChipProps {\n  label: string;\n  onRemove: () => void;\n}\n\nfunction Chip({ label, onRemove }: ChipProps) {\n  return (\n    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 bg-primary/10 border border-primary/30 rounded-full text-xs text-primary\">\n      {label}\n      <button\n        type=\"button\"\n        onClick={onRemove}\n        className=\"hover:text-primary/80 transition-colors\"\n        aria-label={`Remove ${label} filter`}\n      >\n        <X className=\"h-3 w-3\" />\n      </button>\n    </span>\n  );\n}\n\nexport function ActiveFilterChips({\n  filters,\n  onRemoveFilter,\n  onClearAll,\n}: ActiveFilterChipsProps) {\n  const chips: { key: string; label: string; onRemove: () => void }[] = [];\n\n  // Status filters (one chip per status)\n  filters.statuses.forEach((status) => {\n    chips.push({\n      key: `status-${status}`,\n      label: STATUS_LABELS[status],\n      onRemove: () => onRemoveFilter(\"statuses\", status),\n    });\n  });\n\n  // Kappa filter\n  if (filters.kappaOnly) {\n    chips.push({\n      key: \"kappa\",\n      label: \"Kappa Only\",\n      onRemove: () => onRemoveFilter(\"kappaOnly\"),\n    });\n  }\n\n  // Player level (only if not default)\n  if (filters.playerLevel && filters.playerLevel !== 1) {\n    chips.push({\n      key: \"level\",\n      label: `Level ${filters.playerLevel}`,\n      onRemove: () => onRemoveFilter(\"playerLevel\"),\n    });\n  }\n\n  // Search is not shown as a chip (it's visible in the input)\n\n  if (chips.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex flex-wrap items-center gap-2\">\n      <span className=\"text-xs text-muted-foreground\">Active:</span>\n      {chips.map((chip) => (\n        <Chip key={chip.key} label={chip.label} onRemove={chip.onRemove} />\n      ))}\n      <button\n        type=\"button\"\n        onClick={onClearAll}\n        className=\"text-xs text-muted-foreground hover:text-foreground transition-colors ml-1\"\n      >\n        Clear all\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAKA,MAAM,gBAA6C;IACjD,WAAW;IACX,aAAa;IACb,WAAW;IACX,QAAQ;AACV;AAaA,SAAS,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAa;IAC1C,qBACE,6VAAC;QAAK,WAAU;;YACb;0BACD,6VAAC;gBACC,MAAK;gBACL,SAAS;gBACT,WAAU;gBACV,cAAY,CAAC,OAAO,EAAE,MAAM,OAAO,CAAC;0BAEpC,cAAA,6VAAC,qRAAC;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIrB;AAEO,SAAS,kBAAkB,EAChC,OAAO,EACP,cAAc,EACd,UAAU,EACa;IACvB,MAAM,QAAgE,EAAE;IAExE,uCAAuC;IACvC,QAAQ,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,MAAM,IAAI,CAAC;YACT,KAAK,CAAC,OAAO,EAAE,QAAQ;YACvB,OAAO,aAAa,CAAC,OAAO;YAC5B,UAAU,IAAM,eAAe,YAAY;QAC7C;IACF;IAEA,eAAe;IACf,IAAI,QAAQ,SAAS,EAAE;QACrB,MAAM,IAAI,CAAC;YACT,KAAK;YACL,OAAO;YACP,UAAU,IAAM,eAAe;QACjC;IACF;IAEA,qCAAqC;IACrC,IAAI,QAAQ,WAAW,IAAI,QAAQ,WAAW,KAAK,GAAG;QACpD,MAAM,IAAI,CAAC;YACT,KAAK;YACL,OAAO,CAAC,MAAM,EAAE,QAAQ,WAAW,EAAE;YACrC,UAAU,IAAM,eAAe;QACjC;IACF;IAEA,4DAA4D;IAE5D,IAAI,MAAM,MAAM,KAAK,GAAG;QACtB,OAAO;IACT;IAEA,qBACE,6VAAC;QAAI,WAAU;;0BACb,6VAAC;gBAAK,WAAU;0BAAgC;;;;;;YAC/C,MAAM,GAAG,CAAC,CAAC,qBACV,6VAAC;oBAAoB,OAAO,KAAK,KAAK;oBAAE,UAAU,KAAK,QAAQ;mBAApD,KAAK,GAAG;;;;;0BAErB,6VAAC;gBACC,MAAK;gBACL,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAKP"}},
    {"offset": {"line": 3381, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/QuestFilters.tsx"],"sourcesContent":["// @ts-nocheck - React 19 Input component type compatibility\n\"use client\";\n\nimport { useEffect, useState, useRef, useCallback } from \"react\";\nimport { Filter } from \"lucide-react\";\nimport { ProgressStats } from \"@/components/progress-stats\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n} from \"@/components/ui/sheet\";\nimport { useUpdateUserPrefs } from \"@/hooks/useUserPrefs\";\nimport { StatusMultiSelect } from \"./StatusMultiSelect\";\nimport { ActiveFilterChips } from \"./ActiveFilterChips\";\nimport type {\n  Trader,\n  QuestFilters as Filters,\n  QuestWithProgress,\n} from \"@/types\";\n\ninterface QuestFiltersProps {\n  traders: Trader[];\n  quests: QuestWithProgress[];\n  filters: Filters;\n  onFilterChange: (filters: Partial<Filters>) => void;\n  onApplyFilters: () => void;\n  hasPendingChanges: boolean;\n}\n\nexport function QuestFilters({\n  traders,\n  quests,\n  filters,\n  onFilterChange,\n  onApplyFilters,\n}: QuestFiltersProps) {\n  const updatePrefsMutation = useUpdateUserPrefs();\n  const [searchValue, setSearchValue] = useState(filters.search);\n  const [mobileOpen, setMobileOpen] = useState(false);\n  const searchInputRef = useRef<HTMLInputElement>(null);\n\n  // Stable ref for onApplyFilters to avoid infinite loops\n  const onApplyFiltersRef = useRef(onApplyFilters);\n  useEffect(() => {\n    onApplyFiltersRef.current = onApplyFilters;\n  });\n\n  // Auto-save player level when it changes (debounced)\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (filters.playerLevel !== undefined && filters.playerLevel !== null) {\n        updatePrefsMutation.mutate({ playerLevel: filters.playerLevel });\n      }\n    }, 1000);\n\n    return () => clearTimeout(timer);\n  }, [filters.playerLevel]); // mutation.mutate() is stable and doesn't need to be in deps\n\n  // Debounce search input and auto-apply\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (searchValue !== filters.search) {\n        onFilterChange({ search: searchValue });\n        // Use ref to avoid dependency on onApplyFilters\n        setTimeout(() => onApplyFiltersRef.current(), 100);\n      }\n    }, 500);\n\n    return () => clearTimeout(timer);\n  }, [searchValue, filters.search, onFilterChange]);\n\n  // Keyboard shortcut: \"/\" to focus search input\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Don't trigger if user is typing in an input or textarea\n      const target = e.target as HTMLElement;\n      if (\n        target.tagName === \"INPUT\" ||\n        target.tagName === \"TEXTAREA\" ||\n        target.isContentEditable\n      ) {\n        return;\n      }\n\n      if (e.key === \"/\") {\n        e.preventDefault();\n        searchInputRef.current?.focus();\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, []);\n\n  const handleReset = () => {\n    setSearchValue(\"\");\n    onFilterChange({\n      statuses: [\"available\", \"locked\"], // Default to showing available and locked quests\n      search: \"\",\n      kappaOnly: false,\n      playerLevel: 1,\n    });\n    setTimeout(() => onApplyFiltersRef.current(), 0);\n  };\n\n  // Auto-apply filter change (immediate apply after state update)\n  const handleFilterChange = useCallback(\n    (update: Partial<Filters>) => {\n      onFilterChange(update);\n      setTimeout(() => onApplyFiltersRef.current(), 0);\n    },\n    [onFilterChange]\n  );\n\n  // Debounced level change (auto-apply after 500ms)\n  const levelChangeTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const handleLevelChange = useCallback(\n    (level: number | null) => {\n      onFilterChange({ playerLevel: level });\n\n      if (levelChangeTimerRef.current) {\n        clearTimeout(levelChangeTimerRef.current);\n      }\n      levelChangeTimerRef.current = setTimeout(() => {\n        onApplyFiltersRef.current();\n      }, 500);\n    },\n    [onFilterChange]\n  );\n\n  // Handle removal of individual filter from chips (auto-apply)\n  const handleRemoveFilter = (key: keyof Filters, value?: string) => {\n    if (key === \"statuses\" && value) {\n      const newStatuses = filters.statuses.filter((s) => s !== value);\n      handleFilterChange({ statuses: newStatuses });\n    } else if (key === \"kappaOnly\") {\n      handleFilterChange({ kappaOnly: false });\n    } else if (key === \"playerLevel\") {\n      handleFilterChange({ playerLevel: 1 });\n    }\n  };\n\n  // Count all active filters (for chips and mobile badge)\n  const activeFilterCount = [\n    filters.statuses.length > 0 ? filters.statuses : null,\n    filters.kappaOnly,\n    filters.playerLevel !== 1 ? filters.playerLevel : null,\n  ].filter(Boolean).length;\n\n  return (\n    <div className=\"bg-background border-b\">\n      {/* MOBILE LAYOUT */}\n      <div className=\"md:hidden\">\n        {/* Row 1: Search + Filter Button */}\n        <div className=\"flex gap-2 px-4 py-2\">\n          <div className=\"flex-1 min-w-0\">\n            <Input\n              type=\"text\"\n              placeholder=\"Search quests...\"\n              value={searchValue}\n              onChange={(e) => setSearchValue(e.target.value)}\n              className=\"h-9\"\n            />\n          </div>\n          <Sheet open={mobileOpen} onOpenChange={setMobileOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"outline\" size=\"sm\" className=\"relative h-9 px-3\">\n                <Filter className=\"h-4 w-4 mr-1\" />\n                Filters\n                {activeFilterCount > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-5 h-5 bg-primary text-primary-foreground text-xs rounded-full flex items-center justify-center\">\n                    {activeFilterCount}\n                  </span>\n                )}\n              </Button>\n            </SheetTrigger>\n            <SheetContent side=\"bottom\" className=\"h-auto max-h-[85vh]\">\n              <SheetHeader>\n                <SheetTitle>Filter Quests</SheetTitle>\n                <SheetDescription className=\"sr-only\">\n                  Filter quests by status, level, and more\n                </SheetDescription>\n              </SheetHeader>\n              <div className=\"py-4 space-y-4 overflow-y-auto\">\n                {/* Status */}\n                <div>\n                  <Label className=\"text-xs text-muted-foreground\">\n                    Status\n                  </Label>\n                  <div className=\"mt-1\">\n                    <StatusMultiSelect\n                      selectedStatuses={filters.statuses}\n                      onChange={(statuses) => handleFilterChange({ statuses })}\n                    />\n                  </div>\n                </div>\n\n                {/* Kappa Only */}\n                <div className=\"flex items-center justify-between\">\n                  <Label\n                    htmlFor=\"kappa-mobile\"\n                    className=\"text-sm cursor-pointer\"\n                  >\n                    Kappa Required Only\n                  </Label>\n                  <Switch\n                    id=\"kappa-mobile\"\n                    checked={filters.kappaOnly}\n                    onCheckedChange={(checked) =>\n                      handleFilterChange({ kappaOnly: checked })\n                    }\n                  />\n                </div>\n\n                {/* Player Level */}\n                <div className=\"space-y-2\">\n                  <Label className=\"text-sm\">Player Level</Label>\n                  <Input\n                    type=\"number\"\n                    min={1}\n                    max={79}\n                    placeholder=\"1-79\"\n                    value={filters.playerLevel ?? \"\"}\n                    onChange={(e) => {\n                      const val = parseInt(e.target.value);\n                      const level = isNaN(val)\n                        ? null\n                        : Math.min(79, Math.max(1, val));\n                      handleLevelChange(level);\n                    }}\n                    className=\"h-9 w-20\"\n                  />\n                </div>\n\n                {/* Reset button */}\n                <div className=\"pt-4 border-t\">\n                  <Button variant=\"ghost\" size=\"sm\" onClick={handleReset}>\n                    Reset All\n                  </Button>\n                </div>\n              </div>\n            </SheetContent>\n          </Sheet>\n        </div>\n\n        {/* Active filter chips (mobile) */}\n        {activeFilterCount > 0 && (\n          <div className=\"px-4 pb-2 overflow-x-auto\">\n            <ActiveFilterChips\n              filters={filters}\n              onRemoveFilter={handleRemoveFilter}\n              onClearAll={handleReset}\n            />\n          </div>\n        )}\n      </div>\n\n      {/* DESKTOP LAYOUT */}\n      <div className=\"hidden md:block\">\n        {/* Primary filters row */}\n        <div className=\"px-4 py-2 flex items-center justify-between gap-4\">\n          <div className=\"flex items-center gap-3 flex-1\">\n            {/* Search */}\n            <div className=\"w-[200px]\">\n              <Input\n                ref={searchInputRef}\n                type=\"text\"\n                placeholder=\"Search quests... (press /)\"\n                value={searchValue}\n                onChange={(e) => setSearchValue(e.target.value)}\n                className=\"h-9\"\n              />\n            </div>\n\n            {/* Status */}\n            <StatusMultiSelect\n              selectedStatuses={filters.statuses}\n              onChange={(statuses) => handleFilterChange({ statuses })}\n            />\n\n            {/* Kappa Only */}\n            <div className=\"flex items-center gap-1.5\">\n              <Switch\n                id=\"kappa-desktop\"\n                checked={filters.kappaOnly}\n                onCheckedChange={(checked) =>\n                  handleFilterChange({ kappaOnly: checked })\n                }\n              />\n              <Label\n                htmlFor=\"kappa-desktop\"\n                className=\"text-sm cursor-pointer whitespace-nowrap\"\n              >\n                Kappa\n              </Label>\n            </div>\n\n            {/* Level */}\n            <div className=\"flex items-center gap-2\">\n              <Label\n                htmlFor=\"player-level-desktop\"\n                className=\"text-sm whitespace-nowrap\"\n              >\n                Level:\n              </Label>\n              <Input\n                id=\"player-level-desktop\"\n                type=\"number\"\n                min={1}\n                max={79}\n                placeholder=\"1-79\"\n                value={filters.playerLevel ?? \"\"}\n                onChange={(e) => {\n                  const val = parseInt(e.target.value);\n                  const level = isNaN(val)\n                    ? null\n                    : Math.min(79, Math.max(1, val));\n                  handleLevelChange(level);\n                }}\n                className=\"h-9 w-16\"\n              />\n            </div>\n          </div>\n\n          {/* Progress Stats */}\n          <ProgressStats quests={quests} traders={traders} />\n        </div>\n\n        {/* Active filter chips (desktop) */}\n        {activeFilterCount > 0 && (\n          <div className=\"px-4 pb-2\">\n            <ActiveFilterChips\n              filters={filters}\n              onRemoveFilter={handleRemoveFilter}\n              onClearAll={handleReset}\n            />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3936, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\";\n\nfunction Skeleton({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"skeleton\"\n      className={cn(\"bg-accent animate-pulse rounded-md\", className)}\n      {...props}\n    />\n  );\n}\n\nexport { Skeleton };\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAoC;IACpE,qBACE,6VAAC;QACC,aAAU;QACV,WAAW,IAAA,wIAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 3960, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/QuestTreeSkeleton.tsx"],"sourcesContent":["\"use client\";\n\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { QUEST_NODE_WIDTH, QUEST_NODE_HEIGHT } from \"./QuestNode\";\nimport { TRADER_COLORS } from \"@/lib/trader-colors\";\n\n// Layout constants matching the real quest tree\nconst TRADER_NODE_WIDTH = 60;\nconst LANE_SPACING = 25;\nconst TRADER_TO_QUEST_GAP = 20;\nconst QUEST_HORIZONTAL_GAP = 80;\nconst QUEST_VERTICAL_GAP = 25;\n\n// Skeleton edge styling\nconst EDGE_COLOR = \"#4a4a4a\";\n\n// Skeleton lane data - mimics real trader lanes with varying quest counts\nconst SKELETON_LANES = [\n  { name: \"Prapor\", color: TRADER_COLORS.prapor.primary, quests: [4, 3, 2, 1] },\n  {\n    name: \"Therapist\",\n    color: TRADER_COLORS.therapist.primary,\n    quests: [3, 4, 3, 2],\n  },\n  { name: \"Skier\", color: TRADER_COLORS.skier.primary, quests: [3, 2, 3, 1] },\n  {\n    name: \"Peacekeeper\",\n    color: TRADER_COLORS.peacekeeper.primary,\n    quests: [2, 3, 2],\n  },\n];\n\nexport function QuestTreeSkeleton() {\n  return (\n    <div className=\"w-full h-full flex flex-col\">\n      {/* Filter bar skeleton */}\n      <FilterBarSkeleton />\n\n      {/* Quest tree skeleton with trader lanes */}\n      <div className=\"flex-1 overflow-hidden relative bg-[#1a1a1a]\">\n        <div className=\"absolute inset-0 p-6\">\n          {/* SVG layer for edges */}\n          <svg className=\"absolute inset-0 w-full h-full pointer-events-none\">\n            <SkeletonEdges />\n          </svg>\n\n          {/* Nodes layer */}\n          <div className=\"relative\">\n            {SKELETON_LANES.map((lane, laneIndex) => (\n              <SkeletonLane key={lane.name} lane={lane} laneIndex={laneIndex} />\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction FilterBarSkeleton() {\n  return (\n    <div className=\"flex flex-wrap items-center gap-3 p-3 bg-background border-b\">\n      {/* Search input */}\n      <div className=\"flex-1 min-w-[200px] max-w-[400px]\">\n        <Skeleton className=\"h-9 w-full rounded-md\" />\n      </div>\n\n      {/* Trader select */}\n      <Skeleton className=\"h-9 w-[140px] rounded-md\" />\n\n      {/* Map select */}\n      <Skeleton className=\"h-9 w-[120px] rounded-md\" />\n\n      {/* More filters button */}\n      <Skeleton className=\"h-9 w-[80px] rounded-md\" />\n\n      {/* Apply button */}\n      <Skeleton className=\"h-9 w-[70px] rounded-md\" />\n\n      {/* View toggle */}\n      <div className=\"flex gap-1 ml-auto\">\n        <Skeleton className=\"h-8 w-8 rounded\" />\n        <Skeleton className=\"h-8 w-8 rounded\" />\n      </div>\n    </div>\n  );\n}\n\ninterface SkeletonLaneProps {\n  lane: (typeof SKELETON_LANES)[number];\n  laneIndex: number;\n}\n\n// Calculate cumulative Y position for each lane\nfunction getLaneY(laneIndex: number): number {\n  let y = 0;\n  for (let i = 0; i < laneIndex; i++) {\n    const maxNodes = Math.max(...SKELETON_LANES[i].quests);\n    const height = maxNodes * (QUEST_NODE_HEIGHT + QUEST_VERTICAL_GAP);\n    y += height + LANE_SPACING;\n  }\n  return y;\n}\n\nfunction SkeletonLane({ lane, laneIndex }: SkeletonLaneProps) {\n  const maxNodesInColumn = Math.max(...lane.quests);\n  const laneHeight =\n    maxNodesInColumn * (QUEST_NODE_HEIGHT + QUEST_VERTICAL_GAP);\n  const laneY = getLaneY(laneIndex);\n\n  return (\n    <div className=\"absolute flex\" style={{ top: laneY, left: 0 }}>\n      {/* Trader header */}\n      <TraderNodeSkeleton color={lane.color} height={laneHeight} />\n\n      {/* Quest columns */}\n      <div className=\"flex\" style={{ marginLeft: TRADER_TO_QUEST_GAP }}>\n        {lane.quests.map((nodeCount, colIndex) => (\n          <div\n            key={colIndex}\n            className=\"flex flex-col\"\n            style={{\n              marginLeft: colIndex > 0 ? QUEST_HORIZONTAL_GAP : 0,\n              gap: QUEST_VERTICAL_GAP,\n            }}\n          >\n            {Array.from({ length: nodeCount }).map((_, nodeIndex) => (\n              <QuestNodeSkeleton key={nodeIndex} />\n            ))}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface TraderNodeSkeletonProps {\n  color: string;\n  height: number;\n}\n\nfunction TraderNodeSkeleton({ color, height }: TraderNodeSkeletonProps) {\n  return (\n    <div\n      className=\"rounded border-2 flex items-center justify-center bg-background\"\n      style={{\n        width: TRADER_NODE_WIDTH,\n        height: Math.max(height, 80),\n        borderColor: color,\n      }}\n    >\n      {/* Vertical skeleton for trader name */}\n      <div\n        className=\"flex flex-col items-center gap-2\"\n        style={{\n          writingMode: \"vertical-rl\",\n          textOrientation: \"mixed\",\n          transform: \"rotate(180deg)\",\n        }}\n      >\n        <Skeleton\n          className=\"w-3 rounded\"\n          style={{ height: 60, backgroundColor: `${color}40` }}\n        />\n        <Skeleton className=\"w-2 h-6 rounded\" />\n      </div>\n    </div>\n  );\n}\n\nfunction QuestNodeSkeleton() {\n  return (\n    <div\n      className=\"rounded border-2 p-2 animate-pulse\"\n      style={{\n        width: QUEST_NODE_WIDTH,\n        height: QUEST_NODE_HEIGHT,\n        borderColor: \"#636363\",\n        backgroundColor: \"#383945\",\n      }}\n    >\n      {/* Quest title skeleton */}\n      <Skeleton className=\"h-3.5 w-[90%] mb-1.5 bg-[#4a4a4a]\" />\n      <Skeleton className=\"h-3 w-[60%] mb-2 bg-[#4a4a4a]\" />\n\n      {/* Level badge skeleton */}\n      <Skeleton className=\"h-3 w-8 rounded bg-[#4a4a4a]\" />\n    </div>\n  );\n}\n\nfunction SkeletonEdges() {\n  // Generate edge paths based on skeleton lane structure\n  const edges: React.ReactNode[] = [];\n  let edgeId = 0;\n\n  SKELETON_LANES.forEach((lane, laneIndex) => {\n    const laneY = getLaneY(laneIndex) + 24; // +24 for padding\n\n    lane.quests.forEach((nodeCount, colIndex) => {\n      if (colIndex === lane.quests.length - 1) return; // No edges from last column\n\n      const nextColNodeCount = lane.quests[colIndex + 1];\n      const startX =\n        24 + // padding\n        TRADER_NODE_WIDTH +\n        TRADER_TO_QUEST_GAP +\n        colIndex * (QUEST_NODE_WIDTH + QUEST_HORIZONTAL_GAP) +\n        QUEST_NODE_WIDTH;\n\n      const endX = startX + QUEST_HORIZONTAL_GAP;\n\n      // Connect each node in current column to one or more in next column\n      for (let i = 0; i < nodeCount; i++) {\n        const startY =\n          laneY +\n          i * (QUEST_NODE_HEIGHT + QUEST_VERTICAL_GAP) +\n          QUEST_NODE_HEIGHT / 2;\n\n        // Connect to corresponding node(s) in next column\n        const targetIndices = getTargetIndices(i, nodeCount, nextColNodeCount);\n\n        for (const targetIndex of targetIndices) {\n          const endY =\n            laneY +\n            targetIndex * (QUEST_NODE_HEIGHT + QUEST_VERTICAL_GAP) +\n            QUEST_NODE_HEIGHT / 2;\n\n          // Bezier curve control points\n          const controlX = (startX + endX) / 2;\n\n          edges.push(\n            <path\n              key={edgeId++}\n              d={`M ${startX} ${startY} C ${controlX} ${startY}, ${controlX} ${endY}, ${endX} ${endY}`}\n              stroke={EDGE_COLOR}\n              strokeWidth={2}\n              fill=\"none\"\n              className=\"animate-pulse\"\n              style={{ animationDelay: `${edgeId * 50}ms` }}\n            />\n          );\n        }\n      }\n    });\n  });\n\n  return <>{edges}</>;\n}\n\n// Helper to determine which nodes in next column to connect to\nfunction getTargetIndices(\n  sourceIndex: number,\n  sourceCount: number,\n  targetCount: number\n): number[] {\n  if (targetCount === 0) return [];\n\n  // Simple mapping strategy\n  if (targetCount >= sourceCount) {\n    // More targets - connect to corresponding index\n    return [Math.min(sourceIndex, targetCount - 1)];\n  } else {\n    // Fewer targets - multiple sources may connect to same target\n    const targetIndex = Math.floor((sourceIndex / sourceCount) * targetCount);\n    return [Math.min(targetIndex, targetCount - 1)];\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4370, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/SyncStatusIndicator.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { Cloud, CloudOff, Check, Loader2, Clock } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface SyncStatusIndicatorProps {\n  lastSynced: Date | null;\n  isOnline: boolean;\n  isSaving: boolean;\n  pendingOfflineCount?: number;\n}\n\nfunction formatRelativeTime(date: Date): string {\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffSeconds = Math.floor(diffMs / 1000);\n  const diffMinutes = Math.floor(diffSeconds / 60);\n  const diffHours = Math.floor(diffMinutes / 60);\n\n  if (diffSeconds < 5) {\n    return \"just now\";\n  } else if (diffSeconds < 60) {\n    return `${diffSeconds}s ago`;\n  } else if (diffMinutes < 60) {\n    return `${diffMinutes}m ago`;\n  } else if (diffHours < 24) {\n    return `${diffHours}h ago`;\n  } else {\n    return date.toLocaleDateString();\n  }\n}\n\nexport function SyncStatusIndicator({\n  lastSynced,\n  isOnline,\n  isSaving,\n  pendingOfflineCount = 0,\n}: SyncStatusIndicatorProps) {\n  const [relativeTime, setRelativeTime] = useState<string>(\"\");\n\n  // Update relative time every 10 seconds\n  useEffect(() => {\n    if (!lastSynced) return;\n\n    const updateTime = () => {\n      setRelativeTime(formatRelativeTime(lastSynced));\n    };\n\n    updateTime();\n    const interval = setInterval(updateTime, 10000);\n\n    return () => clearInterval(interval);\n  }, [lastSynced]);\n\n  if (!isOnline) {\n    return (\n      <div className=\"flex items-center gap-1.5 text-xs text-amber-500\">\n        <CloudOff className=\"w-3.5 h-3.5\" />\n        <span>\n          Offline\n          {pendingOfflineCount > 0 && ` (${pendingOfflineCount} pending)`}\n        </span>\n      </div>\n    );\n  }\n\n  // Show pending count even when online (syncing in progress)\n  if (pendingOfflineCount > 0 && !isSaving) {\n    return (\n      <div className=\"flex items-center gap-1.5 text-xs text-amber-500\">\n        <Clock className=\"w-3.5 h-3.5\" />\n        <span>\n          {pendingOfflineCount} change{pendingOfflineCount > 1 ? \"s\" : \"\"}{\" \"}\n          pending sync\n        </span>\n      </div>\n    );\n  }\n\n  if (isSaving) {\n    return (\n      <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground\">\n        <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n        <span>Saving...</span>\n      </div>\n    );\n  }\n\n  if (lastSynced) {\n    return (\n      <div\n        className={cn(\n          \"flex items-center gap-1.5 text-xs text-muted-foreground\",\n          relativeTime === \"just now\" && \"text-green-500\"\n        )}\n      >\n        {relativeTime === \"just now\" ? (\n          <Check className=\"w-3.5 h-3.5\" />\n        ) : (\n          <Cloud className=\"w-3.5 h-3.5\" />\n        )}\n        <span>Synced {relativeTime}</span>\n      </div>\n    );\n  }\n\n  return null;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;AAaA,SAAS,mBAAmB,IAAU;IACpC,MAAM,MAAM,IAAI;IAChB,MAAM,SAAS,IAAI,OAAO,KAAK,KAAK,OAAO;IAC3C,MAAM,cAAc,KAAK,KAAK,CAAC,SAAS;IACxC,MAAM,cAAc,KAAK,KAAK,CAAC,cAAc;IAC7C,MAAM,YAAY,KAAK,KAAK,CAAC,cAAc;IAE3C,IAAI,cAAc,GAAG;QACnB,OAAO;IACT,OAAO,IAAI,cAAc,IAAI;QAC3B,OAAO,GAAG,YAAY,KAAK,CAAC;IAC9B,OAAO,IAAI,cAAc,IAAI;QAC3B,OAAO,GAAG,YAAY,KAAK,CAAC;IAC9B,OAAO,IAAI,YAAY,IAAI;QACzB,OAAO,GAAG,UAAU,KAAK,CAAC;IAC5B,OAAO;QACL,OAAO,KAAK,kBAAkB;IAChC;AACF;AAEO,SAAS,oBAAoB,EAClC,UAAU,EACV,QAAQ,EACR,QAAQ,EACR,sBAAsB,CAAC,EACE;IACzB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,gUAAQ,EAAS;IAEzD,wCAAwC;IACxC,IAAA,iUAAS,EAAC;QACR,IAAI,CAAC,YAAY;QAEjB,MAAM,aAAa;YACjB,gBAAgB,mBAAmB;QACrC;QAEA;QACA,MAAM,WAAW,YAAY,YAAY;QAEzC,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAW;IAEf,IAAI,CAAC,UAAU;QACb,qBACE,6VAAC;YAAI,WAAU;;8BACb,6VAAC,8SAAQ;oBAAC,WAAU;;;;;;8BACpB,6VAAC;;wBAAK;wBAEH,sBAAsB,KAAK,CAAC,EAAE,EAAE,oBAAoB,SAAS,CAAC;;;;;;;;;;;;;IAIvE;IAEA,4DAA4D;IAC5D,IAAI,sBAAsB,KAAK,CAAC,UAAU;QACxC,qBACE,6VAAC;YAAI,WAAU;;8BACb,6VAAC,iSAAK;oBAAC,WAAU;;;;;;8BACjB,6VAAC;;wBACE;wBAAoB;wBAAQ,sBAAsB,IAAI,MAAM;wBAAI;wBAAI;;;;;;;;;;;;;IAK7E;IAEA,IAAI,UAAU;QACZ,qBACE,6VAAC;YAAI,WAAU;;8BACb,6VAAC,gTAAO;oBAAC,WAAU;;;;;;8BACnB,6VAAC;8BAAK;;;;;;;;;;;;IAGZ;IAEA,IAAI,YAAY;QACd,qBACE,6VAAC;YACC,WAAW,IAAA,wIAAE,EACX,2DACA,iBAAiB,cAAc;;gBAGhC,iBAAiB,2BAChB,6VAAC,iSAAK;oBAAC,WAAU;;;;;yCAEjB,6VAAC,iSAAK;oBAAC,WAAU;;;;;;8BAEnB,6VAAC;;wBAAK;wBAAQ;;;;;;;;;;;;;IAGpB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 4544, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/QuestTypeMultiSelect.tsx"],"sourcesContent":["\"use client\";\n\nimport { ChevronDown, Check } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport type { QuestType } from \"@/types\";\n\nconst QUEST_TYPES: { value: QuestType; label: string }[] = [\n  { value: \"standard\", label: \"Standard\" },\n  { value: \"pvp_zone\", label: \"PVP Zone\" },\n  { value: \"reputation\", label: \"Reputation (Fence)\" },\n  { value: \"lightkeeper\", label: \"Lightkeeper\" },\n  { value: \"faction_bear\", label: \"BEAR Only\" },\n  { value: \"faction_usec\", label: \"USEC Only\" },\n  { value: \"story\", label: \"Story\" },\n  { value: \"prestige\", label: \"Prestige\" },\n];\n\ninterface QuestTypeMultiSelectProps {\n  selectedTypes: QuestType[];\n  onChange: (types: QuestType[]) => void;\n}\n\nexport function QuestTypeMultiSelect({\n  selectedTypes,\n  onChange,\n}: QuestTypeMultiSelectProps) {\n  const handleToggle = (type: QuestType) => {\n    const newTypes = selectedTypes.includes(type)\n      ? selectedTypes.filter((t) => t !== type)\n      : [...selectedTypes, type];\n    onChange(newTypes);\n  };\n\n  const getLabel = () => {\n    if (selectedTypes.length === 0) return \"All Types\";\n    if (selectedTypes.length === 1) {\n      return QUEST_TYPES.find((t) => t.value === selectedTypes[0])?.label;\n    }\n    return `Types (${selectedTypes.length})`;\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"h-9 min-w-[120px] justify-between gap-1\"\n        >\n          <span className=\"truncate\">{getLabel()}</span>\n          <ChevronDown className=\"h-4 w-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[200px] p-2\" align=\"start\">\n        <div className=\"flex flex-col gap-1\">\n          {QUEST_TYPES.map((type) => {\n            const isSelected = selectedTypes.includes(type.value);\n            return (\n              <button\n                key={type.value}\n                type=\"button\"\n                onClick={() => handleToggle(type.value)}\n                className={`flex items-center gap-2 w-full px-2 py-1.5 text-sm rounded transition-colors text-left ${\n                  isSelected\n                    ? \"bg-primary/10 text-foreground\"\n                    : \"hover:bg-muted text-muted-foreground\"\n                }`}\n              >\n                <span className=\"flex-1\">{type.label}</span>\n                {isSelected && (\n                  <Check className=\"h-4 w-4 shrink-0 text-primary\" />\n                )}\n              </button>\n            );\n          })}\n        </div>\n        <div className=\"mt-2 pt-2 border-t\">\n          <button\n            type=\"button\"\n            onClick={() => onChange([])}\n            className=\"w-full px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors\"\n          >\n            Clear selection (show all)\n          </button>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AAJA;;;;;AAWA,MAAM,cAAqD;IACzD;QAAE,OAAO;QAAY,OAAO;IAAW;IACvC;QAAE,OAAO;QAAY,OAAO;IAAW;IACvC;QAAE,OAAO;QAAc,OAAO;IAAqB;IACnD;QAAE,OAAO;QAAe,OAAO;IAAc;IAC7C;QAAE,OAAO;QAAgB,OAAO;IAAY;IAC5C;QAAE,OAAO;QAAgB,OAAO;IAAY;IAC5C;QAAE,OAAO;QAAS,OAAO;IAAQ;IACjC;QAAE,OAAO;QAAY,OAAO;IAAW;CACxC;AAOM,SAAS,qBAAqB,EACnC,aAAa,EACb,QAAQ,EACkB;IAC1B,MAAM,eAAe,CAAC;QACpB,MAAM,WAAW,cAAc,QAAQ,CAAC,QACpC,cAAc,MAAM,CAAC,CAAC,IAAM,MAAM,QAClC;eAAI;YAAe;SAAK;QAC5B,SAAS;IACX;IAEA,MAAM,WAAW;QACf,IAAI,cAAc,MAAM,KAAK,GAAG,OAAO;QACvC,IAAI,cAAc,MAAM,KAAK,GAAG;YAC9B,OAAO,YAAY,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,aAAa,CAAC,EAAE,GAAG;QAChE;QACA,OAAO,CAAC,OAAO,EAAE,cAAc,MAAM,CAAC,CAAC,CAAC;IAC1C;IAEA,qBACE,6VAAC,6JAAO;;0BACN,6VAAC,oKAAc;gBAAC,OAAO;0BACrB,cAAA,6VAAC,2JAAM;oBACL,SAAQ;oBACR,MAAK;oBACL,WAAU;;sCAEV,6VAAC;4BAAK,WAAU;sCAAY;;;;;;sCAC5B,6VAAC,uTAAW;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAG3B,6VAAC,oKAAc;gBAAC,WAAU;gBAAgB,OAAM;;kCAC9C,6VAAC;wBAAI,WAAU;kCACZ,YAAY,GAAG,CAAC,CAAC;4BAChB,MAAM,aAAa,cAAc,QAAQ,CAAC,KAAK,KAAK;4BACpD,qBACE,6VAAC;gCAEC,MAAK;gCACL,SAAS,IAAM,aAAa,KAAK,KAAK;gCACtC,WAAW,CAAC,uFAAuF,EACjG,aACI,kCACA,wCACJ;;kDAEF,6VAAC;wCAAK,WAAU;kDAAU,KAAK,KAAK;;;;;;oCACnC,4BACC,6VAAC,iSAAK;wCAAC,WAAU;;;;;;;+BAXd,KAAK,KAAK;;;;;wBAerB;;;;;;kCAEF,6VAAC;wBAAI,WAAU;kCACb,cAAA,6VAAC;4BACC,MAAK;4BACL,SAAS,IAAM,SAAS,EAAE;4BAC1B,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 4716, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/index.ts"],"sourcesContent":["export { QuestTree } from \"./QuestTree\";\nexport { QuestNode, QUEST_NODE_WIDTH, QUEST_NODE_HEIGHT } from \"./QuestNode\";\nexport { TraderNode } from \"./TraderNode\";\nexport { QuestFilters } from \"./QuestFilters\";\nexport { QuestTreeSkeleton } from \"./QuestTreeSkeleton\";\nexport { SyncStatusIndicator } from \"./SyncStatusIndicator\";\nexport { QuestTypeMultiSelect } from \"./QuestTypeMultiSelect\";\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 4735, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/dialog.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { XIcon } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />;\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />;\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />;\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />;\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean;\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          // Refactoring UI: Modals use elevation-xl for maximum depth\n          \"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-elevation-xl duration-200 sm:max-w-lg\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  );\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn(\"text-lg leading-none font-semibold\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  );\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6VAAC,uRAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;AAEA,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6VAAC,0RAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;AAEA,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,6VAAC,yRAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6VAAC,wRAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,6VAAC,0RAAuB;QACtB,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,6VAAC;QAAa,aAAU;;0BACtB,6VAAC;;;;;0BACD,6VAAC,0RAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,wIAAE,EACX,4DAA4D;gBAC5D,yXACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,6VAAC,wRAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,6VAAC,6RAAK;;;;;0CACN,6VAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6VAAC;QACC,aAAU;QACV,WAAW,IAAA,wIAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6VAAC;QACC,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6VAAC,wRAAqB;QACpB,aAAU;QACV,WAAW,IAAA,wIAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6VAAC,8RAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,wIAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 4918, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\";\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  );\n}\n\nexport { Badge, badgeVariants };\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,kPAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,4SAAI,GAAG;IAE9B,qBACE,6VAAC;QACC,aAAU;QACV,WAAW,IAAA,wIAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 4964, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-tree/SkipQuestDialog.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { getTraderColor } from \"@/lib/trader-colors\";\nimport type { QuestWithProgress } from \"@/types\";\n\ninterface SkipQuestDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  targetQuest: QuestWithProgress | null;\n  prerequisites: QuestWithProgress[];\n  onConfirm: () => void;\n  isLoading?: boolean;\n}\n\nexport function SkipQuestDialog({\n  open,\n  onOpenChange,\n  targetQuest,\n  prerequisites,\n  onConfirm,\n  isLoading = false,\n}: SkipQuestDialogProps) {\n  if (!targetQuest) return null;\n\n  // Group prerequisites by trader\n  const byTrader = new Map<string, QuestWithProgress[]>();\n  for (const prereq of prerequisites) {\n    const traderId = prereq.trader.id;\n    if (!byTrader.has(traderId)) {\n      byTrader.set(traderId, []);\n    }\n    byTrader.get(traderId)!.push(prereq);\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-md max-h-[80vh] overflow-hidden flex flex-col\">\n        <DialogHeader>\n          <DialogTitle>Skip to Quest</DialogTitle>\n          <DialogDescription>\n            Mark all prerequisite quests as completed to unlock{\" \"}\n            <span className=\"font-semibold\">{targetQuest.title}</span>?\n          </DialogDescription>\n        </DialogHeader>\n\n        {prerequisites.length > 0 ? (\n          <div className=\"flex-1 overflow-y-auto py-4\">\n            <p className=\"text-sm text-muted-foreground mb-3\">\n              The following {prerequisites.length} quest\n              {prerequisites.length > 1 ? \"s\" : \"\"} will be marked as completed:\n            </p>\n\n            <div className=\"space-y-3\">\n              {Array.from(byTrader.entries()).map(([traderId, quests]) => {\n                const traderColor = getTraderColor(traderId);\n                const traderName = quests[0].trader.name;\n\n                return (\n                  <div key={traderId}>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <div\n                        className=\"w-2 h-2 rounded-full\"\n                        style={{ backgroundColor: traderColor.primary }}\n                      />\n                      <span className=\"text-xs font-medium text-muted-foreground\">\n                        {traderName}\n                      </span>\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {quests.length}\n                      </Badge>\n                    </div>\n                    <ul className=\"space-y-1 ml-4\">\n                      {quests.map((quest) => (\n                        <li\n                          key={quest.id}\n                          className=\"text-sm flex items-center gap-2\"\n                        >\n                          <span\n                            className=\"w-1.5 h-1.5 rounded-full\"\n                            style={{ backgroundColor: traderColor.primary }}\n                          />\n                          {quest.title}\n                          <span className=\"text-xs text-muted-foreground\">\n                            Lv.{quest.levelRequired}\n                          </span>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        ) : (\n          <div className=\"py-4 text-sm text-muted-foreground\">\n            This quest has no incomplete prerequisites. It should already be\n            available!\n          </div>\n        )}\n\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            disabled={isLoading}\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={onConfirm}\n            disabled={isLoading || prerequisites.length === 0}\n          >\n            {isLoading\n              ? \"Completing...\"\n              : `Complete ${prerequisites.length} Quest${prerequisites.length !== 1 ? \"s\" : \"\"}`}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAQA;AACA;AACA;AAZA;;;;;;AAwBO,SAAS,gBAAgB,EAC9B,IAAI,EACJ,YAAY,EACZ,WAAW,EACX,aAAa,EACb,SAAS,EACT,YAAY,KAAK,EACI;IACrB,IAAI,CAAC,aAAa,OAAO;IAEzB,gCAAgC;IAChC,MAAM,WAAW,IAAI;IACrB,KAAK,MAAM,UAAU,cAAe;QAClC,MAAM,WAAW,OAAO,MAAM,CAAC,EAAE;QACjC,IAAI,CAAC,SAAS,GAAG,CAAC,WAAW;YAC3B,SAAS,GAAG,CAAC,UAAU,EAAE;QAC3B;QACA,SAAS,GAAG,CAAC,UAAW,IAAI,CAAC;IAC/B;IAEA,qBACE,6VAAC,2JAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6VAAC,kKAAa;YAAC,WAAU;;8BACvB,6VAAC,iKAAY;;sCACX,6VAAC,gKAAW;sCAAC;;;;;;sCACb,6VAAC,sKAAiB;;gCAAC;gCACmC;8CACpD,6VAAC;oCAAK,WAAU;8CAAiB,YAAY,KAAK;;;;;;gCAAQ;;;;;;;;;;;;;gBAI7D,cAAc,MAAM,GAAG,kBACtB,6VAAC;oBAAI,WAAU;;sCACb,6VAAC;4BAAE,WAAU;;gCAAqC;gCACjC,cAAc,MAAM;gCAAC;gCACnC,cAAc,MAAM,GAAG,IAAI,MAAM;gCAAG;;;;;;;sCAGvC,6VAAC;4BAAI,WAAU;sCACZ,MAAM,IAAI,CAAC,SAAS,OAAO,IAAI,GAAG,CAAC,CAAC,CAAC,UAAU,OAAO;gCACrD,MAAM,cAAc,IAAA,+JAAc,EAAC;gCACnC,MAAM,aAAa,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI;gCAExC,qBACE,6VAAC;;sDACC,6VAAC;4CAAI,WAAU;;8DACb,6VAAC;oDACC,WAAU;oDACV,OAAO;wDAAE,iBAAiB,YAAY,OAAO;oDAAC;;;;;;8DAEhD,6VAAC;oDAAK,WAAU;8DACb;;;;;;8DAEH,6VAAC,yJAAK;oDAAC,SAAQ;oDAAY,WAAU;8DAClC,OAAO,MAAM;;;;;;;;;;;;sDAGlB,6VAAC;4CAAG,WAAU;sDACX,OAAO,GAAG,CAAC,CAAC,sBACX,6VAAC;oDAEC,WAAU;;sEAEV,6VAAC;4DACC,WAAU;4DACV,OAAO;gEAAE,iBAAiB,YAAY,OAAO;4DAAC;;;;;;wDAE/C,MAAM,KAAK;sEACZ,6VAAC;4DAAK,WAAU;;gEAAgC;gEAC1C,MAAM,aAAa;;;;;;;;mDATpB,MAAM,EAAE;;;;;;;;;;;mCAhBX;;;;;4BAgCd;;;;;;;;;;;yCAIJ,6VAAC;oBAAI,WAAU;8BAAqC;;;;;;8BAMtD,6VAAC,iKAAY;;sCACX,6VAAC,2JAAM;4BACL,SAAQ;4BACR,SAAS,IAAM,aAAa;4BAC5B,UAAU;sCACX;;;;;;sCAGD,6VAAC,2JAAM;4BACL,SAAS;4BACT,UAAU,aAAa,cAAc,MAAM,KAAK;sCAE/C,YACG,kBACA,CAAC,SAAS,EAAE,cAAc,MAAM,CAAC,MAAM,EAAE,cAAc,MAAM,KAAK,IAAI,MAAM,IAAI;;;;;;;;;;;;;;;;;;;;;;;AAMhG"}},
    {"offset": {"line": 5196, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/onboarding/WelcomeModal.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  MousePointerClick,\n  Filter,\n  Trophy,\n  Sparkles,\n  Keyboard,\n  Focus,\n  FastForward,\n} from \"lucide-react\";\n\ninterface WelcomeModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onGetStarted: () => void;\n  onCatchUp?: () => void;\n}\n\nconst tips = [\n  {\n    icon: MousePointerClick,\n    title: \"Click to Complete\",\n    description:\n      \"Click any quest to mark it as completed. Long-press on mobile for details.\",\n  },\n  {\n    icon: Focus,\n    title: \"Focus Mode\",\n    description:\n      \"Double-click a quest to highlight its entire chain of prerequisites and dependents.\",\n  },\n  {\n    icon: Keyboard,\n    title: \"Keyboard Navigation\",\n    description:\n      \"Use arrow keys to navigate, Enter to complete, Space for details, F for focus.\",\n  },\n  {\n    icon: Filter,\n    title: \"Smart Filters\",\n    description:\n      \"Filter by trader, status, or search. Set your PMC level to highlight available quests.\",\n  },\n  {\n    icon: Trophy,\n    title: \"Kappa Container\",\n    description:\n      \"Toggle Kappa-only mode to focus on quests required for the Kappa container.\",\n  },\n];\n\nexport function WelcomeModal({\n  open,\n  onOpenChange,\n  onGetStarted,\n  onCatchUp,\n}: WelcomeModalProps) {\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-md\" showCloseButton={false}>\n        <DialogHeader className=\"text-center\">\n          <div className=\"mx-auto mb-2 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10\">\n            <Sparkles className=\"h-6 w-6 text-primary\" />\n          </div>\n          <DialogTitle className=\"text-xl\">\n            Welcome to EFT Quest Tracker\n          </DialogTitle>\n          <DialogDescription>\n            Track your Escape from Tarkov quest progress across all traders.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"py-4 space-y-4\">\n          {tips.map((tip, index) => (\n            <div key={index} className=\"flex gap-3\">\n              <div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-md bg-muted\">\n                <tip.icon className=\"h-4 w-4 text-muted-foreground\" />\n              </div>\n              <div>\n                <p className=\"text-sm font-medium\">{tip.title}</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  {tip.description}\n                </p>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        <DialogFooter className=\"flex-col gap-2 sm:flex-col\">\n          <Button onClick={onGetStarted} className=\"w-full\">\n            Start Fresh\n          </Button>\n          {onCatchUp && (\n            <Button variant=\"outline\" onClick={onCatchUp} className=\"w-full\">\n              <FastForward className=\"h-4 w-4 mr-2\" />\n              Already mid-wipe? Catch up\n            </Button>\n          )}\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAQA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAXA;;;;;AA4BA,MAAM,OAAO;IACX;QACE,MAAM,6UAAiB;QACvB,OAAO;QACP,aACE;IACJ;IACA;QACE,MAAM,iSAAK;QACX,OAAO;QACP,aACE;IACJ;IACA;QACE,MAAM,0SAAQ;QACd,OAAO;QACP,aACE;IACJ;IACA;QACE,MAAM,oSAAM;QACZ,OAAO;QACP,aACE;IACJ;IACA;QACE,MAAM,oSAAM;QACZ,OAAO;QACP,aACE;IACJ;CACD;AAEM,SAAS,aAAa,EAC3B,IAAI,EACJ,YAAY,EACZ,YAAY,EACZ,SAAS,EACS;IAClB,qBACE,6VAAC,2JAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6VAAC,kKAAa;YAAC,WAAU;YAAW,iBAAiB;;8BACnD,6VAAC,iKAAY;oBAAC,WAAU;;sCACtB,6VAAC;4BAAI,WAAU;sCACb,cAAA,6VAAC,0SAAQ;gCAAC,WAAU;;;;;;;;;;;sCAEtB,6VAAC,gKAAW;4BAAC,WAAU;sCAAU;;;;;;sCAGjC,6VAAC,sKAAiB;sCAAC;;;;;;;;;;;;8BAKrB,6VAAC;oBAAI,WAAU;8BACZ,KAAK,GAAG,CAAC,CAAC,KAAK,sBACd,6VAAC;4BAAgB,WAAU;;8CACzB,6VAAC;oCAAI,WAAU;8CACb,cAAA,6VAAC,IAAI,IAAI;wCAAC,WAAU;;;;;;;;;;;8CAEtB,6VAAC;;sDACC,6VAAC;4CAAE,WAAU;sDAAuB,IAAI,KAAK;;;;;;sDAC7C,6VAAC;4CAAE,WAAU;sDACV,IAAI,WAAW;;;;;;;;;;;;;2BAPZ;;;;;;;;;;8BAcd,6VAAC,iKAAY;oBAAC,WAAU;;sCACtB,6VAAC,2JAAM;4BAAC,SAAS;4BAAc,WAAU;sCAAS;;;;;;wBAGjD,2BACC,6VAAC,2JAAM;4BAAC,SAAQ;4BAAU,SAAS;4BAAW,WAAU;;8CACtD,6VAAC,uTAAW;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;;;;;;;AAQtD"}},
    {"offset": {"line": 5395, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/onboarding/index.ts"],"sourcesContent":["export { WelcomeModal } from \"./WelcomeModal\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 5402, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-detail/ObjectiveCounter.tsx"],"sourcesContent":["\"use client\";\n\nimport { Minus, Plus, Check, Loader2 } from \"lucide-react\";\n\ninterface ObjectiveCounterProps {\n  current: number;\n  target: number;\n  onIncrement: () => void;\n  onDecrement: () => void;\n  onComplete: () => void;\n  disabled?: boolean;\n  isLoading?: boolean;\n}\n\n/**\n * Counter component for numeric objectives (e.g., \"Kill 2/5 PMCs\")\n * Features:\n * - Touch-friendly 44x44px +/- buttons\n * - \"Complete\" shortcut button for high-count objectives\n * - Accessible with role=\"spinbutton\" and ARIA labels\n * - Visual feedback when complete (green styling)\n */\nexport function ObjectiveCounter({\n  current,\n  target,\n  onIncrement,\n  onDecrement,\n  onComplete,\n  disabled = false,\n  isLoading = false,\n}: ObjectiveCounterProps) {\n  const isComplete = current >= target;\n  const canDecrement = current > 0 && !disabled && !isLoading;\n  const canIncrement = current < target && !disabled && !isLoading;\n  const showCompleteButton = current < target && !disabled && !isLoading;\n\n  return (\n    <div\n      className=\"flex items-center gap-1.5\"\n      onClick={(e) => e.stopPropagation()}\n    >\n      {/* Decrement button */}\n      <button\n        type=\"button\"\n        onClick={(e) => {\n          e.stopPropagation();\n          if (canDecrement) onDecrement();\n        }}\n        disabled={!canDecrement}\n        className={`\n          w-8 h-8 flex items-center justify-center rounded border-2 transition-all\n          ${\n            canDecrement\n              ? \"border-muted-foreground/30 hover:border-primary hover:bg-primary/10 text-muted-foreground hover:text-primary\"\n              : \"border-muted/30 text-muted/30 cursor-not-allowed\"\n          }\n        `}\n        aria-label=\"Decrement progress\"\n      >\n        <Minus className=\"w-3.5 h-3.5\" />\n      </button>\n\n      {/* Progress display */}\n      <div\n        className={`\n          text-sm font-medium min-w-[48px] text-center px-2 py-1 rounded\n          ${\n            isComplete\n              ? \"bg-primary/20 text-primary\"\n              : \"bg-muted/50 text-foreground/80\"\n          }\n        `}\n        role=\"spinbutton\"\n        aria-valuenow={current}\n        aria-valuemin={0}\n        aria-valuemax={target}\n        aria-label={`Progress: ${current} of ${target}`}\n      >\n        {isLoading ? (\n          <Loader2 className=\"w-4 h-4 animate-spin mx-auto\" />\n        ) : (\n          `${current}/${target}`\n        )}\n      </div>\n\n      {/* Increment button */}\n      <button\n        type=\"button\"\n        onClick={(e) => {\n          e.stopPropagation();\n          if (canIncrement) onIncrement();\n        }}\n        disabled={!canIncrement}\n        className={`\n          w-8 h-8 flex items-center justify-center rounded border-2 transition-all\n          ${\n            canIncrement\n              ? \"border-muted-foreground/30 hover:border-primary hover:bg-primary/10 text-muted-foreground hover:text-primary\"\n              : \"border-muted/30 text-muted/30 cursor-not-allowed\"\n          }\n        `}\n        aria-label=\"Increment progress\"\n      >\n        <Plus className=\"w-3.5 h-3.5\" />\n      </button>\n\n      {/* Complete shortcut button - shows when not yet complete */}\n      {showCompleteButton && (\n        <button\n          type=\"button\"\n          onClick={(e) => {\n            e.stopPropagation();\n            onComplete();\n          }}\n          className=\"\n            ml-1 px-2 py-1 text-xs rounded border border-primary/30\n            hover:bg-primary/10 hover:border-primary text-primary/80 hover:text-primary\n            transition-all flex items-center gap-1\n          \"\n          aria-label=\"Mark as complete\"\n        >\n          <Check className=\"w-3 h-3\" />\n          <span className=\"hidden sm:inline\">Done</span>\n        </button>\n      )}\n\n      {/* Completed indicator */}\n      {isComplete && !isLoading && (\n        <Check className=\"w-4 h-4 text-primary ml-1\" aria-label=\"Completed\" />\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAFA;;;AAsBO,SAAS,iBAAiB,EAC/B,OAAO,EACP,MAAM,EACN,WAAW,EACX,WAAW,EACX,UAAU,EACV,WAAW,KAAK,EAChB,YAAY,KAAK,EACK;IACtB,MAAM,aAAa,WAAW;IAC9B,MAAM,eAAe,UAAU,KAAK,CAAC,YAAY,CAAC;IAClD,MAAM,eAAe,UAAU,UAAU,CAAC,YAAY,CAAC;IACvD,MAAM,qBAAqB,UAAU,UAAU,CAAC,YAAY,CAAC;IAE7D,qBACE,6VAAC;QACC,WAAU;QACV,SAAS,CAAC,IAAM,EAAE,eAAe;;0BAGjC,6VAAC;gBACC,MAAK;gBACL,SAAS,CAAC;oBACR,EAAE,eAAe;oBACjB,IAAI,cAAc;gBACpB;gBACA,UAAU,CAAC;gBACX,WAAW,CAAC;;UAEV,EACE,eACI,iHACA,mDACL;QACH,CAAC;gBACD,cAAW;0BAEX,cAAA,6VAAC,iSAAK;oBAAC,WAAU;;;;;;;;;;;0BAInB,6VAAC;gBACC,WAAW,CAAC;;UAEV,EACE,aACI,+BACA,iCACL;QACH,CAAC;gBACD,MAAK;gBACL,iBAAe;gBACf,iBAAe;gBACf,iBAAe;gBACf,cAAY,CAAC,UAAU,EAAE,QAAQ,IAAI,EAAE,QAAQ;0BAE9C,0BACC,6VAAC,gTAAO;oBAAC,WAAU;;;;;2BAEnB,GAAG,QAAQ,CAAC,EAAE,QAAQ;;;;;;0BAK1B,6VAAC;gBACC,MAAK;gBACL,SAAS,CAAC;oBACR,EAAE,eAAe;oBACjB,IAAI,cAAc;gBACpB;gBACA,UAAU,CAAC;gBACX,WAAW,CAAC;;UAEV,EACE,eACI,iHACA,mDACL;QACH,CAAC;gBACD,cAAW;0BAEX,cAAA,6VAAC,8RAAI;oBAAC,WAAU;;;;;;;;;;;YAIjB,oCACC,6VAAC;gBACC,MAAK;gBACL,SAAS,CAAC;oBACR,EAAE,eAAe;oBACjB;gBACF;gBACA,WAAU;gBAKV,cAAW;;kCAEX,6VAAC,iSAAK;wBAAC,WAAU;;;;;;kCACjB,6VAAC;wBAAK,WAAU;kCAAmB;;;;;;;;;;;;YAKtC,cAAc,CAAC,2BACd,6VAAC,iSAAK;gBAAC,WAAU;gBAA4B,cAAW;;;;;;;;;;;;AAIhE"}},
    {"offset": {"line": 5542, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/lib/tarkov-api.ts"],"sourcesContent":["/**\n * Client for fetching quest details from tarkov.dev GraphQL API\n */\n\nconst TARKOV_API_URL = \"https://api.tarkov.dev/graphql\";\n\n// In-memory cache for quest details (session-scoped)\nconst questDetailsCache = new Map<string, TarkovQuestDetails>();\n\nexport interface TarkovItem {\n  name: string;\n  shortName: string;\n  iconLink: string;\n}\n\nexport interface TarkovTraderStanding {\n  trader: {\n    name: string;\n  };\n  standing: number;\n}\n\nexport interface TarkovItemReward {\n  item: TarkovItem;\n  count: number;\n}\n\nexport interface TarkovRewards {\n  traderStanding: TarkovTraderStanding[];\n  items: TarkovItemReward[];\n}\n\nexport interface TarkovObjectiveItem {\n  id: string;\n  type: string;\n  description: string;\n  item?: TarkovItem;\n  items?: TarkovItem[];\n  count?: number;\n  foundInRaid?: boolean;\n}\n\nexport interface TarkovNeededKey {\n  keys: TarkovItem[];\n  map: {\n    name: string;\n  } | null;\n}\n\nexport interface TarkovQuestDetails {\n  id: string;\n  name: string;\n  experience: number;\n  finishRewards: TarkovRewards;\n  objectives: TarkovObjectiveItem[];\n  neededKeys: TarkovNeededKey[];\n}\n\nconst QUEST_DETAILS_QUERY = `\nquery GetQuestDetails($id: ID!) {\n  task(id: $id) {\n    id\n    name\n    experience\n    finishRewards {\n      traderStanding {\n        trader {\n          name\n        }\n        standing\n      }\n      items {\n        item {\n          name\n          shortName\n          iconLink\n        }\n        count\n      }\n    }\n    objectives {\n      id\n      type\n      description\n      ... on TaskObjectiveItem {\n        item {\n          name\n          shortName\n          iconLink\n        }\n        items {\n          name\n          shortName\n          iconLink\n        }\n        count\n        foundInRaid\n      }\n    }\n    neededKeys {\n      keys {\n        name\n        shortName\n        iconLink\n      }\n      map {\n        name\n      }\n    }\n  }\n}\n`;\n\nexport async function fetchQuestDetails(\n  questId: string\n): Promise<TarkovQuestDetails | null> {\n  // Check cache first\n  const cached = questDetailsCache.get(questId);\n  if (cached) {\n    return cached;\n  }\n\n  try {\n    const response = await fetch(TARKOV_API_URL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        query: QUEST_DETAILS_QUERY,\n        variables: { id: questId },\n      }),\n    });\n\n    if (!response.ok) {\n      console.error(`Tarkov API error: ${response.status}`);\n      return null;\n    }\n\n    const result = await response.json();\n\n    if (result.errors) {\n      console.error(\"Tarkov API GraphQL errors:\", result.errors);\n      return null;\n    }\n\n    const details = result.data?.task as TarkovQuestDetails | null;\n\n    // Cache successful result\n    if (details) {\n      questDetailsCache.set(questId, details);\n    }\n\n    return details;\n  } catch (error) {\n    console.error(\"Failed to fetch quest details from tarkov.dev:\", error);\n    return null;\n  }\n}\n\n/**\n * Clear the quest details cache (useful for testing or forced refresh)\n */\nexport function clearQuestDetailsCache(): void {\n  questDetailsCache.clear();\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;AAED,MAAM,iBAAiB;AAEvB,qDAAqD;AACrD,MAAM,oBAAoB,IAAI;AAmD9B,MAAM,sBAAsB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqD7B,CAAC;AAEM,eAAe,kBACpB,OAAe;IAEf,oBAAoB;IACpB,MAAM,SAAS,kBAAkB,GAAG,CAAC;IACrC,IAAI,QAAQ;QACV,OAAO;IACT;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,gBAAgB;YAC3C,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO;gBACP,WAAW;oBAAE,IAAI;gBAAQ;YAC3B;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,CAAC,kBAAkB,EAAE,SAAS,MAAM,EAAE;YACpD,OAAO;QACT;QAEA,MAAM,SAAS,MAAM,SAAS,IAAI;QAElC,IAAI,OAAO,MAAM,EAAE;YACjB,QAAQ,KAAK,CAAC,8BAA8B,OAAO,MAAM;YACzD,OAAO;QACT;QAEA,MAAM,UAAU,OAAO,IAAI,EAAE;QAE7B,0BAA0B;QAC1B,IAAI,SAAS;YACX,kBAAkB,GAAG,CAAC,SAAS;QACjC;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kDAAkD;QAChE,OAAO;IACT;AACF;AAKO,SAAS;IACd,kBAAkB,KAAK;AACzB"}},
    {"offset": {"line": 5653, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/hooks/useQuestDetails.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from \"react\";\nimport { fetchQuestDetails, type TarkovQuestDetails } from \"@/lib/tarkov-api\";\n\ninterface UseQuestDetailsReturn {\n  details: TarkovQuestDetails | null;\n  loading: boolean;\n  error: string | null;\n  refetch: () => Promise<void>;\n}\n\n/**\n * Hook for fetching extended quest details from tarkov.dev API\n * Includes rewards, required items, and other data not stored locally\n *\n * @param questId - The quest ID to fetch details for (null to skip fetching)\n */\nexport function useQuestDetails(questId: string | null): UseQuestDetailsReturn {\n  const [details, setDetails] = useState<TarkovQuestDetails | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetch = useCallback(async () => {\n    if (!questId) {\n      setDetails(null);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await fetchQuestDetails(questId);\n      if (result) {\n        setDetails(result);\n      } else {\n        setError(\"Quest details not found\");\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to fetch details\");\n    } finally {\n      setLoading(false);\n    }\n  }, [questId]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  return {\n    details,\n    loading,\n    error,\n    refetch: fetch,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAkBO,SAAS,gBAAgB,OAAsB;IACpD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gUAAQ,EAA4B;IAClE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gUAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gUAAQ,EAAgB;IAElD,MAAM,QAAQ,IAAA,mUAAW,EAAC;QACxB,IAAI,CAAC,SAAS;YACZ,WAAW;YACX;QACF;QAEA,WAAW;QACX,SAAS;QAET,IAAI;YACF,MAAM,SAAS,MAAM,IAAA,+JAAiB,EAAC;YACvC,IAAI,QAAQ;gBACV,WAAW;YACb,OAAO;gBACL,SAAS;YACX;QACF,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF,GAAG;QAAC;KAAQ;IAEZ,IAAA,iUAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAM;IAEV,OAAO;QACL;QACA;QACA;QACA,SAAS;IACX;AACF"}},
    {"offset": {"line": 5704, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-detail/QuestDetailModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport {\n  ExternalLink,\n  MapPin,\n  Target,\n  Award,\n  ChevronRight,\n  Gift,\n  Package,\n  Loader2,\n  AlertCircle,\n  Key,\n  CheckCircle,\n  Square,\n  CheckSquare,\n} from \"lucide-react\";\nimport { ObjectiveCounter } from \"./ObjectiveCounter\";\nimport { useIsMobile } from \"@/hooks/useIsMobile\";\nimport { useQuestDetails } from \"@/hooks/useQuestDetails\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n  SheetDescription,\n} from \"@/components/ui/sheet\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { getTraderColor, STATUS_COLORS } from \"@/lib/trader-colors\";\nimport type { QuestWithProgress, Objective } from \"@/types\";\nimport type { TarkovQuestDetails, TarkovObjectiveItem } from \"@/lib/tarkov-api\";\n\n// Objective update can be either a boolean (binary toggle) or numeric progress\ntype ObjectiveUpdate = boolean | { current: number };\n\ninterface QuestDetailModalProps {\n  quest: QuestWithProgress | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onStatusChange?: (questId: string) => Promise<void>;\n  onObjectiveToggle?: (\n    objectiveId: string,\n    update: ObjectiveUpdate\n  ) => Promise<{ questStatusChanged?: boolean; newQuestStatus?: string }>;\n  isSaving?: boolean;\n}\n\n// Helper to extract item objectives that require turning in items\nfunction getItemObjectives(\n  objectives: TarkovObjectiveItem[]\n): TarkovObjectiveItem[] {\n  return objectives.filter(\n    (obj) =>\n      (obj.type === \"giveItem\" || obj.type === \"findQuestItem\") &&\n      (obj.item || (obj.items && obj.items.length > 0))\n  );\n}\n\n// Local state for numeric objectives: objectiveId -> current count\ntype NumericObjectiveStates = Record<string, number>;\n\ninterface QuestDetailContentProps {\n  quest: QuestWithProgress;\n  details: TarkovQuestDetails | null;\n  detailsLoading: boolean;\n  detailsError: string | null;\n  onStatusChange?: (questId: string) => Promise<void>;\n  onObjectiveToggle?: (\n    objectiveId: string,\n    update: ObjectiveUpdate\n  ) => Promise<{ questStatusChanged?: boolean; newQuestStatus?: string }>;\n  isSaving?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  objectiveStates: Record<string, boolean>;\n  numericObjectiveStates: NumericObjectiveStates;\n  onLocalObjectiveToggle: (objectiveId: string, completed: boolean) => void;\n  onLocalNumericUpdate: (objectiveId: string, current: number) => void;\n  savingObjectives: Set<string>;\n}\n\n// Helper to check if an objective is completed (supports both binary and numeric)\nfunction isObjectiveCompleted(\n  objective: Objective,\n  objectiveStates: Record<string, boolean>,\n  numericObjectiveStates: NumericObjectiveStates\n): boolean {\n  const progress = objective.progress?.[0];\n  const isNumeric =\n    progress?.target !== null &&\n    progress?.target !== undefined &&\n    progress.target > 0;\n\n  if (isNumeric && progress && progress.target !== null) {\n    const target = progress.target; // Narrowed to number by the checks above\n    // Check local numeric state first\n    if (numericObjectiveStates[objective.id] !== undefined) {\n      return numericObjectiveStates[objective.id] >= target;\n    }\n    // Fall back to server state\n    return (progress?.current ?? 0) >= target;\n  }\n\n  // Binary objective: check local state first\n  if (objectiveStates[objective.id] !== undefined) {\n    return objectiveStates[objective.id];\n  }\n  // Fall back to server state\n  return progress?.completed ?? false;\n}\n\n// Helper to get current numeric progress\nfunction getNumericProgress(\n  objective: Objective,\n  numericObjectiveStates: NumericObjectiveStates\n): number {\n  // Check local state first (optimistic updates)\n  if (numericObjectiveStates[objective.id] !== undefined) {\n    return numericObjectiveStates[objective.id];\n  }\n  // Fall back to server state\n  return objective.progress?.[0]?.current ?? 0;\n}\n\nfunction QuestDetailContent({\n  quest,\n  details,\n  detailsLoading,\n  detailsError,\n  onStatusChange,\n  onObjectiveToggle,\n  isSaving,\n  onOpenChange,\n  objectiveStates,\n  numericObjectiveStates,\n  onLocalObjectiveToggle,\n  onLocalNumericUpdate,\n  savingObjectives,\n}: QuestDetailContentProps) {\n  const statusColor = STATUS_COLORS[quest.computedStatus];\n  const isLocked = quest.computedStatus === \"locked\";\n  const canToggleObjectives = !isLocked && !!onObjectiveToggle;\n\n  // Calculate objective progress\n  const completedCount = quest.objectives.filter((obj) =>\n    isObjectiveCompleted(obj, objectiveStates, numericObjectiveStates)\n  ).length;\n  const totalCount = quest.objectives.length;\n\n  // Group objectives by map\n  const objectivesByMap = quest.objectives.reduce(\n    (acc, obj) => {\n      const map = obj.map || \"Any Location\";\n      if (!acc[map]) acc[map] = [];\n      acc[map].push(obj);\n      return acc;\n    },\n    {} as Record<string, typeof quest.objectives>\n  );\n\n  // Get unique maps for display\n  const maps = Object.keys(objectivesByMap);\n\n  // Get prerequisite quests\n  const prerequisites = quest.dependsOn || [];\n\n  // Extract required items from objectives\n  const itemObjectives = details ? getItemObjectives(details.objectives) : [];\n\n  // Check if there are rewards\n  const hasRewards =\n    details &&\n    (details.experience > 0 ||\n      details.finishRewards.items.length > 0 ||\n      details.finishRewards.traderStanding.length > 0);\n\n  // Check for needed keys\n  const hasKeys =\n    details && details.neededKeys && details.neededKeys.length > 0;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status & Level Info */}\n      <div className=\"flex flex-wrap items-center gap-2\">\n        <Badge\n          variant=\"outline\"\n          style={{\n            borderColor: statusColor.primary,\n            color: statusColor.primary,\n          }}\n        >\n          {quest.computedStatus.replace(\"_\", \" \")}\n        </Badge>\n        <Badge variant=\"secondary\">Level {quest.levelRequired}</Badge>\n        {quest.kappaRequired && (\n          <Badge\n            style={{ backgroundColor: \"#FFD700\", color: \"#000\" }}\n            className=\"font-bold\"\n          >\n            Kappa Required\n          </Badge>\n        )}\n        {details && details.experience > 0 && (\n          <Badge variant=\"secondary\">\n            {details.experience.toLocaleString()} XP\n          </Badge>\n        )}\n      </div>\n\n      {/* Required Items Section */}\n      {itemObjectives.length > 0 && (\n        <div>\n          <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n            <Package className=\"w-4 h-4\" />\n            Required Items ({itemObjectives.length})\n          </h3>\n          <ul className=\"space-y-2\">\n            {itemObjectives.map((obj) => {\n              const item = obj.item || obj.items?.[0];\n              if (!item) return null;\n              return (\n                <li key={obj.id} className=\"flex items-center gap-3 text-sm\">\n                  {item.iconLink && (\n                    // eslint-disable-next-line @next/next/no-img-element\n                    <img\n                      src={item.iconLink}\n                      alt={item.shortName}\n                      className=\"w-8 h-8 object-contain bg-muted rounded\"\n                    />\n                  )}\n                  <div className=\"flex-1\">\n                    <span className=\"text-foreground/90\">{item.name}</span>\n                    {obj.count && obj.count > 1 && (\n                      <span className=\"text-muted-foreground ml-1\">\n                        x{obj.count}\n                      </span>\n                    )}\n                    {obj.foundInRaid && (\n                      <Badge variant=\"outline\" className=\"ml-2 text-xs py-0\">\n                        FIR\n                      </Badge>\n                    )}\n                  </div>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n\n      {/* Needed Keys Section */}\n      {hasKeys && (\n        <div>\n          <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n            <Key className=\"w-4 h-4\" />\n            Required Keys ({details!.neededKeys.length})\n          </h3>\n          <ul className=\"space-y-2\">\n            {details!.neededKeys.map((keyReq, idx) =>\n              keyReq.keys.map((key) => (\n                <li\n                  key={`${idx}-${key.shortName}`}\n                  className=\"flex items-center gap-3 text-sm\"\n                >\n                  {key.iconLink && (\n                    // eslint-disable-next-line @next/next/no-img-element\n                    <img\n                      src={key.iconLink}\n                      alt={key.shortName}\n                      className=\"w-8 h-8 object-contain bg-muted rounded\"\n                    />\n                  )}\n                  <div className=\"flex-1\">\n                    <span className=\"text-foreground/90\">{key.name}</span>\n                    {keyReq.map && (\n                      <span className=\"text-xs text-muted-foreground ml-2\">\n                        ({keyReq.map.name})\n                      </span>\n                    )}\n                  </div>\n                </li>\n              ))\n            )}\n          </ul>\n        </div>\n      )}\n\n      {/* Objectives Section */}\n      <div>\n        <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n          <Target className=\"w-4 h-4\" />\n          Objectives ({completedCount}/{totalCount})\n        </h3>\n        {/* Progress bar */}\n        {totalCount > 0 && (\n          <div className=\"mb-3\">\n            <div className=\"h-1.5 bg-muted rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-primary transition-all duration-300\"\n                style={{\n                  width: `${(completedCount / totalCount) * 100}%`,\n                }}\n              />\n            </div>\n          </div>\n        )}\n        {quest.objectives.length > 0 ? (\n          <div className=\"space-y-4\">\n            {maps.map((map) => (\n              <div key={map}>\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <MapPin className=\"w-3 h-3 text-muted-foreground\" />\n                  <span className=\"text-xs font-medium text-muted-foreground\">\n                    {map}\n                  </span>\n                </div>\n                <ul className=\"space-y-2\">\n                  {objectivesByMap[map].map((obj) => {\n                    const isCompleted = isObjectiveCompleted(\n                      obj,\n                      objectiveStates,\n                      numericObjectiveStates\n                    );\n                    const isSavingThis = savingObjectives.has(obj.id);\n                    const objProgress = obj.progress?.[0];\n                    const isNumeric =\n                      objProgress?.target !== null &&\n                      objProgress?.target !== undefined &&\n                      objProgress.target > 0;\n                    const currentProgress = isNumeric\n                      ? getNumericProgress(obj, numericObjectiveStates)\n                      : 0;\n\n                    // For numeric objectives, render counter instead of checkbox\n                    if (\n                      isNumeric &&\n                      objProgress &&\n                      objProgress.target !== null\n                    ) {\n                      return (\n                        <li\n                          key={obj.id}\n                          className={`flex items-start gap-2 text-sm leading-relaxed py-1 -mx-2 px-2 rounded ${\n                            isCompleted\n                              ? \"text-muted-foreground\"\n                              : \"text-foreground/90\"\n                          }`}\n                        >\n                          {/* Description first for numeric */}\n                          <span\n                            className={`flex-1 ${isCompleted ? \"line-through\" : \"\"}`}\n                          >\n                            {obj.description}\n                          </span>\n                          {/* Counter */}\n                          <ObjectiveCounter\n                            current={currentProgress}\n                            target={objProgress.target}\n                            disabled={!canToggleObjectives}\n                            isLoading={isSavingThis}\n                            onIncrement={() => {\n                              if (\n                                !canToggleObjectives ||\n                                isSavingThis ||\n                                !objProgress ||\n                                objProgress.target === null\n                              )\n                                return;\n                              const newValue = Math.min(\n                                currentProgress + 1,\n                                objProgress.target\n                              );\n                              onLocalNumericUpdate(obj.id, newValue);\n                              onObjectiveToggle?.(obj.id, {\n                                current: newValue,\n                              });\n                            }}\n                            onDecrement={() => {\n                              if (!canToggleObjectives || isSavingThis) return;\n                              const newValue = Math.max(currentProgress - 1, 0);\n                              onLocalNumericUpdate(obj.id, newValue);\n                              onObjectiveToggle?.(obj.id, {\n                                current: newValue,\n                              });\n                            }}\n                            onComplete={() => {\n                              if (\n                                !canToggleObjectives ||\n                                isSavingThis ||\n                                objProgress?.target === null\n                              )\n                                return;\n                              onLocalNumericUpdate(obj.id, objProgress.target);\n                              onObjectiveToggle?.(obj.id, {\n                                current: objProgress.target,\n                              });\n                            }}\n                          />\n                        </li>\n                      );\n                    }\n\n                    // Binary objective - render checkbox\n                    return (\n                      <li\n                        key={obj.id}\n                        className={`flex items-start gap-2 text-sm leading-relaxed ${\n                          canToggleObjectives\n                            ? \"cursor-pointer hover:bg-muted/50 -mx-2 px-2 py-1 rounded\"\n                            : \"\"\n                        } ${isCompleted ? \"text-muted-foreground\" : \"text-foreground/90\"}`}\n                        onClick={\n                          canToggleObjectives && !isSavingThis\n                            ? () => {\n                                const newCompleted = !isCompleted;\n                                onLocalObjectiveToggle(obj.id, newCompleted);\n                                onObjectiveToggle?.(obj.id, newCompleted);\n                              }\n                            : undefined\n                        }\n                      >\n                        {/* Checkbox */}\n                        <span className=\"shrink-0 mt-0.5\">\n                          {isSavingThis ? (\n                            <Loader2 className=\"w-4 h-4 animate-spin text-muted-foreground\" />\n                          ) : isCompleted ? (\n                            <CheckSquare\n                              className={`w-4 h-4 ${canToggleObjectives ? \"text-primary\" : \"text-muted-foreground\"}`}\n                            />\n                          ) : (\n                            <Square\n                              className={`w-4 h-4 ${canToggleObjectives ? \"text-muted-foreground hover:text-primary\" : \"text-muted-foreground/50\"}`}\n                            />\n                          )}\n                        </span>\n                        {/* Description */}\n                        <span className={isCompleted ? \"line-through\" : \"\"}>\n                          {obj.description}\n                        </span>\n                      </li>\n                    );\n                  })}\n                </ul>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <p className=\"text-sm text-muted-foreground italic\">\n            No objectives listed\n          </p>\n        )}\n      </div>\n\n      {/* Rewards Section */}\n      {detailsLoading && (\n        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n          <Loader2 className=\"w-4 h-4 animate-spin\" />\n          Loading rewards...\n        </div>\n      )}\n      {detailsError && (\n        <div className=\"flex items-center gap-2 text-sm text-destructive\">\n          <AlertCircle className=\"w-4 h-4\" />\n          {detailsError}\n        </div>\n      )}\n      {hasRewards && (\n        <div>\n          <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n            <Gift className=\"w-4 h-4\" />\n            Rewards\n          </h3>\n          <div className=\"space-y-3\">\n            {/* Trader Standing Changes */}\n            {details!.finishRewards.traderStanding.length > 0 && (\n              <div className=\"flex flex-wrap gap-2\">\n                {details!.finishRewards.traderStanding.map((standing, idx) => (\n                  <Badge\n                    key={idx}\n                    variant={\n                      standing.standing >= 0 ? \"secondary\" : \"destructive\"\n                    }\n                    className=\"text-xs\"\n                  >\n                    {standing.trader.name} {standing.standing >= 0 ? \"+\" : \"\"}\n                    {standing.standing.toFixed(2)}\n                  </Badge>\n                ))}\n              </div>\n            )}\n            {/* Item Rewards */}\n            {details!.finishRewards.items.length > 0 && (\n              <ul className=\"space-y-2\">\n                {details!.finishRewards.items.map((reward, idx) => (\n                  <li key={idx} className=\"flex items-center gap-3 text-sm\">\n                    {reward.item.iconLink && (\n                      // eslint-disable-next-line @next/next/no-img-element\n                      <img\n                        src={reward.item.iconLink}\n                        alt={reward.item.shortName}\n                        className=\"w-8 h-8 object-contain bg-muted rounded\"\n                      />\n                    )}\n                    <span className=\"text-foreground/90\">\n                      {reward.item.name}\n                      {reward.count > 1 && (\n                        <span className=\"text-muted-foreground ml-1\">\n                          x{reward.count.toLocaleString()}\n                        </span>\n                      )}\n                    </span>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Prerequisites Section */}\n      {prerequisites.length > 0 && (\n        <div>\n          <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n            <ChevronRight className=\"w-4 h-4\" />\n            Prerequisites ({prerequisites.length})\n          </h3>\n          <ul className=\"space-y-2\">\n            {prerequisites.map((dep) => {\n              const prereqTraderColor = getTraderColor(\n                dep.requiredQuest.traderId\n              );\n              const requirementText = dep.requirementStatus.includes(\"complete\")\n                ? \"Complete\"\n                : dep.requirementStatus.includes(\"active\")\n                  ? \"Have Active\"\n                  : dep.requirementStatus.join(\", \");\n\n              return (\n                <li\n                  key={dep.requiredQuest.id}\n                  className=\"flex items-center gap-2 text-sm\"\n                >\n                  <div\n                    className=\"w-2 h-2 rounded-full shrink-0\"\n                    style={{ backgroundColor: prereqTraderColor.primary }}\n                  />\n                  <span className=\"text-foreground/90\">\n                    {dep.requiredQuest.title}\n                  </span>\n                  <span className=\"text-xs text-muted-foreground\">\n                    ({requirementText})\n                  </span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n\n      {/* Unlocks Section */}\n      {quest.dependedOnBy && quest.dependedOnBy.length > 0 && (\n        <div>\n          <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2\">\n            <Award className=\"w-4 h-4\" />\n            Unlocks ({quest.dependedOnBy.length})\n          </h3>\n          <ul className=\"space-y-2\">\n            {quest.dependedOnBy.map((dep) => {\n              const depTraderColor = getTraderColor(\n                dep.dependentQuest.traderId\n              );\n              return (\n                <li\n                  key={dep.dependentQuest.id}\n                  className=\"flex items-center gap-2 text-sm\"\n                >\n                  <div\n                    className=\"w-2 h-2 rounded-full shrink-0\"\n                    style={{ backgroundColor: depTraderColor.primary }}\n                  />\n                  <span className=\"text-foreground/90\">\n                    {dep.dependentQuest.title}\n                  </span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      {quest.computedStatus !== \"locked\" && onStatusChange && (\n        <div className=\"pt-2 border-t\">\n          <div className=\"flex gap-2\">\n            {/* Complete Quest Button - Left (Primary Action) */}\n            <Button\n              variant=\"default\"\n              size=\"sm\"\n              className=\"flex-1\"\n              disabled={isSaving}\n              onClick={async () => {\n                await onStatusChange(quest.id);\n                onOpenChange?.(false);\n              }}\n            >\n              {isSaving ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : (\n                <CheckCircle className=\"w-4 h-4 mr-2\" />\n              )}\n              {quest.computedStatus === \"completed\"\n                ? \"Mark Available\"\n                : \"Complete Quest\"}\n            </Button>\n\n            {/* Wiki Link Button - Right */}\n            {quest.wikiLink && (\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"flex-1\"\n                onClick={() =>\n                  window.open(quest.wikiLink!, \"_blank\", \"noopener,noreferrer\")\n                }\n              >\n                <ExternalLink className=\"w-4 h-4 mr-2\" />\n                View Wiki\n              </Button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Fallback: Wiki-only button when no status change handler */}\n      {quest.computedStatus !== \"locked\" &&\n        !onStatusChange &&\n        quest.wikiLink && (\n          <div className=\"pt-2 border-t\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"w-full\"\n              onClick={() =>\n                window.open(quest.wikiLink!, \"_blank\", \"noopener,noreferrer\")\n              }\n            >\n              <ExternalLink className=\"w-4 h-4 mr-2\" />\n              View on Tarkov Wiki\n            </Button>\n          </div>\n        )}\n    </div>\n  );\n}\n\nexport function QuestDetailModal({\n  quest,\n  open,\n  onOpenChange,\n  onStatusChange,\n  onObjectiveToggle,\n  isSaving,\n}: QuestDetailModalProps) {\n  const isMobile = useIsMobile();\n  // Fetch extended details from tarkov.dev when modal opens\n  const {\n    details,\n    loading: detailsLoading,\n    error: detailsError,\n  } = useQuestDetails(open && quest ? quest.id : null);\n\n  // Local state for optimistic updates on objectives (binary)\n  const [objectiveStates, setObjectiveStates] = useState<\n    Record<string, boolean>\n  >({});\n  // Local state for numeric objectives\n  const [numericObjectiveStates, setNumericObjectiveStates] =\n    useState<NumericObjectiveStates>({});\n  const [savingObjectives, setSavingObjectives] = useState<Set<string>>(\n    new Set()\n  );\n\n  // Reset local state when quest changes or modal closes\n  const handleOpenChange = useCallback(\n    (newOpen: boolean) => {\n      if (!newOpen) {\n        setObjectiveStates({});\n        setNumericObjectiveStates({});\n        setSavingObjectives(new Set());\n      }\n      onOpenChange(newOpen);\n    },\n    [onOpenChange]\n  );\n\n  // Handle local objective toggle with optimistic update (binary)\n  const handleLocalObjectiveToggle = useCallback(\n    (objectiveId: string, completed: boolean) => {\n      setObjectiveStates((prev) => ({ ...prev, [objectiveId]: completed }));\n      setSavingObjectives((prev) => new Set(prev).add(objectiveId));\n    },\n    []\n  );\n\n  // Handle local numeric update with optimistic update\n  const handleLocalNumericUpdate = useCallback(\n    (objectiveId: string, current: number) => {\n      setNumericObjectiveStates((prev) => ({\n        ...prev,\n        [objectiveId]: current,\n      }));\n      setSavingObjectives((prev) => new Set(prev).add(objectiveId));\n    },\n    []\n  );\n\n  // Wrap the onObjectiveToggle to handle saving state\n  const handleObjectiveToggle = useCallback(\n    async (objectiveId: string, update: ObjectiveUpdate) => {\n      if (!onObjectiveToggle) return { questStatusChanged: false };\n\n      try {\n        const result = await onObjectiveToggle(objectiveId, update);\n        return result;\n      } finally {\n        setSavingObjectives((prev) => {\n          const next = new Set(prev);\n          next.delete(objectiveId);\n          return next;\n        });\n      }\n    },\n    [onObjectiveToggle]\n  );\n\n  if (!quest) return null;\n\n  const traderColor = getTraderColor(quest.traderId);\n\n  // Use Sheet (drawer) on mobile, Dialog on desktop\n  if (isMobile) {\n    return (\n      <Sheet open={open} onOpenChange={handleOpenChange}>\n        <SheetContent side=\"bottom\" className=\"max-h-[85vh] overflow-y-auto\">\n          <SheetHeader className=\"text-left pb-4 border-b\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <div\n                className=\"w-3 h-3 rounded-full\"\n                style={{ backgroundColor: traderColor.primary }}\n              />\n              <span className=\"text-xs font-medium text-muted-foreground\">\n                {quest.trader.name}\n              </span>\n            </div>\n            <SheetTitle className=\"text-lg\">{quest.title}</SheetTitle>\n            <SheetDescription className=\"sr-only\">\n              Quest details for {quest.title}\n            </SheetDescription>\n          </SheetHeader>\n          <div className=\"pt-4\">\n            <QuestDetailContent\n              quest={quest}\n              details={details}\n              detailsLoading={detailsLoading}\n              detailsError={detailsError}\n              onStatusChange={onStatusChange}\n              onObjectiveToggle={handleObjectiveToggle}\n              isSaving={isSaving}\n              onOpenChange={handleOpenChange}\n              objectiveStates={objectiveStates}\n              numericObjectiveStates={numericObjectiveStates}\n              onLocalObjectiveToggle={handleLocalObjectiveToggle}\n              onLocalNumericUpdate={handleLocalNumericUpdate}\n              savingObjectives={savingObjectives}\n            />\n          </div>\n        </SheetContent>\n      </Sheet>\n    );\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogContent className=\"sm:max-w-lg max-h-[85vh] overflow-y-auto\">\n        <DialogHeader className=\"pb-4 border-b\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: traderColor.primary }}\n            />\n            <span className=\"text-xs font-medium text-muted-foreground\">\n              {quest.trader.name}\n            </span>\n          </div>\n          <DialogTitle className=\"text-lg\">{quest.title}</DialogTitle>\n          <DialogDescription className=\"sr-only\">\n            Quest details for {quest.title}\n          </DialogDescription>\n        </DialogHeader>\n        <QuestDetailContent\n          quest={quest}\n          details={details}\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onStatusChange={onStatusChange}\n          onObjectiveToggle={handleObjectiveToggle}\n          isSaving={isSaving}\n          onOpenChange={handleOpenChange}\n          objectiveStates={objectiveStates}\n          numericObjectiveStates={numericObjectiveStates}\n          onLocalObjectiveToggle={handleLocalObjectiveToggle}\n          onLocalNumericUpdate={handleLocalNumericUpdate}\n          savingObjectives={savingObjectives}\n        />\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6880, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/quest-detail/index.ts"],"sourcesContent":["export { QuestDetailModal } from \"./QuestDetailModal\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 6887, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/lib/catch-up-algorithm.ts"],"sourcesContent":["/**\n * Catch-up algorithm for detecting sibling terminal branches\n *\n * Given a set of \"target quests\" (quests the user is currently on), this algorithm:\n * 1. Finds all prerequisites for those quests (required to be completed)\n * 2. Detects terminal quest branches that share ancestors with the selected quests\n *    (these are sibling branches that likely ended before the user's current position)\n */\n\nimport type {\n  QuestWithProgress,\n  CatchUpSelection,\n  CatchUpCalculation,\n} from \"@eft-tracker/types\";\n\n/**\n * Build a map of quest IDs to quests for efficient lookup\n */\nfunction buildQuestMap(\n  quests: QuestWithProgress[]\n): Map<string, QuestWithProgress> {\n  const map = new Map<string, QuestWithProgress>();\n  for (const quest of quests) {\n    map.set(quest.id, quest);\n  }\n  return map;\n}\n\n/**\n * Recursively collect all ancestors (prerequisites) for a quest\n */\nexport function collectAncestors(\n  questId: string,\n  questMap: Map<string, QuestWithProgress>,\n  visited: Set<string> = new Set()\n): Set<string> {\n  if (visited.has(questId)) return visited;\n\n  const quest = questMap.get(questId);\n  if (!quest) return visited;\n\n  visited.add(questId);\n\n  for (const dep of quest.dependsOn || []) {\n    const prereqId = dep.requiredQuest?.id;\n    if (prereqId) {\n      collectAncestors(prereqId, questMap, visited);\n    }\n  }\n\n  return visited;\n}\n\n/**\n * Recursively collect all descendants (quests that depend on this one)\n */\nexport function collectDescendants(\n  questId: string,\n  questMap: Map<string, QuestWithProgress>,\n  visited: Set<string> = new Set()\n): Set<string> {\n  if (visited.has(questId)) return visited;\n\n  const quest = questMap.get(questId);\n  if (!quest) return visited;\n\n  visited.add(questId);\n\n  for (const dep of quest.dependedOnBy || []) {\n    const dependentId = dep.dependentQuest?.id;\n    if (dependentId) {\n      collectDescendants(dependentId, questMap, visited);\n    }\n  }\n\n  return visited;\n}\n\n/**\n * Check if a quest is terminal (has no dependents)\n */\nfunction isTerminal(quest: QuestWithProgress): boolean {\n  return !quest.dependedOnBy || quest.dependedOnBy.length === 0;\n}\n\n/**\n * Get the chain length (number of prerequisites) for a quest\n */\nexport function getChainLength(\n  questId: string,\n  questMap: Map<string, QuestWithProgress>\n): number {\n  const ancestors = collectAncestors(questId, questMap);\n  return ancestors.size - 1; // Exclude the quest itself\n}\n\n/**\n * Convert a quest to a CatchUpSelection\n */\nfunction questToSelection(\n  quest: QuestWithProgress,\n  questMap: Map<string, QuestWithProgress>\n): CatchUpSelection {\n  return {\n    questId: quest.id,\n    questTitle: quest.title,\n    traderId: quest.traderId,\n    traderName: quest.trader?.name || \"Unknown\",\n    traderColor: quest.trader?.color || \"#888888\",\n    levelRequired: quest.levelRequired,\n    chainLength: getChainLength(quest.id, questMap),\n  };\n}\n\n/**\n * Get all prerequisites for the selected quests\n * These are \"locked\" - they must be completed for the user to be on the target quests\n */\nexport function getPrerequisitesForSelection(\n  targetQuestIds: string[],\n  quests: QuestWithProgress[]\n): CatchUpSelection[] {\n  const questMap = buildQuestMap(quests);\n  const allPrereqs = new Set<string>();\n\n  // Collect all prerequisites for all target quests\n  for (const targetId of targetQuestIds) {\n    const ancestors = collectAncestors(targetId, questMap);\n    ancestors.delete(targetId); // Don't include the target quest itself\n    for (const ancestorId of ancestors) {\n      allPrereqs.add(ancestorId);\n    }\n  }\n\n  // Convert to selections\n  const selections: CatchUpSelection[] = [];\n  for (const prereqId of allPrereqs) {\n    const quest = questMap.get(prereqId);\n    if (quest) {\n      selections.push(questToSelection(quest, questMap));\n    }\n  }\n\n  // Sort by chain length (shorter chains first)\n  return selections.sort(\n    (a, b) => (a.chainLength ?? 0) - (b.chainLength ?? 0)\n  );\n}\n\n/**\n * Get terminal quests that share ancestors with the selected quests\n * These are sibling branches that likely ended before the user's current position\n *\n * Logic:\n * 1. Find all ancestors of the target quests\n * 2. Find all descendants of those ancestors (entire subtrees)\n * 3. Filter to terminal quests only\n * 4. Exclude any quests that are ancestors or descendants of target quests\n */\nexport function getCompletedBranches(\n  targetQuestIds: string[],\n  quests: QuestWithProgress[]\n): CatchUpSelection[] {\n  const questMap = buildQuestMap(quests);\n  const targetSet = new Set(targetQuestIds);\n\n  // Step 1: Collect all ancestors of target quests\n  const allAncestors = new Set<string>();\n  for (const targetId of targetQuestIds) {\n    const ancestors = collectAncestors(targetId, questMap);\n    for (const ancestorId of ancestors) {\n      allAncestors.add(ancestorId);\n    }\n  }\n\n  // Step 2: Collect all descendants of target quests (to exclude)\n  const allDescendants = new Set<string>();\n  for (const targetId of targetQuestIds) {\n    const descendants = collectDescendants(targetId, questMap);\n    for (const descendantId of descendants) {\n      allDescendants.add(descendantId);\n    }\n  }\n\n  // Step 3: Find terminal quests that branch off from shared ancestors\n  const completedBranches: CatchUpSelection[] = [];\n\n  for (const quest of quests) {\n    // Skip non-terminal quests\n    if (!isTerminal(quest)) continue;\n\n    // Skip target quests themselves\n    if (targetSet.has(quest.id)) continue;\n\n    // Skip ancestors of target quests (they're prerequisites, not siblings)\n    if (allAncestors.has(quest.id)) continue;\n\n    // Skip descendants of target quests\n    if (allDescendants.has(quest.id)) continue;\n\n    // Check if this terminal quest shares an ancestor with any target quest\n    const questAncestors = collectAncestors(quest.id, questMap);\n\n    let sharesAncestor = false;\n    for (const ancestorId of questAncestors) {\n      if (allAncestors.has(ancestorId)) {\n        sharesAncestor = true;\n        break;\n      }\n    }\n\n    if (sharesAncestor) {\n      const selection = questToSelection(quest, questMap);\n      // Mark as auto-checked if level requirement is at or below player level\n      completedBranches.push(selection);\n    }\n  }\n\n  // Sort by level required, then by trader name\n  return completedBranches.sort((a, b) => {\n    const aLevel = a.levelRequired ?? 0;\n    const bLevel = b.levelRequired ?? 0;\n    if (aLevel !== bLevel) {\n      return aLevel - bLevel;\n    }\n    const aName = a.traderName ?? \"\";\n    const bName = b.traderName ?? \"\";\n    return aName.localeCompare(bName);\n  });\n}\n\n/**\n * Main entry point: calculate the full catch-up data\n */\nexport function calculateCatchUp(\n  targetQuestIds: string[],\n  quests: QuestWithProgress[]\n): CatchUpCalculation {\n  return {\n    targetQuests: getPrerequisitesForSelection(targetQuestIds, quests),\n    siblingBranches: getCompletedBranches(targetQuestIds, quests),\n    ancestors: [],\n    blockedQuests: [],\n  };\n}\n\n/**\n * Get all quest IDs that would be completed for a branch\n * (the terminal quest + all its prerequisites)\n */\nexport function getBranchQuestIds(\n  terminalQuestId: string,\n  quests: QuestWithProgress[]\n): string[] {\n  const questMap = buildQuestMap(quests);\n  const ancestors = collectAncestors(terminalQuestId, questMap);\n  return Array.from(ancestors);\n}\n\n/**\n * Group selections by trader for display\n */\nexport function groupByTrader(\n  selections: CatchUpSelection[]\n): Map<string, CatchUpSelection[]> {\n  const groups = new Map<string, CatchUpSelection[]>();\n\n  for (const selection of selections) {\n    const existing = groups.get(selection.traderId) || [];\n    existing.push(selection);\n    groups.set(selection.traderId, existing);\n  }\n\n  return groups;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7074, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface CheckboxProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  onCheckedChange?: (checked: boolean) => void;\n}\n\nconst Checkbox = React.forwardRef<HTMLInputElement, CheckboxProps>(\n  ({ className, onCheckedChange, onChange, ...props }, ref) => {\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      onChange?.(e);\n      onCheckedChange?.(e.target.checked);\n    };\n\n    return (\n      <input\n        type=\"checkbox\"\n        className={cn(\n          \"h-4 w-4 rounded border border-[var(--tactical-border)] bg-[var(--bg-card)]\",\n          \"text-[var(--accent-gold)] focus:ring-[var(--accent-gold)] focus:ring-offset-0\",\n          \"cursor-pointer transition-colors\",\n          \"checked:bg-[var(--accent-gold)] checked:border-[var(--accent-gold)]\",\n          className\n        )}\n        ref={ref}\n        onChange={handleChange}\n        {...props}\n      />\n    );\n  }\n);\nCheckbox.displayName = \"Checkbox\";\n\nexport { Checkbox };\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AASA,MAAM,yBAAW,kUAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,eAAe,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACnD,MAAM,eAAe,CAAC;QACpB,WAAW;QACX,kBAAkB,EAAE,MAAM,CAAC,OAAO;IACpC;IAEA,qBACE,6VAAC;QACC,MAAK;QACL,WAAW,IAAA,wIAAE,EACX,8EACA,iFACA,oCACA,uEACA;QAEF,KAAK;QACL,UAAU;QACT,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 7108, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/catch-up/TraderQuestGroup.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { ChevronDown, ChevronRight } from \"lucide-react\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport type { CatchUpSelection } from \"@eft-tracker/types\";\n\ninterface TraderQuestGroupProps {\n  traderName: string;\n  traderColor: string;\n  quests: CatchUpSelection[];\n  showCheckboxes?: boolean;\n  checkedQuests?: Set<string>;\n  onToggleQuest?: (questId: string) => void;\n  defaultExpanded?: boolean;\n}\n\nexport function TraderQuestGroup({\n  traderName,\n  traderColor,\n  quests,\n  showCheckboxes = false,\n  checkedQuests,\n  onToggleQuest,\n  defaultExpanded = true,\n}: TraderQuestGroupProps) {\n  const [expanded, setExpanded] = useState(defaultExpanded);\n\n  const checkedCount =\n    showCheckboxes && checkedQuests\n      ? quests.filter((q) => checkedQuests.has(q.questId)).length\n      : quests.length;\n\n  return (\n    <div className=\"border border-[var(--tactical-border)] rounded-md overflow-hidden\">\n      <button\n        type=\"button\"\n        onClick={() => setExpanded(!expanded)}\n        className=\"w-full flex items-center justify-between p-3 bg-[var(--bg-elevated)] hover:bg-[var(--bg-panel)] transition-colors\"\n        aria-expanded={expanded}\n        aria-label={`${traderName} quests, ${expanded ? \"collapse\" : \"expand\"}`}\n      >\n        <div className=\"flex items-center gap-2\">\n          {expanded ? (\n            <ChevronDown className=\"h-4 w-4 text-[var(--text-secondary)]\" />\n          ) : (\n            <ChevronRight className=\"h-4 w-4 text-[var(--text-secondary)]\" />\n          )}\n          <span className=\"font-medium\" style={{ color: traderColor }}>\n            {traderName}\n          </span>\n          <span className=\"text-xs text-[var(--text-dim)]\">\n            ({checkedCount}/{quests.length})\n          </span>\n        </div>\n      </button>\n\n      {expanded && (\n        <div className=\"divide-y divide-[var(--tactical-border)]\">\n          {quests.map((quest) => (\n            <div\n              key={quest.questId}\n              className=\"flex items-center gap-3 p-3 bg-[var(--bg-card)]\"\n            >\n              {showCheckboxes && checkedQuests && onToggleQuest ? (\n                // @ts-ignore React 19 forwardRef type compatibility\n                <Checkbox\n                  id={`quest-${quest.questId}`}\n                  checked={checkedQuests.has(quest.questId)}\n                  onCheckedChange={() => onToggleQuest(quest.questId)}\n                />\n              ) : (\n                <div className=\"w-4 h-4 rounded border border-[var(--tactical-border)] bg-[var(--success)]/20 flex items-center justify-center\">\n                  <svg\n                    className=\"w-3 h-3 text-[var(--success)]\"\n                    fill=\"none\"\n                    viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M5 13l4 4L19 7\"\n                    />\n                  </svg>\n                </div>\n              )}\n              <label\n                htmlFor={showCheckboxes ? `quest-${quest.questId}` : undefined}\n                className=\"flex-1 text-sm text-[var(--text-bright)] cursor-pointer\"\n              >\n                {quest.questTitle}\n              </label>\n              <span className=\"text-xs text-[var(--text-dim)]\">\n                Lv. {quest.levelRequired}\n              </span>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AAJA;;;;;AAiBO,SAAS,iBAAiB,EAC/B,UAAU,EACV,WAAW,EACX,MAAM,EACN,iBAAiB,KAAK,EACtB,aAAa,EACb,aAAa,EACb,kBAAkB,IAAI,EACA;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gUAAQ,EAAC;IAEzC,MAAM,eACJ,kBAAkB,gBACd,OAAO,MAAM,CAAC,CAAC,IAAM,cAAc,GAAG,CAAC,EAAE,OAAO,GAAG,MAAM,GACzD,OAAO,MAAM;IAEnB,qBACE,6VAAC;QAAI,WAAU;;0BACb,6VAAC;gBACC,MAAK;gBACL,SAAS,IAAM,YAAY,CAAC;gBAC5B,WAAU;gBACV,iBAAe;gBACf,cAAY,GAAG,WAAW,SAAS,EAAE,WAAW,aAAa,UAAU;0BAEvE,cAAA,6VAAC;oBAAI,WAAU;;wBACZ,yBACC,6VAAC,uTAAW;4BAAC,WAAU;;;;;iDAEvB,6VAAC,0TAAY;4BAAC,WAAU;;;;;;sCAE1B,6VAAC;4BAAK,WAAU;4BAAc,OAAO;gCAAE,OAAO;4BAAY;sCACvD;;;;;;sCAEH,6VAAC;4BAAK,WAAU;;gCAAiC;gCAC7C;gCAAa;gCAAE,OAAO,MAAM;gCAAC;;;;;;;;;;;;;;;;;;YAKpC,0BACC,6VAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,sBACX,6VAAC;wBAEC,WAAU;;4BAET,kBAAkB,iBAAiB,gBAClC,oDAAoD;0CACpD,6VAAC,+JAAQ;gCACP,IAAI,CAAC,MAAM,EAAE,MAAM,OAAO,EAAE;gCAC5B,SAAS,cAAc,GAAG,CAAC,MAAM,OAAO;gCACxC,iBAAiB,IAAM,cAAc,MAAM,OAAO;;;;;qDAGpD,6VAAC;gCAAI,WAAU;0CACb,cAAA,6VAAC;oCACC,WAAU;oCACV,MAAK;oCACL,SAAQ;oCACR,QAAO;8CAEP,cAAA,6VAAC;wCACC,eAAc;wCACd,gBAAe;wCACf,aAAa;wCACb,GAAE;;;;;;;;;;;;;;;;0CAKV,6VAAC;gCACC,SAAS,iBAAiB,CAAC,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG;gCACrD,WAAU;0CAET,MAAM,UAAU;;;;;;0CAEnB,6VAAC;gCAAK,WAAU;;oCAAiC;oCAC1C,MAAM,aAAa;;;;;;;;uBAlCrB,MAAM,OAAO;;;;;;;;;;;;;;;;AA0ChC"}},
    {"offset": {"line": 7269, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/catch-up/CatchUpDialog.tsx"],"sourcesContent":["// @ts-nocheck - React 19 Input component type compatibility\n\"use client\";\n\nimport { useState, useCallback, useMemo, useRef, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { getTraderColor } from \"@/lib/trader-colors\";\nimport { calculateCatchUp, groupByTrader } from \"@/lib/catch-up-algorithm\";\nimport { TraderQuestGroup } from \"./TraderQuestGroup\";\nimport {\n  Search,\n  X,\n  Loader2,\n  CheckCircle2,\n  ChevronLeft,\n  AlertTriangle,\n  Lock,\n} from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport type { QuestWithProgress, CatchUpCalculation } from \"@eft-tracker/types\";\n\ntype Step = \"select\" | \"confirm-reset\" | \"review\";\n\ninterface CatchUpDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  quests: QuestWithProgress[];\n  onComplete: () => void;\n  existingProgressCount?: number;\n}\n\nexport function CatchUpDialog({\n  open,\n  onOpenChange,\n  quests,\n  onComplete,\n  existingProgressCount = 0,\n}: CatchUpDialogProps) {\n  const [step, setStep] = useState<Step>(\"select\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedQuests, setSelectedQuests] = useState<QuestWithProgress[]>([]);\n  const [playerLevel, setPlayerLevel] = useState<number | null>(null);\n  const [confirmedBranches, setConfirmedBranches] = useState<Set<string>>(\n    new Set()\n  );\n  const [isLoading, setIsLoading] = useState(false);\n  const searchInputRef = useRef<HTMLInputElement>(null);\n\n  // Reset state when dialog closes\n  useEffect(() => {\n    if (!open) {\n      setStep(\"select\");\n      setSearchQuery(\"\");\n      setSelectedQuests([]);\n      setPlayerLevel(null);\n      setConfirmedBranches(new Set());\n    }\n  }, [open]);\n\n  // Calculate catch-up data when we have selections and player level\n  const catchUpData = useMemo((): CatchUpCalculation | null => {\n    if (selectedQuests.length === 0 || playerLevel === null) return null;\n    return calculateCatchUp(\n      selectedQuests.map((q) => q.id),\n      quests\n    );\n  }, [selectedQuests, quests, playerLevel]);\n\n  // Initialize confirmed branches when catch-up data changes\n  useEffect(() => {\n    if (catchUpData && playerLevel !== null) {\n      const autoChecked = new Set<string>();\n      for (const branch of catchUpData.completedBranches) {\n        if (branch.levelRequired <= playerLevel) {\n          autoChecked.add(branch.questId);\n        }\n      }\n      setConfirmedBranches(autoChecked);\n    }\n  }, [catchUpData, playerLevel]);\n\n  // Filter quests based on search query\n  const searchResults = useMemo(() => {\n    if (!searchQuery.trim()) return [];\n\n    const lowerQuery = searchQuery.toLowerCase();\n    const selectedIds = new Set(selectedQuests.map((q) => q.id));\n\n    return quests\n      .filter(\n        (q) =>\n          q.title.toLowerCase().includes(lowerQuery) && !selectedIds.has(q.id)\n      )\n      .sort((a, b) => {\n        const aExact = a.title.toLowerCase() === lowerQuery;\n        const bExact = b.title.toLowerCase() === lowerQuery;\n        if (aExact && !bExact) return -1;\n        if (!aExact && bExact) return 1;\n        return a.levelRequired - b.levelRequired;\n      })\n      .slice(0, 20);\n  }, [searchQuery, quests, selectedQuests]);\n\n  const handleSelectQuest = useCallback((quest: QuestWithProgress) => {\n    setSelectedQuests((prev) => [...prev, quest]);\n    setSearchQuery(\"\");\n    searchInputRef.current?.focus();\n  }, []);\n\n  const handleRemoveQuest = useCallback((questId: string) => {\n    setSelectedQuests((prev) => prev.filter((q) => q.id !== questId));\n  }, []);\n\n  const handlePlayerLevelChange = useCallback((value: string) => {\n    const num = parseInt(value, 10);\n    if (value === \"\") {\n      setPlayerLevel(null);\n    } else if (!isNaN(num) && num >= 1 && num <= 79) {\n      setPlayerLevel(num);\n    }\n  }, []);\n\n  const handleToggleBranch = useCallback((questId: string) => {\n    setConfirmedBranches((prev) => {\n      const next = new Set(prev);\n      if (next.has(questId)) {\n        next.delete(questId);\n      } else {\n        next.add(questId);\n      }\n      return next;\n    });\n  }, []);\n\n  const handleNext = useCallback(() => {\n    if (step === \"select\") {\n      if (existingProgressCount > 0) {\n        setStep(\"confirm-reset\");\n      } else {\n        setStep(\"review\");\n      }\n    } else if (step === \"confirm-reset\") {\n      setStep(\"review\");\n    }\n  }, [step, existingProgressCount]);\n\n  const handleBack = useCallback(() => {\n    if (step === \"review\") {\n      if (existingProgressCount > 0) {\n        setStep(\"confirm-reset\");\n      } else {\n        setStep(\"select\");\n      }\n    } else if (step === \"confirm-reset\") {\n      setStep(\"select\");\n    }\n  }, [step, existingProgressCount]);\n\n  const handleCatchUp = useCallback(async () => {\n    if (selectedQuests.length === 0 || playerLevel === null) return;\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/progress/catch-up\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          targetQuests: selectedQuests.map((q) => q.id),\n          playerLevel,\n          confirmedBranches: Array.from(confirmedBranches),\n        }),\n      });\n\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to catch up progress\");\n      }\n\n      const data = await response.json();\n\n      toast.success(\"Progress synced!\", {\n        description: `Completed ${data.completed.length} prerequisite quests${\n          data.completedBranches?.length > 0\n            ? ` and ${data.completedBranches.length} branch quests`\n            : \"\"\n        }.`,\n      });\n\n      onComplete();\n      onOpenChange(false);\n    } catch (error) {\n      toast.error(\"Failed to sync\", {\n        description:\n          error instanceof Error ? error.message : \"Please try again.\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [\n    selectedQuests,\n    playerLevel,\n    confirmedBranches,\n    onComplete,\n    onOpenChange,\n  ]);\n\n  const canProceed = selectedQuests.length > 0 && playerLevel !== null;\n\n  // Group prerequisites and branches by trader for display\n  const prerequisitesByTrader = useMemo(() => {\n    if (!catchUpData) return new Map();\n    return groupByTrader(catchUpData.prerequisites);\n  }, [catchUpData]);\n\n  const branchesByTrader = useMemo(() => {\n    if (!catchUpData) return new Map();\n    return groupByTrader(catchUpData.completedBranches);\n  }, [catchUpData]);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-lg max-h-[85vh] flex flex-col overflow-hidden\">\n        <DialogHeader>\n          <DialogTitle>\n            {step === \"select\" && \"Catch Up Progress\"}\n            {step === \"confirm-reset\" && \"Progress Reset Warning\"}\n            {step === \"review\" && \"Review Catch-Up\"}\n          </DialogTitle>\n          <DialogDescription>\n            {step === \"select\" &&\n              \"Select the quests you're currently working on and enter your PMC level.\"}\n            {step === \"confirm-reset\" &&\n              \"This will reset your existing progress before applying the catch-up.\"}\n            {step === \"review\" &&\n              \"Review the quests that will be marked as completed.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"flex-1 flex flex-col gap-4 py-2 min-h-0 overflow-hidden\">\n          {/* Step 1: Select quests and enter level */}\n          {step === \"select\" && (\n            <>\n              {/* Player level input */}\n              <div className=\"shrink-0\">\n                <label className=\"text-sm font-medium mb-1.5 block\">\n                  Your PMC Level\n                </label>\n                <Input\n                  type=\"number\"\n                  min={1}\n                  max={79}\n                  value={playerLevel ?? \"\"}\n                  onChange={(e) => handlePlayerLevelChange(e.target.value)}\n                  placeholder=\"Enter level (1-79)\"\n                  className=\"w-32\"\n                />\n              </div>\n\n              {/* Search input */}\n              <div className=\"relative shrink-0\">\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  ref={searchInputRef}\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"Search quests...\"\n                  className=\"pl-9\"\n                />\n              </div>\n\n              {/* Search results */}\n              {searchQuery.trim() && searchResults.length > 0 && (\n                <div className=\"border rounded-md max-h-48 overflow-y-auto shrink-0\">\n                  {searchResults.map((quest) => {\n                    const traderColor = getTraderColor(quest.traderId);\n                    return (\n                      <button\n                        type=\"button\"\n                        key={quest.id}\n                        onClick={() => handleSelectQuest(quest)}\n                        className=\"w-full px-3 py-2 text-left hover:bg-muted flex items-center gap-2 text-sm\"\n                      >\n                        <div\n                          className=\"w-2 h-2 rounded-full shrink-0\"\n                          style={{ backgroundColor: traderColor.primary }}\n                        />\n                        <span className=\"flex-1 truncate\">{quest.title}</span>\n                        <span className=\"text-xs text-muted-foreground shrink-0\">\n                          Lv {quest.levelRequired}\n                        </span>\n                      </button>\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* Selected quests */}\n              <div className=\"flex-1 overflow-y-auto min-h-0\">\n                {selectedQuests.length > 0 ? (\n                  <div className=\"space-y-2\">\n                    <p className=\"text-sm text-muted-foreground\">\n                      Selected quests ({selectedQuests.length}):\n                    </p>\n                    <div className=\"space-y-1\">\n                      {selectedQuests.map((quest) => {\n                        const traderColor = getTraderColor(quest.traderId);\n                        return (\n                          <div\n                            key={quest.id}\n                            className=\"flex items-center gap-2 p-2 bg-muted/50 rounded-md text-sm\"\n                          >\n                            <div\n                              className=\"w-2 h-2 rounded-full shrink-0\"\n                              style={{ backgroundColor: traderColor.primary }}\n                            />\n                            <span className=\"flex-1 truncate\">\n                              {quest.title}\n                            </span>\n                            <span className=\"text-xs text-muted-foreground shrink-0\">\n                              Lv {quest.levelRequired}\n                            </span>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleRemoveQuest(quest.id)}\n                              className=\"p-1 hover:bg-muted rounded-sm\"\n                              aria-label={`Remove ${quest.title}`}\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </button>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Search className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                    <p className=\"text-sm\">\n                      Search for quests you&apos;re currently working on\n                    </p>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {/* Step 2: Confirm reset warning */}\n          {step === \"confirm-reset\" && (\n            <div className=\"flex flex-col items-center justify-center py-8 gap-4\">\n              <AlertTriangle className=\"h-12 w-12 text-yellow-500\" />\n              <div className=\"text-center space-y-2\">\n                <p className=\"font-medium\">\n                  You have {existingProgressCount} quest\n                  {existingProgressCount !== 1 ? \"s\" : \"\"} marked complete.\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Continuing will reset all existing progress and apply the new\n                  catch-up state. This cannot be undone.\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Step 3: Review */}\n          {step === \"review\" && catchUpData && (\n            <div className=\"flex-1 overflow-y-auto space-y-4\">\n              {/* Prerequisites section */}\n              <div>\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <Lock className=\"h-4 w-4 text-muted-foreground\" />\n                  <h3 className=\"text-sm font-medium\">Prerequisites</h3>\n                  <span className=\"text-xs text-muted-foreground\">\n                    ({catchUpData.prerequisites.length} quests)\n                  </span>\n                </div>\n                <p className=\"text-xs text-muted-foreground mb-2\">\n                  These quests must be completed to reach your selected quests.\n                </p>\n                {catchUpData.prerequisites.length > 0 ? (\n                  <div className=\"space-y-1\">\n                    {Array.from(prerequisitesByTrader.entries()).map(\n                      ([traderId, selections]) => (\n                        <TraderQuestGroup\n                          key={traderId}\n                          traderId={traderId}\n                          traderName={selections[0].traderName}\n                          traderColor={selections[0].traderColor}\n                          quests={selections}\n                          locked\n                        />\n                      )\n                    )}\n                  </div>\n                ) : (\n                  <p className=\"text-sm text-muted-foreground italic\">\n                    No prerequisites needed.\n                  </p>\n                )}\n              </div>\n\n              {/* Completed branches section */}\n              {catchUpData.completedBranches.length > 0 && (\n                <div>\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n                    <h3 className=\"text-sm font-medium\">Completed Branches</h3>\n                    <span className=\"text-xs text-muted-foreground\">\n                      ({catchUpData.completedBranches.length} terminal quests)\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mb-2\">\n                    These quest chains ended before your current position. Check\n                    the ones you&apos;ve completed.\n                  </p>\n                  <div className=\"space-y-1\">\n                    {Array.from(branchesByTrader.entries()).map(\n                      ([traderId, selections]) => (\n                        <TraderQuestGroup\n                          key={traderId}\n                          traderId={traderId}\n                          traderName={selections[0].traderName}\n                          traderColor={selections[0].traderColor}\n                          quests={selections}\n                          showCheckboxes\n                          checkedIds={confirmedBranches}\n                          onToggle={handleToggleBranch}\n                          playerLevel={playerLevel}\n                        />\n                      )\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <DialogFooter className=\"flex-row justify-between sm:justify-between\">\n          <div>\n            {step !== \"select\" && (\n              <Button\n                variant=\"outline\"\n                onClick={handleBack}\n                disabled={isLoading}\n              >\n                <ChevronLeft className=\"h-4 w-4 mr-1\" />\n                Back\n              </Button>\n            )}\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              disabled={isLoading}\n            >\n              Cancel\n            </Button>\n            {step === \"review\" ? (\n              <Button\n                onClick={handleCatchUp}\n                disabled={isLoading || !canProceed}\n              >\n                {isLoading ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Syncing...\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle2 className=\"h-4 w-4 mr-2\" />\n                    Apply Catch-Up\n                  </>\n                )}\n              </Button>\n            ) : (\n              <Button onClick={handleNext} disabled={!canProceed}>\n                Next\n              </Button>\n            )}\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8059, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/catch-up/index.ts"],"sourcesContent":["export { CatchUpDialog } from \"./CatchUpDialog\";\nexport { TraderQuestGroup } from \"./TraderQuestGroup\";\n"],"names":[],"mappings":";AAAA;AACA"}},
    {"offset": {"line": 8068, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/hooks/useQuests.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport type {\n  QuestWithProgress,\n  Trader,\n  QuestFilters,\n  QuestStatus,\n} from \"@/types\";\n\n// Simple request deduplication - tracks in-flight requests\nconst inflightRequests = new Map<string, Promise<Response>>();\n\nasync function fetchWithDedup(url: string): Promise<Response> {\n  // Check if there's already an in-flight request for this URL\n  const existing = inflightRequests.get(url);\n  if (existing) {\n    return existing;\n  }\n\n  // Create new request\n  const request = fetch(url);\n  inflightRequests.set(url, request);\n\n  try {\n    const response = await request;\n    // Return a clone so the original can still be consumed\n    return response.clone();\n  } finally {\n    // Clean up after request completes (success or failure)\n    inflightRequests.delete(url);\n  }\n}\n\ninterface UseQuestsReturn {\n  quests: QuestWithProgress[];\n  allQuests: QuestWithProgress[]; // Unfiltered quests for accurate depth calculation\n  traders: Trader[];\n  loading: boolean;\n  initialLoading: boolean; // True only during first load, prevents remounting during refetch\n  error: string | null;\n  filters: QuestFilters;\n  setFilters: (filters: Partial<QuestFilters>) => void;\n  applyFilters: () => void;\n  hasPendingChanges: boolean;\n  refetch: () => Promise<void>;\n}\n\nconst defaultFilters: QuestFilters = {\n  traderId: null,\n  statuses: [\"available\", \"locked\"], // Default to showing available and locked quests\n  search: \"\",\n  kappaOnly: false,\n  map: null,\n  playerLevel: 1, // Default to level 1 for all users (display only, no filtering)\n  questsPerTree: null,\n  bypassLevelRequirement: false,\n  questType: null,\n  hideReputationQuests: false,\n};\n\ninterface UseQuestsOptions {\n  initialFilters?: Partial<QuestFilters>;\n}\n\nexport function useQuests(options?: UseQuestsOptions): UseQuestsReturn {\n  // Merge initial filters with defaults (only computed once on mount)\n  const mergedInitialFilters = useMemo(\n    () => ({\n      ...defaultFilters,\n      ...(options?.initialFilters ?? {}),\n    }),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [] // Empty deps - only compute once on mount\n  );\n\n  const [quests, setQuests] = useState<QuestWithProgress[]>([]);\n  const [allQuests, setAllQuests] = useState<QuestWithProgress[]>([]); // Unfiltered for depth calc\n  const [traders, setTraders] = useState<Trader[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [initialLoading, setInitialLoading] = useState(true); // Only true during first load\n  const [error, setError] = useState<string | null>(null);\n  const [pendingFilters, setPendingFilters] =\n    useState<QuestFilters>(mergedInitialFilters);\n  const [appliedFilters, setAppliedFilters] =\n    useState<QuestFilters>(mergedInitialFilters);\n\n  // Ref to store pending filters for stable applyFilters callback\n  const pendingFiltersRef = useRef(pendingFilters);\n  pendingFiltersRef.current = pendingFilters;\n\n  const fetchTraders = useCallback(async () => {\n    try {\n      const res = await fetchWithDedup(\"/api/traders\");\n      if (!res.ok) throw new Error(\"Failed to fetch traders\");\n      const data = await res.json();\n      setTraders(data.traders);\n    } catch (err) {\n      console.error(\"Error fetching traders:\", err);\n    }\n  }, []);\n\n  // Fetch all quests (unfiltered) for accurate depth calculation\n  const fetchAllQuests = useCallback(async () => {\n    try {\n      const res = await fetchWithDedup(\"/api/quests\");\n      if (!res.ok) throw new Error(\"Failed to fetch all quests\");\n      const data = await res.json();\n      setAllQuests(data.quests);\n    } catch (err) {\n      console.error(\"Error fetching all quests:\", err);\n    }\n  }, []);\n\n  const fetchQuests = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const params = new URLSearchParams();\n      if (appliedFilters.kappaOnly) params.set(\"kappa\", \"true\");\n      if (appliedFilters.search) params.set(\"search\", appliedFilters.search);\n\n      const url = `/api/quests?${params.toString()}`;\n      const res = await fetchWithDedup(url);\n      if (!res.ok) throw new Error(\"Failed to fetch quests\");\n\n      const data = await res.json();\n\n      // Client-side filtering\n      let filteredQuests = data.quests;\n\n      // Trader filtering\n      if (appliedFilters.traderId) {\n        filteredQuests = filteredQuests.filter(\n          (q: QuestWithProgress) => q.traderId === appliedFilters.traderId\n        );\n      }\n\n      // Status filtering (multi-select: empty array = all)\n      if (appliedFilters.statuses.length > 0) {\n        filteredQuests = filteredQuests.filter((q: QuestWithProgress) =>\n          appliedFilters.statuses.includes(q.computedStatus)\n        );\n      }\n\n      setQuests(filteredQuests);\n      setInitialLoading(false); // First load complete\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Unknown error\");\n      setInitialLoading(false); // Also mark initial load complete on error\n    } finally {\n      setLoading(false);\n    }\n  }, [appliedFilters]);\n\n  const setFilters = useCallback((newFilters: Partial<QuestFilters>) => {\n    // Update ref synchronously so applyFilters() can read the latest value immediately\n    const updated = { ...pendingFiltersRef.current, ...newFilters };\n    pendingFiltersRef.current = updated;\n    setPendingFilters(updated);\n  }, []);\n\n  const applyFilters = useCallback(() => {\n    setAppliedFilters(pendingFiltersRef.current);\n  }, []);\n\n  const hasPendingChanges = useMemo(() => {\n    return JSON.stringify(pendingFilters) !== JSON.stringify(appliedFilters);\n  }, [pendingFilters, appliedFilters]);\n\n  const refetch = useCallback(async () => {\n    // Refetch both filtered quests and all quests to keep them in sync\n    // This ensures allQuests (used for skip dialog prerequisites) has fresh data\n    await Promise.all([fetchQuests(), fetchAllQuests()]);\n  }, [fetchQuests, fetchAllQuests]);\n\n  // Track if initial fetch has been done\n  const initialFetchDone = useRef(false);\n\n  // Initial fetch - run once on mount\n  useEffect(() => {\n    if (initialFetchDone.current) return;\n    initialFetchDone.current = true;\n\n    // Fetch traders, all quests, and filtered quests in parallel\n    Promise.all([fetchTraders(), fetchAllQuests(), fetchQuests()]);\n  }, [fetchTraders, fetchAllQuests, fetchQuests]);\n\n  // Re-fetch filtered quests when filters change (but skip initial mount)\n  const isFirstRender = useRef(true);\n  useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false;\n      return;\n    }\n    fetchQuests();\n  }, [fetchQuests]);\n\n  return {\n    quests,\n    allQuests,\n    traders,\n    loading,\n    initialLoading,\n    error,\n    filters: pendingFilters,\n    setFilters,\n    applyFilters,\n    hasPendingChanges,\n    refetch,\n  };\n}\n\n// Hook for updating quest progress\nexport function useQuestProgress() {\n  const [updating, setUpdating] = useState(false);\n\n  const updateStatus = useCallback(\n    async (questId: string, status: QuestStatus): Promise<boolean> => {\n      setUpdating(true);\n      try {\n        const res = await fetch(\"/api/progress\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ questId, status }),\n        });\n\n        if (!res.ok) {\n          const data = await res.json();\n          throw new Error(data.error || \"Failed to update progress\");\n        }\n\n        return true;\n      } catch (err) {\n        console.error(\"Error updating progress:\", err);\n        return false;\n      } finally {\n        setUpdating(false);\n      }\n    },\n    []\n  );\n\n  return { updateStatus, updating };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/hooks/useProgress.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport type { QuestStatus } from \"@/types\";\n\ninterface ProgressEntry {\n  questId: string;\n  status: QuestStatus;\n  updatedAt: string;\n}\n\ninterface QueuedUpdate {\n  questId: string;\n  status: QuestStatus;\n  timestamp: number;\n}\n\ninterface UseProgressReturn {\n  progress: Map<string, QuestStatus>;\n  isLoading: boolean;\n  error: string | null;\n  updateStatus: (questId: string, newStatus: QuestStatus) => Promise<boolean>;\n  getStatus: (questId: string) => QuestStatus | undefined;\n  refreshProgress: () => Promise<void>;\n  unlockedQuests: string[];\n  clearUnlocked: () => void;\n  savingQuestIds: Set<string>;\n  lastSynced: Date | null;\n  isOnline: boolean;\n  pendingOfflineCount: number;\n}\n\n// LocalStorage key for offline queue\nconst OFFLINE_QUEUE_KEY = \"eft-tracker-offline-queue\";\n\n// Load offline queue from localStorage\nfunction loadOfflineQueue(): QueuedUpdate[] {\n  if (typeof window === \"undefined\") return [];\n  try {\n    const stored = localStorage.getItem(OFFLINE_QUEUE_KEY);\n    return stored ? JSON.parse(stored) : [];\n  } catch {\n    return [];\n  }\n}\n\n// Save offline queue to localStorage\nfunction saveOfflineQueue(queue: QueuedUpdate[]): void {\n  if (typeof window === \"undefined\") return;\n  try {\n    localStorage.setItem(OFFLINE_QUEUE_KEY, JSON.stringify(queue));\n  } catch {\n    // Ignore storage errors\n  }\n}\n\nexport function useProgress(): UseProgressReturn {\n  const { status: sessionStatus } = useSession();\n  const [progress, setProgress] = useState<Map<string, QuestStatus>>(new Map());\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [unlockedQuests, setUnlockedQuests] = useState<string[]>([]);\n  const [savingQuestIds, setSavingQuestIds] = useState<Set<string>>(new Set());\n  const [lastSynced, setLastSynced] = useState<Date | null>(null);\n  const [isOnline, setIsOnline] = useState(true);\n  const [pendingOfflineCount, setPendingOfflineCount] = useState(0);\n\n  // Track previous state for rollback\n  const previousProgress = useRef<Map<string, QuestStatus>>(new Map());\n\n  // Debounce tracking - prevent rapid clicks on same quest\n  const recentlyUpdated = useRef<Set<string>>(new Set());\n\n  // Offline queue\n  const offlineQueue = useRef<QueuedUpdate[]>(loadOfflineQueue());\n\n  // Track if we're currently processing the offline queue\n  const processingQueue = useRef(false);\n\n  // Process offline queue when coming back online\n  const processOfflineQueue = useCallback(async () => {\n    if (processingQueue.current || offlineQueue.current.length === 0) return;\n    if (sessionStatus !== \"authenticated\") return;\n\n    processingQueue.current = true;\n\n    // Process queue items one at a time\n    while (offlineQueue.current.length > 0 && navigator.onLine) {\n      const update = offlineQueue.current[0];\n\n      try {\n        const res = await fetch(`/api/progress/${update.questId}`, {\n          method: \"PATCH\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ status: update.status.toUpperCase() }),\n        });\n\n        if (res.ok) {\n          // Remove from queue on success\n          offlineQueue.current.shift();\n          saveOfflineQueue(offlineQueue.current);\n          setPendingOfflineCount(offlineQueue.current.length);\n          setLastSynced(new Date());\n        } else {\n          // Stop processing on error - will retry later\n          break;\n        }\n      } catch {\n        // Network error - stop processing\n        break;\n      }\n    }\n\n    processingQueue.current = false;\n  }, [sessionStatus]);\n\n  // Track online/offline status\n  useEffect(() => {\n    const handleOnline = () => {\n      setIsOnline(true);\n      // Process offline queue when coming back online\n      processOfflineQueue();\n    };\n    const handleOffline = () => setIsOnline(false);\n\n    // Set initial state\n    setIsOnline(navigator.onLine);\n\n    // Initialize pending count from stored queue\n    setPendingOfflineCount(offlineQueue.current.length);\n\n    window.addEventListener(\"online\", handleOnline);\n    window.addEventListener(\"offline\", handleOffline);\n\n    return () => {\n      window.removeEventListener(\"online\", handleOnline);\n      window.removeEventListener(\"offline\", handleOffline);\n    };\n  }, [processOfflineQueue]);\n\n  // Process queue on mount if online\n  useEffect(() => {\n    if (isOnline && sessionStatus === \"authenticated\") {\n      processOfflineQueue();\n    }\n  }, [isOnline, sessionStatus, processOfflineQueue]);\n\n  const fetchProgress = useCallback(async () => {\n    if (sessionStatus !== \"authenticated\") {\n      setIsLoading(false);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const res = await fetch(\"/api/progress\");\n      if (!res.ok) {\n        if (res.status === 401) {\n          // Not authenticated, clear progress\n          setProgress(new Map());\n          return;\n        }\n        throw new Error(\"Failed to fetch progress\");\n      }\n\n      const data = await res.json();\n      const progressMap = new Map<string, QuestStatus>();\n\n      for (const entry of data.progress as ProgressEntry[]) {\n        progressMap.set(\n          entry.questId,\n          entry.status.toLowerCase() as QuestStatus\n        );\n      }\n\n      setProgress(progressMap);\n      setLastSynced(new Date());\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Unknown error\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [sessionStatus]);\n\n  const updateStatus = useCallback(\n    async (questId: string, newStatus: QuestStatus): Promise<boolean> => {\n      if (sessionStatus !== \"authenticated\") {\n        setError(\"Please sign in to track progress\");\n        return false;\n      }\n\n      // Debounce: prevent rapid clicks on same quest (300ms cooldown)\n      if (recentlyUpdated.current.has(questId)) {\n        return false;\n      }\n      recentlyUpdated.current.add(questId);\n      setTimeout(() => recentlyUpdated.current.delete(questId), 300);\n\n      // Save current state for potential rollback\n      previousProgress.current = new Map(progress);\n\n      // Mark quest as saving\n      setSavingQuestIds((prev) => new Set(prev).add(questId));\n\n      // Optimistic update\n      setProgress((prev) => {\n        const next = new Map(prev);\n        next.set(questId, newStatus);\n        return next;\n      });\n\n      // If offline, queue the update for later\n      if (!navigator.onLine) {\n        // Add to offline queue (replace any existing update for this quest)\n        const existingIndex = offlineQueue.current.findIndex(\n          (u) => u.questId === questId\n        );\n        const queuedUpdate: QueuedUpdate = {\n          questId,\n          status: newStatus,\n          timestamp: Date.now(),\n        };\n\n        if (existingIndex >= 0) {\n          offlineQueue.current[existingIndex] = queuedUpdate;\n        } else {\n          offlineQueue.current.push(queuedUpdate);\n        }\n\n        saveOfflineQueue(offlineQueue.current);\n        setPendingOfflineCount(offlineQueue.current.length);\n\n        // Remove from saving set\n        setSavingQuestIds((prev) => {\n          const next = new Set(prev);\n          next.delete(questId);\n          return next;\n        });\n\n        // Return true because we've queued it (optimistic update stays)\n        return true;\n      }\n\n      try {\n        const res = await fetch(`/api/progress/${questId}`, {\n          method: \"PATCH\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ status: newStatus.toUpperCase() }),\n        });\n\n        if (!res.ok) {\n          const data = await res.json();\n          throw new Error(data.error || \"Failed to update progress\");\n        }\n\n        const data = await res.json();\n\n        // Handle auto-unlocked quests\n        if (data.unlockedQuests && data.unlockedQuests.length > 0) {\n          setUnlockedQuests((prev) => [...prev, ...data.unlockedQuests]);\n\n          // Update progress for unlocked quests\n          setProgress((prev) => {\n            const next = new Map(prev);\n            for (const unlockedId of data.unlockedQuests) {\n              next.set(unlockedId, \"available\");\n            }\n            return next;\n          });\n        }\n\n        // Handle auto-locked quests (when prerequisites are unchecked)\n        if (data.lockedQuests && data.lockedQuests.length > 0) {\n          setProgress((prev) => {\n            const next = new Map(prev);\n            for (const lockedId of data.lockedQuests) {\n              next.set(lockedId, \"locked\");\n            }\n            return next;\n          });\n        }\n\n        // Update last synced time on success\n        setLastSynced(new Date());\n        setError(null); // Clear any previous errors\n        return true;\n      } catch (err) {\n        // Rollback on error\n        setProgress(previousProgress.current);\n        setError(err instanceof Error ? err.message : \"Failed to update\");\n        return false;\n      } finally {\n        // Remove quest from saving set\n        setSavingQuestIds((prev) => {\n          const next = new Set(prev);\n          next.delete(questId);\n          return next;\n        });\n      }\n    },\n    [progress, sessionStatus]\n  );\n\n  const getStatus = useCallback(\n    (questId: string): QuestStatus | undefined => {\n      return progress.get(questId);\n    },\n    [progress]\n  );\n\n  const refreshProgress = useCallback(async () => {\n    await fetchProgress();\n  }, [fetchProgress]);\n\n  const clearUnlocked = useCallback(() => {\n    setUnlockedQuests([]);\n  }, []);\n\n  // Initial fetch when session is ready\n  useEffect(() => {\n    if (sessionStatus === \"authenticated\") {\n      fetchProgress();\n    } else if (sessionStatus === \"unauthenticated\") {\n      setProgress(new Map());\n      setIsLoading(false);\n    }\n  }, [sessionStatus, fetchProgress]);\n\n  return {\n    progress,\n    isLoading,\n    error,\n    updateStatus,\n    getStatus,\n    refreshProgress,\n    unlockedQuests,\n    clearUnlocked,\n    savingQuestIds,\n    lastSynced,\n    isOnline,\n    pendingOfflineCount,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8581, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/app/quest-tree/QuestTreeClient.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useEffect, useMemo, useRef } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { toast } from \"sonner\";\nimport { useStats } from \"@/contexts/StatsContext\";\nimport { useUserPrefsContext } from \"@/providers/UserPrefsProvider\";\nimport {\n  QuestTree,\n  QuestFilters,\n  SyncStatusIndicator,\n} from \"@/components/quest-tree\";\nimport { QuestTreeSkeleton } from \"@/components/quest-tree/QuestTreeSkeleton\";\nimport { SkipQuestDialog } from \"@/components/quest-tree/SkipQuestDialog\";\nimport { WelcomeModal } from \"@/components/onboarding\";\nimport { QuestDetailModal } from \"@/components/quest-detail\";\nimport { CatchUpDialog } from \"@/components/catch-up\";\nimport { useQuests } from \"@/hooks/useQuests\";\nimport { useProgress } from \"@/hooks/useProgress\";\nimport { getIncompletePrerequisites } from \"@/lib/quest-layout\";\nimport type { QuestStatus, QuestWithProgress } from \"@/types\";\n\n// Status cycle map for click handling (simplified: available <-> completed)\nconst STATUS_CYCLE: Record<QuestStatus, QuestStatus | null> = {\n  locked: null, // Can't cycle from locked\n  available: \"completed\",\n  in_progress: \"completed\", // Treat in_progress same as available\n  completed: \"available\", // Reset\n};\n\nexport function QuestTreeClient() {\n  const { status: sessionStatus } = useSession();\n  const { setStats } = useStats();\n  const { prefs, isLoading: prefsLoading } = useUserPrefsContext();\n\n  // Show loading skeleton while user preferences load (authenticated users only)\n  const isInitializing =\n    sessionStatus === \"loading\" ||\n    (sessionStatus === \"authenticated\" && prefsLoading);\n\n  // Compute initial filters using user preferences\n  const initialFilters = useMemo(\n    () => ({\n      playerLevel: prefs?.playerLevel ?? 1,\n    }),\n    [prefs]\n  );\n\n  const {\n    quests,\n    allQuests,\n    traders,\n    loading,\n    initialLoading,\n    error,\n    filters,\n    setFilters,\n    applyFilters,\n    hasPendingChanges,\n    refetch,\n  } = useQuests({\n    initialFilters,\n  });\n\n  // Sync saved preferences when they load (after initial mount)\n  const prefsLoaded = useRef(false);\n  useEffect(() => {\n    if (!prefs || prefsLoaded.current) return;\n    prefsLoaded.current = true;\n\n    // Apply saved preferences to filters\n    setFilters({\n      playerLevel: prefs.playerLevel ?? 1,\n    });\n\n    // Apply filters immediately so the quest list updates\n    applyFilters();\n  }, [prefs, setFilters, applyFilters]);\n  const {\n    progress,\n    updateStatus,\n    unlockedQuests,\n    clearUnlocked,\n    error: progressError,\n    savingQuestIds,\n    lastSynced,\n    isOnline,\n    pendingOfflineCount,\n  } = useProgress();\n  const [selectedQuestId, setSelectedQuestId] = useState<string | null>(null);\n\n  // Skip quest dialog state\n  const [skipDialogOpen, setSkipDialogOpen] = useState(false);\n  const [skipTargetQuest, setSkipTargetQuest] =\n    useState<QuestWithProgress | null>(null);\n  const [skipLoading, setSkipLoading] = useState(false);\n\n  // Onboarding state\n  const [showWelcome, setShowWelcome] = useState(false);\n\n  // Catch-up dialog state\n  const [showCatchUp, setShowCatchUp] = useState(false);\n\n  // Quest detail modal state\n  const [detailQuest, setDetailQuest] = useState<QuestWithProgress | null>(\n    null\n  );\n  const [detailModalOpen, setDetailModalOpen] = useState(false);\n\n  // Check if detail quest is currently saving\n  const isDetailQuestSaving = useMemo(() => {\n    return detailQuest ? savingQuestIds.has(detailQuest.id) : false;\n  }, [detailQuest, savingQuestIds]);\n\n  // Refs for stable callback references (prevents re-renders from invalidating memoization)\n  const questsWithProgressRef = useRef<QuestWithProgress[]>([]);\n  const sessionStatusRef = useRef(sessionStatus);\n  const updateStatusRef = useRef(updateStatus);\n  const refetchRef = useRef(refetch);\n\n  // Merge progress into quests (memoized to prevent infinite re-renders)\n  const questsWithProgress = useMemo(\n    () =>\n      quests.map((quest) => {\n        if (quest.computedStatus === \"locked\") {\n          return {\n            ...quest,\n            computedStatus: \"locked\" as const,\n          };\n        }\n        const userStatus = progress.get(quest.id);\n        return {\n          ...quest,\n          computedStatus: userStatus || quest.computedStatus,\n        };\n      }),\n    [quests, progress]\n  );\n\n  // Merge progress into all quests (for accurate depth calculation)\n  const allQuestsWithProgress = useMemo(\n    () =>\n      allQuests.map((quest) => {\n        if (quest.computedStatus === \"locked\") {\n          return {\n            ...quest,\n            computedStatus: \"locked\" as const,\n          };\n        }\n        const userStatus = progress.get(quest.id);\n        return {\n          ...quest,\n          computedStatus: userStatus || quest.computedStatus,\n        };\n      }),\n    [allQuests, progress]\n  );\n\n  // Keep refs in sync with current values\n  useEffect(() => {\n    questsWithProgressRef.current = questsWithProgress;\n  }, [questsWithProgress]);\n\n  useEffect(() => {\n    sessionStatusRef.current = sessionStatus;\n  }, [sessionStatus]);\n\n  useEffect(() => {\n    updateStatusRef.current = updateStatus;\n  }, [updateStatus]);\n\n  useEffect(() => {\n    refetchRef.current = refetch;\n  }, [refetch]);\n\n  // Show notification when quests are unlocked\n  useEffect(() => {\n    if (unlockedQuests.length > 0) {\n      const count = unlockedQuests.length;\n      toast.success(`${count} quest${count > 1 ? \"s\" : \"\"} unlocked!`, {\n        description: \"New quests are now available.\",\n      });\n      clearUnlocked();\n      refetch();\n    }\n  }, [unlockedQuests, clearUnlocked, refetch]);\n\n  // Show error toast when progress error occurs\n  useEffect(() => {\n    if (progressError) {\n      toast.error(\"Progress Error\", { description: progressError });\n    }\n  }, [progressError]);\n\n  // Check for first-time user and show welcome modal\n  useEffect(() => {\n    if (loading) return;\n\n    const hasSeenWelcome = localStorage.getItem(\"eft-tracker-onboarding\");\n    if (!hasSeenWelcome) {\n      setShowWelcome(true);\n    }\n  }, [loading]);\n\n  // Handle completing onboarding\n  const handleOnboardingComplete = useCallback(() => {\n    localStorage.setItem(\"eft-tracker-onboarding\", \"completed\");\n    setShowWelcome(false);\n  }, []);\n\n  // Handle catch-up from welcome modal\n  const handleCatchUpFromWelcome = useCallback(() => {\n    localStorage.setItem(\"eft-tracker-onboarding\", \"completed\");\n    setShowWelcome(false);\n    setShowCatchUp(true);\n  }, []);\n\n  // Handle catch-up completion\n  const handleCatchUpComplete = useCallback(() => {\n    refetch();\n  }, [refetch]);\n\n  const handleQuestSelect = useCallback((questId: string) => {\n    setSelectedQuestId((prev) => (prev === questId ? null : questId));\n  }, []);\n\n  // Handle opening quest details modal\n  const handleQuestDetails = useCallback((questId: string) => {\n    const quest = questsWithProgressRef.current.find((q) => q.id === questId);\n    if (quest) {\n      setDetailQuest(quest);\n      setDetailModalOpen(true);\n    }\n  }, []);\n\n  // Get prerequisites for the skip dialog\n  const skipPrerequisites = useMemo(() => {\n    if (!skipTargetQuest) return [];\n    return getIncompletePrerequisites(\n      skipTargetQuest.id,\n      allQuestsWithProgress\n    );\n  }, [skipTargetQuest, allQuestsWithProgress]);\n\n  // Handle confirming the skip (complete all prerequisites)\n  const handleSkipConfirm = useCallback(async () => {\n    if (!skipTargetQuest || skipPrerequisites.length === 0) return;\n\n    setSkipLoading(true);\n    try {\n      for (const prereq of skipPrerequisites) {\n        const success = await updateStatus(prereq.id, \"completed\");\n        if (!success) {\n          toast.error(\"Failed to Update\", {\n            description: `Could not complete ${prereq.title}. Please try again.`,\n          });\n          setSkipLoading(false);\n          return;\n        }\n      }\n\n      toast.success(\n        `${skipPrerequisites.length} quest${skipPrerequisites.length > 1 ? \"s\" : \"\"} completed!`,\n        {\n          description: `${skipTargetQuest.title} is now available.`,\n        }\n      );\n\n      setSkipDialogOpen(false);\n      setSkipTargetQuest(null);\n      await refetch();\n    } catch {\n      toast.error(\"Failed to Update\", {\n        description:\n          \"Could not complete prerequisite quests. Please try again.\",\n      });\n    } finally {\n      setSkipLoading(false);\n    }\n  }, [skipTargetQuest, skipPrerequisites, updateStatus, refetch]);\n\n  // Stable callback reference using refs\n  const handleStatusChange = useCallback(async (questId: string) => {\n    const quest = questsWithProgressRef.current.find((q) => q.id === questId);\n    if (!quest) return;\n\n    const currentStatus = quest.computedStatus;\n\n    // If locked, open skip dialog instead of showing toast\n    if (currentStatus === \"locked\") {\n      if (sessionStatusRef.current !== \"authenticated\") {\n        toast.warning(\"Sign In Required\", {\n          description: \"Please sign in to track your progress.\",\n          action: {\n            label: \"Sign In\",\n            onClick: () => (window.location.href = \"/login\"),\n          },\n        });\n        return;\n      }\n\n      setSkipTargetQuest(quest);\n      setSkipDialogOpen(true);\n      return;\n    }\n\n    // If not authenticated, prompt to login\n    if (sessionStatusRef.current !== \"authenticated\") {\n      toast.warning(\"Sign In Required\", {\n        description: \"Please sign in to track your progress.\",\n        action: {\n          label: \"Sign In\",\n          onClick: () => (window.location.href = \"/login\"),\n        },\n      });\n      return;\n    }\n\n    // Get next status in cycle\n    const nextStatus = STATUS_CYCLE[currentStatus];\n    if (!nextStatus) return;\n\n    const success = await updateStatusRef.current(questId, nextStatus);\n    if (success) {\n      if (nextStatus === \"completed\") {\n        toast.success(\"Quest Completed!\", {\n          description: quest.title,\n        });\n      }\n      await refetchRef.current();\n    } else {\n      toast.error(\"Failed to Update\", {\n        description: \"Could not update quest status. Please try again.\",\n      });\n    }\n  }, []);\n\n  // Wrapper for modal - reuses parent's handleStatusChange logic\n  const handleModalStatusChange = useCallback(\n    async (questId: string) => {\n      await handleStatusChange(questId);\n    },\n    [handleStatusChange]\n  );\n\n  // Handle objective toggle from modal (supports both binary and numeric)\n  const handleObjectiveToggle = useCallback(\n    async (\n      objectiveId: string,\n      update: boolean | { current: number }\n    ): Promise<{ questStatusChanged?: boolean; newQuestStatus?: string }> => {\n      if (sessionStatusRef.current !== \"authenticated\") {\n        toast.error(\"Sign in Required\", {\n          description: \"Please sign in to track quest progress.\",\n        });\n        return { questStatusChanged: false };\n      }\n\n      try {\n        // Build request body based on update type\n        const body =\n          typeof update === \"boolean\"\n            ? { completed: update }\n            : { current: update.current };\n\n        const response = await fetch(`/api/progress/objective/${objectiveId}`, {\n          method: \"PATCH\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(body),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          throw new Error(errorData.error || \"Failed to update objective\");\n        }\n\n        const data = await response.json();\n\n        // Refetch quests to get updated objective progress\n        await refetchRef.current();\n\n        // Show toast if quest status changed\n        if (data.quest?.statusChanged) {\n          if (data.quest.status === \"COMPLETED\") {\n            toast.success(\"Quest Completed!\", {\n              description: `All objectives for ${data.quest.title} are complete.`,\n            });\n          } else if (data.quest.status === \"IN_PROGRESS\") {\n            toast.info(\"Quest Started\", {\n              description: data.quest.title,\n            });\n          }\n        }\n\n        return {\n          questStatusChanged: data.quest?.statusChanged ?? false,\n          newQuestStatus: data.quest?.status,\n        };\n      } catch (err) {\n        toast.error(\"Failed to Update Objective\", {\n          description: err instanceof Error ? err.message : \"Please try again.\",\n        });\n        return { questStatusChanged: false };\n      }\n    },\n    []\n  );\n\n  // Calculate progress stats\n  const stats = useMemo(\n    () => ({\n      total: questsWithProgress.length,\n      completed: questsWithProgress.filter(\n        (q) => q.computedStatus === \"completed\"\n      ).length,\n      available: questsWithProgress.filter(\n        (q) => q.computedStatus === \"available\"\n      ).length,\n      locked: questsWithProgress.filter((q) => q.computedStatus === \"locked\")\n        .length,\n    }),\n    [questsWithProgress]\n  );\n\n  // Update stats in context for header display\n  useEffect(() => {\n    if (!loading && !error) {\n      setStats(stats);\n    }\n    return () => setStats(null);\n  }, [stats, setStats, loading, error]);\n\n  if (initialLoading || isInitializing) {\n    return <QuestTreeSkeleton />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex-1 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <p className=\"text-lg font-medium text-destructive\">\n            Error loading quests\n          </p>\n          <p className=\"text-sm text-muted-foreground mb-4\">{error}</p>\n          <button\n            onClick={() => refetch()}\n            className=\"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90\"\n          >\n            Try Again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex-1 flex flex-col\">\n      <WelcomeModal\n        open={showWelcome}\n        onOpenChange={setShowWelcome}\n        onGetStarted={handleOnboardingComplete}\n        onCatchUp={handleCatchUpFromWelcome}\n      />\n      <CatchUpDialog\n        open={showCatchUp}\n        onOpenChange={setShowCatchUp}\n        quests={allQuestsWithProgress}\n        onComplete={handleCatchUpComplete}\n      />\n      <SkipQuestDialog\n        open={skipDialogOpen}\n        onOpenChange={setSkipDialogOpen}\n        targetQuest={skipTargetQuest}\n        prerequisites={skipPrerequisites}\n        onConfirm={handleSkipConfirm}\n        isLoading={skipLoading}\n      />\n      <QuestDetailModal\n        quest={detailQuest}\n        open={detailModalOpen}\n        onOpenChange={setDetailModalOpen}\n        onStatusChange={handleModalStatusChange}\n        onObjectiveToggle={handleObjectiveToggle}\n        isSaving={isDetailQuestSaving}\n      />\n      <QuestFilters\n        traders={traders}\n        quests={allQuestsWithProgress}\n        filters={filters}\n        onFilterChange={setFilters}\n        onApplyFilters={applyFilters}\n        hasPendingChanges={hasPendingChanges}\n      />\n      <div className=\"flex-1 min-h-0\">\n        {questsWithProgress.length > 0 ? (\n          <QuestTree\n            quests={questsWithProgress}\n            allQuests={allQuestsWithProgress}\n            traders={traders}\n            selectedQuestId={selectedQuestId}\n            playerLevel={filters.playerLevel}\n            maxColumns={null}\n            savingQuestIds={savingQuestIds}\n            onQuestSelect={handleQuestSelect}\n            onStatusChange={handleStatusChange}\n            onQuestDetails={handleQuestDetails}\n          />\n        ) : (\n          <div className=\"flex items-center justify-center h-full\">\n            <p className=\"text-muted-foreground\">\n              No quests found matching your filters.\n            </p>\n          </div>\n        )}\n      </div>\n      {/* Sync status footer */}\n      {sessionStatus === \"authenticated\" && (\n        <div className=\"shrink-0 px-4 py-2 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n          <SyncStatusIndicator\n            lastSynced={lastSynced}\n            isOnline={isOnline}\n            isSaving={savingQuestIds.size > 0}\n            pendingOfflineCount={pendingOfflineCount}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9151, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tucke/Repositories/EFT-Tracker/apps/web/src/components/guest-banner.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport function GuestBanner() {\n  const { status } = useSession();\n  const [dismissed, setDismissed] = useState(false);\n\n  // Don't show if authenticated or dismissed\n  if (status === \"authenticated\" || status === \"loading\" || dismissed) {\n    return null;\n  }\n\n  return (\n    <div className=\"bg-primary/10 border-b border-primary/20 px-3 py-2\">\n      <div className=\"container mx-auto flex items-center justify-between gap-2 text-sm\">\n        <span className=\"text-foreground\">\n          You&apos;re browsing as a guest. Your progress won&apos;t be saved.\n        </span>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"h-7 w-7 shrink-0\"\n          onClick={() => setDismissed(true)}\n        >\n          <X className=\"h-4 w-4\" />\n          <span className=\"sr-only\">Dismiss</span>\n        </Button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOO,SAAS;IACd,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,+PAAU;IAC7B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,gUAAQ,EAAC;IAE3C,2CAA2C;IAC3C,IAAI,WAAW,mBAAmB,WAAW,aAAa,WAAW;QACnE,OAAO;IACT;IAEA,qBACE,6VAAC;QAAI,WAAU;kBACb,cAAA,6VAAC;YAAI,WAAU;;8BACb,6VAAC;oBAAK,WAAU;8BAAkB;;;;;;8BAGlC,6VAAC,2JAAM;oBACL,SAAQ;oBACR,MAAK;oBACL,WAAU;oBACV,SAAS,IAAM,aAAa;;sCAE5B,6VAAC,qRAAC;4BAAC,WAAU;;;;;;sCACb,6VAAC;4BAAK,WAAU;sCAAU;;;;;;;;;;;;;;;;;;;;;;;AAKpC"}}]
}